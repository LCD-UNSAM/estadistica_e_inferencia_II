<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Estadística e Inferencia II - 5&nbsp; Modelos lineales y generalizaciones</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06_modelos_de_mezcla.html" rel="next">
<link href="./04_Flujo_de_trabajo_bayesiano.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05_GLMS.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelos lineales y generalizaciones</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Estadística e Inferencia II</a> 
        <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="github" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="github"><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/LCD-UNSAM/estadistica_e_inferencia_II">
            Fuente
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/LCD-UNSAM/estadistica_e_inferencia_II/issues/new">
            Reportar errores
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Modo claro/oscuro"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Modo sin distracciones">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">‎</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Inferencia_Bayesiana.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Inferencia Bayesiana</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Programación_probabilística.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Programación probabilista</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Modelos_jerárquicos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelado Jerárquico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Flujo_de_trabajo_bayesiano.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Flujo de trabajo Bayesiano</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_GLMS.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelos lineales y generalizaciones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_modelos_de_mezcla.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos de mezcla</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_GPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Procesos Gaussianos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_BART.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Árboles de regresión aditivos Bayesianos</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#la-idea-central-en-regresión-lineal" id="toc-la-idea-central-en-regresión-lineal" class="nav-link active" data-scroll-target="#la-idea-central-en-regresión-lineal"><span class="header-section-number">5.1</span> La idea central en regresión lineal</a></li>
  <li><a href="#bicicletas-lineales" id="toc-bicicletas-lineales" class="nav-link" data-scroll-target="#bicicletas-lineales"><span class="header-section-number">5.2</span> Bicicletas lineales</a>
  <ul class="collapse">
  <li><a href="#interpretando-la-media-a-posteriori" id="toc-interpretando-la-media-a-posteriori" class="nav-link" data-scroll-target="#interpretando-la-media-a-posteriori"><span class="header-section-number">5.2.1</span> Interpretando la media a posteriori</a></li>
  <li><a href="#interpretando-las-predicciones-a-posteriori" id="toc-interpretando-las-predicciones-a-posteriori" class="nav-link" data-scroll-target="#interpretando-las-predicciones-a-posteriori"><span class="header-section-number">5.2.2</span> Interpretando las predicciones a posteriori</a></li>
  </ul></li>
  <li><a href="#generalizando-el-modelo-lineal" id="toc-generalizando-el-modelo-lineal" class="nav-link" data-scroll-target="#generalizando-el-modelo-lineal"><span class="header-section-number">5.3</span> Generalizando el modelo lineal</a></li>
  <li><a href="#generalizando-el-modelo-lineal-para-datos-de-conteo" id="toc-generalizando-el-modelo-lineal-para-datos-de-conteo" class="nav-link" data-scroll-target="#generalizando-el-modelo-lineal-para-datos-de-conteo"><span class="header-section-number">5.4</span> Generalizando el modelo lineal para datos de conteo</a></li>
  <li><a href="#regresión-robusta" id="toc-regresión-robusta" class="nav-link" data-scroll-target="#regresión-robusta"><span class="header-section-number">5.5</span> Regresión robusta</a></li>
  <li><a href="#regresión-logística" id="toc-regresión-logística" class="nav-link" data-scroll-target="#regresión-logística"><span class="header-section-number">5.6</span> Regresión logística</a></li>
  <li><a href="#el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris." id="toc-el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris." class="nav-link" data-scroll-target="#el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris."><span class="header-section-number">5.7</span> El modelo logístico aplicado al conjunto de datos del iris.</a></li>
  <li><a href="#clasificación-con-regresión-logística" id="toc-clasificación-con-regresión-logística" class="nav-link" data-scroll-target="#clasificación-con-regresión-logística"><span class="header-section-number">5.8</span> Clasificación con regresión logística</a></li>
  <li><a href="#interpretación-de-los-coeficientes-de-una-regresión-logística" id="toc-interpretación-de-los-coeficientes-de-una-regresión-logística" class="nav-link" data-scroll-target="#interpretación-de-los-coeficientes-de-una-regresión-logística"><span class="header-section-number">5.9</span> Interpretación de los coeficientes de una regresión logística</a></li>
  <li><a href="#varianza-variable" id="toc-varianza-variable" class="nav-link" data-scroll-target="#varianza-variable"><span class="header-section-number">5.10</span> Varianza variable</a></li>
  <li><a href="#regresión-por-cuantiles" id="toc-regresión-por-cuantiles" class="nav-link" data-scroll-target="#regresión-por-cuantiles"><span class="header-section-number">5.11</span> Regresión por cuantiles</a></li>
  <li><a href="#regresión-lineal-jerárquica" id="toc-regresión-lineal-jerárquica" class="nav-link" data-scroll-target="#regresión-lineal-jerárquica"><span class="header-section-number">5.12</span> Regresión lineal jerárquica</a></li>
  <li><a href="#regresión-lineal-múltiple" id="toc-regresión-lineal-múltiple" class="nav-link" data-scroll-target="#regresión-lineal-múltiple"><span class="header-section-number">5.13</span> Regresión lineal múltiple</a></li>
  <li><a href="#bambi-una-sintaxis-para-gobernarlos-a-todos" id="toc-bambi-una-sintaxis-para-gobernarlos-a-todos" class="nav-link" data-scroll-target="#bambi-una-sintaxis-para-gobernarlos-a-todos"><span class="header-section-number">5.14</span> Bambi: una sintaxis para gobernarlos a todos</a></li>
  <li><a href="#bicicletas-bambinas" id="toc-bicicletas-bambinas" class="nav-link" data-scroll-target="#bicicletas-bambinas"><span class="header-section-number">5.15</span> Bicicletas bambinas</a></li>
  <li><a href="#regresión-polinomial" id="toc-regresión-polinomial" class="nav-link" data-scroll-target="#regresión-polinomial"><span class="header-section-number">5.16</span> Regresión polinomial</a></li>
  <li><a href="#splines" id="toc-splines" class="nav-link" data-scroll-target="#splines"><span class="header-section-number">5.17</span> Splines</a></li>
  <li><a href="#modelos-distribucionales" id="toc-modelos-distribucionales" class="nav-link" data-scroll-target="#modelos-distribucionales"><span class="header-section-number">5.18</span> Modelos distribucionales</a></li>
  <li><a href="#predictores-categóricos" id="toc-predictores-categóricos" class="nav-link" data-scroll-target="#predictores-categóricos"><span class="header-section-number">5.19</span> Predictores Categóricos</a>
  <ul class="collapse">
  <li><a href="#pingüinos-categóricos" id="toc-pingüinos-categóricos" class="nav-link" data-scroll-target="#pingüinos-categóricos"><span class="header-section-number">5.19.1</span> Pingüinos Categóricos</a></li>
  <li><a href="#relación-con-modelos-jerárquicos" id="toc-relación-con-modelos-jerárquicos" class="nav-link" data-scroll-target="#relación-con-modelos-jerárquicos"><span class="header-section-number">5.19.2</span> Relación con modelos jerárquicos</a></li>
  </ul></li>
  <li><a href="#interacciones" id="toc-interacciones" class="nav-link" data-scroll-target="#interacciones"><span class="header-section-number">5.20</span> Interacciones</a></li>
  <li><a href="#interpretando-modelos-con-bambi" id="toc-interpretando-modelos-con-bambi" class="nav-link" data-scroll-target="#interpretando-modelos-con-bambi"><span class="header-section-number">5.21</span> Interpretando modelos con Bambi</a></li>
  <li><a href="#selección-de-variables" id="toc-selección-de-variables" class="nav-link" data-scroll-target="#selección-de-variables"><span class="header-section-number">5.22</span> Selección de Variables</a></li>
  <li><a href="#inferencia-predictiva-por-proyección" id="toc-inferencia-predictiva-por-proyección" class="nav-link" data-scroll-target="#inferencia-predictiva-por-proyección"><span class="header-section-number">5.23</span> Inferencia predictiva por proyección</a></li>
  <li><a href="#selección-de-variables-con-kulprit" id="toc-selección-de-variables-con-kulprit" class="nav-link" data-scroll-target="#selección-de-variables-con-kulprit"><span class="header-section-number">5.24</span> Selección de variables con Kulprit</a></li>
  <li><a href="#ejercicios" id="toc-ejercicios" class="nav-link" data-scroll-target="#ejercicios"><span class="header-section-number">5.25</span> Ejercicios</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-linear-models" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelos lineales y generalizaciones</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="b7afa352" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> bambi <span class="im">as</span> bmb</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> kulprit <span class="im">as</span> kpt</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">import</span> preliz <span class="im">as</span> pz</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="im">from</span> scipy.interpolate <span class="im">import</span> PchipInterpolator</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="im">from</span> scipy.stats <span class="im">import</span> linregress</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="im">import</span> xarray <span class="im">as</span> xr</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="im">import</span> warnings</span>
<span id="cb1-14"><a href="#cb1-14"></a>warnings.simplefilter(action<span class="op">=</span><span class="st">'ignore'</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="c45ed9a6-3a98-40fc-8a98-8577da4fabf8" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>plt.style.use(<span class="st">'arviz-doc'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La música, ya sea la Suite para violonchelo N° 1 de Bach, <em>arrancármelo</em> de Wos o Libertango de Piazzolla, se construye con patrones recurrentes. Las mismas escalas, progressiones de acordes, riffs, etc. aparecen una y otra vez dando lugar a un maravilloso paisaje sonoro capaz de provocar y modular toda la gama de emociones humanas. De manera similar, el universo estadístico está compuesto de patrones recurrentes, pequeños motivos que aparecen una y otra vez. En este capítulo, vamos a ver uno de los más populares y útiles, el modelo lineal. Este es un modelo muy útil en sí mismo y también el componente básico de muchos otros modelos. Es probable que algunos de los siguientes términos te resulten familiares: regresión lineal simple, regresión múltiple, regresión logística, ANOVA, ANCOVA. Todos estos métodos son variaciones del mismo motivo subyacente, el modelo de regresión lineal. En este capítulo, cubriremos los siguientes temas:</p>
<ul>
<li>Repaso sobre regresión lineal</li>
<li>Modelos lineales generalizados</li>
<li>Regresión jerárquica</li>
<li>Regresión polinómica y splines</li>
<li>Interacciones</li>
<li>Predictores categóricos</li>
<li>Modelos distribucionales</li>
<li>Cómo usar Bambi para construir y analizar modelos</li>
<li>Selección de variables</li>
</ul>
<p>Supongamos que tenemos una variable <span class="math inline">\(X\)</span>, y a partir de esta queremos predecir o modelar una variable <span class="math inline">\(Y\)</span>. Además, estás variables se encuentran apareadas <span class="math inline">\(\{(x_1,y_1), (x_2,y_2), \dots (x_n,y_n)\}\)</span>. En el caso más simple <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son variables aleatorias continuas y unidimensionales, usando un lenguaje de programación, como Python, las representaríamos usando <em>arrays</em> de dimensión 1 y de tipo flotante.</p>
<p>Las variable <span class="math inline">\(Y\)</span> suele recibir distintos nombres como variable dependiente, predicha o respuesta, mientras que <span class="math inline">\(X\)</span> recibe nombres como variable independiente, predictora o <em>de entrada</em>. En <em>Machine learning</em> es común hablar de <em>features</em> en vez de variables y es común pensar que una regresión lineal es un ejemplo de <a href="https://es.wikipedia.org/wiki/Aprendizaje_supervisado">aprendizaje supervisado</a>.</p>
<p>Algunas situaciones típicas en las que se pueden utilizar modelos de regresión lineal:</p>
<ul>
<li><p>Modelar la relación entre la salinidad del suelo y la productividad de los cultivos. Luego, responder preguntas como: ¿Es la relación lineal? ¿Qué tan fuerte es esta relación?</p></li>
<li><p>Encontrar una relación entre el consumo promedio de chocolate por país y el número de premios Nobel en ese país, y luego comprender por qué esta relación es probablemente espuria.</p></li>
<li><p>Predecir la factura de gas de una casa utilizando la radiación solar del informe meteorológico local. ¿Qué tan precisa es esta predicción?</p></li>
</ul>
<section id="la-idea-central-en-regresión-lineal" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="la-idea-central-en-regresión-lineal"><span class="header-section-number">5.1</span> La idea central en regresión lineal</h2>
<p>Anteriormente vimos el modelo normal, que (omitiendo las distribuciones a priori) definimos como:</p>
<p><span class="math display">\[
Y \sim \mathcal{N}(\mu, \sigma)
\]</span></p>
<p>La idea central de la regresión lineal es extender este modelo, agregando una variable predictora <span class="math inline">\(X\)</span> a la estimación de la media <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\mu &amp;= \alpha + \beta X  \\
Y &amp;\sim \mathcal{N}(\mu, \sigma)
\end{aligned}
\]</span></p>
<p>Este modelo dice que existe una relación lineal entre la variable <span class="math inline">\(X\)</span> y la variable <span class="math inline">\(Y\)</span>. Pero esta relación solo es válida en promedio, por lo que agregamos un término de error o ruido <span class="math inline">\(\sigma\)</span>. Además, el modelo dice que la media de <span class="math inline">\(Y\)</span> es una función lineal de <span class="math inline">\(X\)</span>, con <strong>intercepto</strong> <span class="math inline">\(\alpha\)</span> y <strong>pendiente</strong> <span class="math inline">\(\beta\)</span>. El intercepto nos dice el valor de <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X=0\)</span>, la pendiente nos dice el cambio en <span class="math inline">\(Y\)</span> por unidad de cambio en <span class="math inline">\(X\)</span>. Debido a que no conocemos los valores de <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> o <span class="math inline">\(\sigma\)</span>, debemos determinar una distribución a priori para estos parámetros.</p>
<p>Una suposición típica cuando se establecen priors para modelos lineales es suponer que son independientes. Esta suposición simplifica enormemente la elección de priors, ya que en vez de definir una distribución conjunta para los 3 parámetros, podemos definir 3 distribuciones por separado. Al menos en principio, <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> pueden tomar cualquier valor en los reales, por lo que es común usar a prioris normales para ellos. En cambio <span class="math inline">\(\sigma\)</span> debe ser un número positivo, por lo que es común usar distribuciónes como seminormal, exponencial, gamma-inversa, etc.</p>
<p>Los valores que puede tomar el intercepto pueden variar mucho de un problema a otro. Por ejemplo, yo solía trabajar con problemas donde era esperable que <span class="math inline">\(\alpha\)</span> estuviera alrededor de cero y con una desviación estándar muy por debajo de 1. Pero esta experiencia (casi anecdótica) es dificil de trasladar a cualquier otro problema. Con respecto a la pendiente (<span class="math inline">\(\beta\)</span>), puede ser más fácil tener una noción informada. Usualmente tenemos una idea del signo de la pendiente, por ejemplo esperamos que el peso de un animal aumente, en promedio, con la variable largo (o altura). Para <span class="math inline">\(\sigma\)</span>, podemos establecerlo en un valor grande en la escala de la variable <span class="math inline">\(Y\)</span>, por ejemplo, 2 veces el valor de su desviación estándar. Debemos tener cuidado al usar los datos observados para estimar a prioris, por lo general, está bien si los datos se usan para evitar el uso de a prioris muy restrictivos. Si no tenemos demasiado conocimiento del parámetro, tiene sentido asegurarse que la distribución a priori sea realmente vaga. En cambio, si queremos definir distribuciones a priori más informativas, entonces no deberíamos obtener esa información de los datos observados, sino que deberíamos obtenerla de nuestro conocimiento del dominio.</p>
</section>
<section id="bicicletas-lineales" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="bicicletas-lineales"><span class="header-section-number">5.2</span> Bicicletas lineales</h2>
<p>Ahora que tenemos una idea general de cómo luce un modelo lineal Bayesiano, tratemos de cimentar esta idea con un ejemplo.</p>
<p>Vamos a empezar muy sencillo, tenemos un registro de temperaturas y del número de bicicletas alquiladas en una ciudad. Queremos modelar la relación entre la temperatura y el número de bicicletas alquiladas. Usaremos <a href="https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset">bike-sharing dataset</a> del repositorio <a href="https://archive.ics.uci.edu/datasets">UCI Machine Learning Repository</a>. El conjunto de datos original contiene 17379 registros, cada registro tiene 17 variables, pero para este ejemplo usaremos tan solo 348 registros y dos variables <code>temperatura</code> y <code>alquiladas</code>. La variable ‘temperatura’ es la temperatura en Celsius y ‘alquiladas’ es el número de bicicletas alquiladas.</p>
<p>Carguemos los datos y grafiquémoslos</p>
<div id="b49b3ddd" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>bicis <span class="op">=</span> pd.read_csv(<span class="st">"datos/bicis.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>bicis.plot(x<span class="op">=</span><span class="st">"temperatura"</span>, y<span class="op">=</span><span class="st">"alquiladas"</span>, kind<span class="op">=</span><span class="st">"scatter"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Construyamos un modelo lineal bayesiano para estos datos. La temperatura será nuestra variable independiente (nuestra “X”) y el número de bicicletas alquiladas será nuestra variable dependiente (nuestra “Y”). Vamos a utilizar el siguiente modelo:</p>
<div id="0a9d8e36" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> modelo_bl:</span>
<span id="cb4-2"><a href="#cb4-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>    σ <span class="op">=</span> pm.HalfCauchy(<span class="st">'σ'</span>, <span class="dv">10</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, α <span class="op">+</span> β <span class="op">*</span> bicis.temperatura)</span>
<span id="cb4-6"><a href="#cb4-6"></a>    _ <span class="op">=</span> pm.Normal(<span class="st">'y_pred'</span>, mu<span class="op">=</span>μ, sigma<span class="op">=</span>σ, observed<span class="op">=</span>bicis.alquiladas)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a>pm.model_to_graphviz(modelo_bl)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-5-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Antes de calcular la distribución a posteriori tomemos un momento para leer el código línea por línea y asegurarnos de entender lo que está pasando. Comparemos el código con la representación visual del modelo.</p>
<p>Como ya dijimos, este modelo es similar a un modelo normal, la diferenciea principal es que la media se modela como una función lineal de la temperatura. El intercepto es <span class="math inline">\(\alpha\)</span> y la pendiente es <span class="math inline">\(\beta\)</span>. El término de ruido es <span class="math inline">\(\sigma\)</span> y la media es <span class="math inline">\(\mu\)</span>.</p>
<p>Algo importante a notar es que la variable <span class="math inline">\(\mu\)</span> es una variable determinista (<code>pm.Deterministic</code>). Le llamamos así ya que una vez conocidos los valores de <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>, el valor de <span class="math inline">\(\mu\)</span> queda determinado. En vez que <code>μ = pm.Deterministic('μ', α + β * bikes.temperatura)</code> podríamos haber escrito <code>μ = α + β * bicicletas.temperatura</code> o incluso <code>_ = pm.Normal('y_pred', mu=α + β * bicicletas.temperatura, sigma=ϵ, observado=bicicletas.alquiladas)</code> y el modelo sería el mismo. La única razón de usar <code>pm.Deterministic</code>, es que de esta forma le pedimos a PyMC que guarde los valores de <span class="math inline">\(\mu\)</span> en el InferenceData.</p>
<div id="093a4154" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="cf">with</span> modelo_bl:</span>
<span id="cb5-2"><a href="#cb5-2"></a>    idata_bl <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, σ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1101861460b544cea6c97d499a9e2af9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>Veamos un trace plot de <code>idata_bl</code> combinando todas las cadenas en una sola curva</p>
<div id="b6c053f9" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>az.plot_trace(idata_bl, combined<span class="op">=</span><span class="va">True</span>)<span class="op">;</span>  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Algo que suele resultar confuso o inesperado para muchos estudiantes es la gráfica para <span class="math inline">\(\mu\)</span>, por qué hay tantas curvas? Porque a cada observaciones le corresponde una curva, para cáda valor de <span class="math inline">\(X\)</span>, hacemos</p>
<p><span class="math display">\[
\mu_i = \alpha + \beta + x_i
\]</span></p>
<p>Es decir un valor de <span class="math inline">\(\mu\)</span> por cada valor de <span class="math inline">\(X\)</span>, además como <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> son distribuciones. Entonces cada <span class="math inline">\(\mu_i\)</span> es también una distribución.</p>
<p>Podemos comprobar que hay 348 distribuciones para <span class="math inline">\(\mu\)</span> inspeccionado el InfereceData, por ejemplo:</p>
<div id="92b6a9ca" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>cadenas, muestras, mus <span class="op">=</span> idata_bl.posterior[<span class="st">"μ"</span>].shape</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="ss">f"</span><span class="sc">{</span>cadenas<span class="op">=</span><span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>muestras<span class="op">=</span><span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>mus<span class="op">=</span><span class="sc">}</span><span class="ss">"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>'cadenas=4, muestras=1000, mus=348'</code></pre>
</div>
</div>
<section id="interpretando-la-media-a-posteriori" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="interpretando-la-media-a-posteriori"><span class="header-section-number">5.2.1</span> Interpretando la media a posteriori</h3>
<p>Habiendo aclarado este punto vamos a focalizarnos en intepretar los parámetros del modelo, pero omitiendo <code>μ</code>. Hagamos un gráfico de las distribuciones a posteriori marginales para <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> y <span class="math inline">\(\sigma\)</span>,</p>
<div id="cfc3be88" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>az.plot_posterior(idata_bl, var_names<span class="op">=</span>[<span class="st">'~μ'</span>], figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">3</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Si solo leemos las medias de cada distribución podemos decir que <span class="math inline">\(\mu = 69 + 7,9 X\)</span>. Con esta información podemos decir que el valor esperado de bicicletas alquiladas cuando la temperatura es 0 es de 69 y por cada grado de temperatura el número de bicicletas alquiladas aumenta en 7,9. Así que para una temperatura de 28 grados esperamos alquilar <span class="math inline">\(69 + 7.9 * 28 \approx 278\)</span> bicicletas. Este es nuestro valor esperado, pero la distribución a posteriori también nos informa sobre la incertidumbre en torno a esta estimación. Por ejemplo, el HDI 94% para <span class="math inline">\(\beta\)</span> es (6,1, 9,7), por lo que por cada grado de temperatura el número de bicicletas alquiladas podría aumentar de 6 a unas 10.</p>
<p>Incluso si omitimos la incertidumbre a posteriori, y solo prestaramos atención a las medias, tenemos incertidumbre sobre el número de bicicletas alquiladas debido al valor de <span class="math inline">\(\sigma\)</span> de 170. Entonces, si decimos que para una temperatura de 28 grados, esperamos alquilar 278 bicicletas, no debería sorprendernos que el número real resulte estar entre <span class="math inline">\(\approx 100\)</span> y <span class="math inline">\(\approx 500\)</span> bicicletas.</p>
<p>Ahora vamos a crear algunas gráficas que nos ayudarán a visualizar la incertidumbre combinada de estos parámetros. En una primer lectura recomiendo saltearse el código y focalizarse en las figuras y su interpretación.</p>
<p>La siguiente figura tiene dos paneles. Ambos muestran del número medio de bicicletas alquiladas en función de la temperatura. La diferencia está en como se representa la incertidumbre. Para el panel izquierdo, tomamos 50 muestras de la distribución a posteriori de <span class="math inline">\(\mu\)</span> y las dibujamos como líneas individuales. Para el panel derecho tomamos todas las muestras a posteriori de <span class="math inline">\(\mu\)</span> y las usamos para calcular el HDI 94%.</p>
<div id="7372ab8c" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>posterior <span class="op">=</span> az.extract(idata_bl, num_samples<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>x_plot <span class="op">=</span> xr.DataArray(np.linspace(bicis.temperatura.<span class="bu">min</span>(), bicis.temperatura.<span class="bu">max</span>(), <span class="dv">50</span>), dims<span class="op">=</span><span class="st">"plot_id"</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a>linea_media <span class="op">=</span> posterior[<span class="st">'α'</span>].mean() <span class="op">+</span> posterior[<span class="st">'β'</span>].mean() <span class="op">*</span> x_plot</span>
<span id="cb11-4"><a href="#cb11-4"></a>lineas <span class="op">=</span> posterior[<span class="st">'α'</span>] <span class="op">+</span> posterior[<span class="st">'β'</span>] <span class="op">*</span> x_plot</span>
<span id="cb11-5"><a href="#cb11-5"></a>hdi_lines <span class="op">=</span> az.hdi(idata_bl.posterior[<span class="st">'μ'</span>])</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a>axes[<span class="dv">0</span>].plot(bicis.temperatura, bicis.alquiladas,  <span class="st">'.'</span>, color<span class="op">=</span><span class="st">"0.75"</span>,  zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a>lines_ <span class="op">=</span> axes[<span class="dv">0</span>].plot(x_plot, lineas.T, c<span class="op">=</span><span class="st">'C1'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'lineas'</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a>plt.setp(lines_[<span class="dv">1</span>:], label<span class="op">=</span><span class="st">"_"</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a>axes[<span class="dv">0</span>].plot(x_plot, linea_media, c<span class="op">=</span><span class="st">'C0'</span>, label<span class="op">=</span><span class="st">'linea media'</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'temperatura'</span>)</span>
<span id="cb11-14"><a href="#cb11-14"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'bicis alquiladas'</span>)</span>
<span id="cb11-15"><a href="#cb11-15"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb11-16"><a href="#cb11-16"></a></span>
<span id="cb11-17"><a href="#cb11-17"></a>axes[<span class="dv">1</span>].plot(bicis.temperatura, bicis.alquiladas, <span class="st">'.'</span>, color<span class="op">=</span><span class="st">"0.75"</span>,  zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb11-18"><a href="#cb11-18"></a>idx <span class="op">=</span> np.argsort(bicis.temperatura.values)</span>
<span id="cb11-19"><a href="#cb11-19"></a>axes[<span class="dv">1</span>].fill_between(bicis.temperatura[idx], hdi_lines[<span class="st">"μ"</span>][:,<span class="dv">0</span>][idx], hdi_lines[<span class="st">"μ"</span>][:,<span class="dv">1</span>][idx],</span>
<span id="cb11-20"><a href="#cb11-20"></a>                     color<span class="op">=</span><span class="st">"C1"</span>, label<span class="op">=</span><span class="st">'HDI'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb11-21"><a href="#cb11-21"></a>axes[<span class="dv">1</span>].plot(x_plot, linea_media, c<span class="op">=</span><span class="st">'C0'</span>, label<span class="op">=</span><span class="st">'linea media'</span>)</span>
<span id="cb11-22"><a href="#cb11-22"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'temperatura'</span>)</span>
<span id="cb11-23"><a href="#cb11-23"></a>axes[<span class="dv">1</span>].legend()<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ambos paneles transmiten esencialmente la misma información, si volvemos a correr el código para generar el gráfico, las lineas serán diferentes, porque las 50 muestras serán distintas cada vez (salvo que fijemos una semilla). Sin embargo, el área sombreada será la misma, porque estamos utilizando todas las muestras ya calculadas. Si reajustamos el modelo (sin fijar una semillar), no solo obtendremos líneas diferentes, sino que el área sombreada también podría cambiar, pero la diferencia debería ser muy pequeña, caso contrario es probable que necesitemos más muestras (incrementar la candidad de <code>draws</code> en <code>pm.sample(.)</code>)</p>
<p>OK, pero ¿Por qué mostramos dos gráficos ligeramente diferentes si transmiten la misma información? Bueno, por un lado para resaltar que hay diferentes formas de representar la incertidumbre. ¿Cuál es mejor? Como de costumbre, eso depende del contexto, el área sombreada es una buena opción, es muy común y es simple de calcular e interpretar. Pero pueden darse situaciones donde nos interese mostrar muestras individuales de la distribución a posteriori, por ejemplo, la mayoría de las líneas podrían abarcar una determinada región, pero algunas podrían tener una pendiente muy alta. Un área sombreada podría opacar esta información. Al mostrar muestras individuales, puede ser una buena idea animarlas si las está mostrando en una presentación o en un video (ver <a href="http://users.eecs.northwestern.edu/~jhullman/hops_jobs_pfs.pdf">Hypothetical Outcome Plots</a> para obtener más información al respecto).</p>
<p>Otra razón para mostrar estas figuras es que vean diferentes formas de extraer información de la distribución a posteriori. Si prestamos atención al código veremos que en la primera línea usamos <code>az.extract</code> toma la dimensión <code>chain</code> y <code>draw</code> y las apila en una sola dimensión <code>sample</code>, que puede ser útil para el procesamiento posterior. Además, usamos el argumento <code>num_samples</code> para solicitar una submuestra de la distribución a posteriori. Por defecto <code>az.extract</code> opera sobre el grupo <code>posterior</code> de un InferenceData. Si deseamos extraer información de otro grupo, podemos usar el argumento <code>group</code>. En la segunda línea, definimos un DataArray llamado <code>x_plot</code>, con valores igualmente espaciados empezando por la temperatura mínima observada y terminado en la máxima observada. La razón para crear un DataArray es poder usar las capacidades de alineación automática de Xarray (esto lo hacemos en las próximas dos líneas). Si usaramos un arreglo NumPy necesitariamos agregar dimensiones adicionales, lo que puede resultar confuso, la mejor manera de entender completamente lo que quiero decir es definir <code>x_plot = np.linspace(bikes.temperature.min(), bikes.temperature.max())</code> e intentar rehacer el gráfico. En la tercer y cuarta línea de código, calculamos la media del posterior de <span class="math inline">\(\mu\)</span> para cada valor de <code>x_plot</code> las líneas individuales, respectivamente. Podríamos haber usado <code>posterior['μ']</code>, pero en su lugar reescribimos explícitamente el modelo lineal, lo hacemos para ser explícitos y con la esperanza de que te ayude a obtener más intuición sobre los modelos lineales.</p>
</section>
<section id="interpretando-las-predicciones-a-posteriori" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="interpretando-las-predicciones-a-posteriori"><span class="header-section-number">5.2.2</span> Interpretando las predicciones a posteriori</h3>
<p>¿Qué pasa si no solo estamos interesados en el valor esperado (promedio), sino que queremos pensar en términos de predicciones, es decir, en términos de bicicletas alquiladas? Bueno, para eso podemos usar la distribución predictiva a posteriori. Después de ejecutar la siguiente línea de código <code>idata_lb</code> contendrá un nuevo grupo <code>posterior_predictive</code> con una variable <code>y_pred</code> que representa la distribución predictiva a posteriori para el número de bicicletas alquiladas.</p>
<div id="7058108f" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>pm.sample_posterior_predictive(idata_bl, model<span class="op">=</span>modelo_bl, extend_inferencedata<span class="op">=</span><span class="va">True</span>, random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling: [y_pred]</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"157403ba883f45638e4a2c4f56de689a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">

            <div>
              <div class="xr-header">
                <div class="xr-obj-type">arviz.InferenceData</div>
              </div>
              <ul class="xr-sections group-sections">
              
            <li class="xr-section-item">
                  <input id="idata_posterior1589240e-5cfb-4281-8cf8-5fb2f4063ec9" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior1589240e-5cfb-4281-8cf8-5fb2f4063ec9" class="xr-section-summary">posterior</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 11MB
Dimensions:  (chain: 4, draw: 1000, μ_dim_0: 348)
Coordinates:
  * chain    (chain) int64 32B 0 1 2 3
  * draw     (draw) int64 8kB 0 1 2 3 4 5 6 7 ... 993 994 995 996 997 998 999
  * μ_dim_0  (μ_dim_0) int64 3kB 0 1 2 3 4 5 6 7 ... 341 342 343 344 345 346 347
Data variables:
    α        (chain, draw) float64 32kB 62.5 47.79 81.1 ... 85.27 59.62 78.58
    β        (chain, draw) float64 32kB 8.966 8.725 6.576 ... 7.612 7.999 6.555
    μ        (chain, draw, μ_dim_0) float64 11MB 91.9 58.21 ... 100.1 130.9
    σ        (chain, draw) float64 32kB 168.5 172.8 168.4 ... 163.7 159.4 178.3
Attributes:
    created_at:                 2024-07-22T17:15:59.387370+00:00
    arviz_version:              0.19.0
    inference_library:          pymc
    inference_library_version:  5.15.1
    sampling_time:              2.4274613857269287
    tuning_steps:               1000</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-840709ed-e931-4ff3-a2b9-70de5be8ccf2" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-840709ed-e931-4ff3-a2b9-70de5be8ccf2" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">μ_dim_0</span>: 348</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-417efa48-bec6-473b-9d03-b869167d00a9" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-417efa48-bec6-473b-9d03-b869167d00a9" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-50cd38d1-28b8-4d85-9caa-71971c1cdb81" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-50cd38d1-28b8-4d85-9caa-71971c1cdb81" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6585b14d-fd1f-4e23-8100-246036e978d9" class="xr-var-data-in" type="checkbox"><label for="data-6585b14d-fd1f-4e23-8100-246036e978d9" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-b5924e79-c91e-45d7-9568-4e446f28171c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b5924e79-c91e-45d7-9568-4e446f28171c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-45630a79-7b9c-49d0-91d3-af9f695a6761" class="xr-var-data-in" type="checkbox"><label for="data-45630a79-7b9c-49d0-91d3-af9f695a6761" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">μ_dim_0</span></div><div class="xr-var-dims">(μ_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 343 344 345 346 347</div><input id="attrs-9f2f382c-abbd-45f3-ae95-92fb120a5e99" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9f2f382c-abbd-45f3-ae95-92fb120a5e99" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d33db7cd-c913-458a-9837-667c66bb6155" class="xr-var-data-in" type="checkbox"><label for="data-d33db7cd-c913-458a-9837-667c66bb6155" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 345, 346, 347])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-173abbad-881a-4c0e-b48e-1e6c793e767f" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-173abbad-881a-4c0e-b48e-1e6c793e767f" class="xr-section-summary">Data variables: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>α</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">62.5 47.79 81.1 ... 59.62 78.58</div><input id="attrs-344f09be-4ca1-4ad2-b65f-b82fe85660e1" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-344f09be-4ca1-4ad2-b65f-b82fe85660e1" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-77a9a1d0-c7dd-439d-89b6-e0cb4ecc613e" class="xr-var-data-in" type="checkbox"><label for="data-77a9a1d0-c7dd-439d-89b6-e0cb4ecc613e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 62.49743693,  47.7851502 ,  81.0967781 , ...,  74.92214114,
         72.11017461,  68.94318738],
       [ 74.62738274,  65.09123583,  32.61590784, ...,  59.77707482,
         70.46653223,  75.8109043 ],
       [ 65.74894981, 101.60876086,  86.60738904, ...,  91.21114365,
        105.73948633,  57.62041875],
       [ 85.79646577,  63.45579066,  41.66613253, ...,  85.26761107,
         59.62264272,  78.57622637]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>β</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">8.966 8.725 6.576 ... 7.999 6.555</div><input id="attrs-23f35b0e-d63c-45b1-abd0-c4db8da8a566" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-23f35b0e-d63c-45b1-abd0-c4db8da8a566" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2eb933af-a172-4c09-9102-6774fe68a6c1" class="xr-var-data-in" type="checkbox"><label for="data-2eb933af-a172-4c09-9102-6774fe68a6c1" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[8.96576975, 8.72454039, 6.57649715, ..., 7.00435197, 7.70277124,
        7.38297283],
       [7.47514547, 8.26584494, 9.8874908 , ..., 8.68137832, 7.90494386,
        6.78427703],
       [8.50475798, 6.08482785, 7.30749554, ..., 5.78038701, 6.04893982,
        8.94044506],
       [6.63157403, 8.43311569, 9.00526467, ..., 7.61183246, 7.9991286 ,
        6.55513651]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>μ</span></div><div class="xr-var-dims">(chain, draw, μ_dim_0)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">91.9 58.21 83.47 ... 100.1 130.9</div><input id="attrs-edd626d7-c2ab-4d1b-aff1-3cba06ba5dfe" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-edd626d7-c2ab-4d1b-aff1-3cba06ba5dfe" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d5785bff-8df5-49a8-a9dd-31af81e27d6d" class="xr-var-data-in" type="checkbox"><label for="data-d5785bff-8df5-49a8-a9dd-31af81e27d6d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[ 91.89583584,  58.20927992,  83.47443449, ..., 100.3321058 ,
          91.89143947, 134.05391293],
        [ 76.39256772,  43.6123686 ,  68.19774917, ...,  84.60185483,
          76.38828964, 117.4163567 ],
        [102.66084811,  77.95136469,  96.48365156, ..., 108.84895096,
         102.65762333, 133.58429155],
        ...,
        [ 97.88912994,  71.57209291,  91.31005632, ..., 104.47981939,
          97.88569535, 130.82439581],
        [ 97.36725215,  68.42608575,  90.1321647 , ..., 104.61511368,
          97.3634751 , 133.58656549],
        [ 93.15165878,  65.41205201,  86.21695277, ..., 100.09860853,
          93.14803854, 127.86724334]],

       [[ 99.1380845 ,  71.05216295,  92.11680223, ..., 106.17176335,
          99.13441906, 134.28707533],
        [ 92.19460939,  61.13783953,  84.430636  , ...,  99.97229065,
          92.19055624, 131.06155978],
        [ 65.03659306,  27.8869092 ,  55.74943415, ...,  74.34014914,
          65.03174473, 111.52870819],
...
        [110.16480048,  88.44649457, 104.73537721, ..., 115.6038098 ,
         110.16196607, 137.34484278],
        [125.57371706, 102.84639355, 119.8920465 , ..., 131.26541902,
         125.57075096, 154.01652547],
        [ 86.93577905,  53.34437406,  78.53816476, ...,  95.34821994,
          86.9313951 , 128.97477657]],

       [[107.54113068,  82.62471014, 101.31220131, ..., 113.78105769,
         107.53787889, 138.72355196],
        [ 91.10763833,  59.42239195,  83.18655024, ...,  99.04271168,
          91.10350315, 130.76111499],
        [ 71.19403372,  37.35908585,  62.73553542, ...,  79.66746611,
          71.18961799, 113.53782047],
        ...,
        [110.226504  ,  81.62701649, 103.07683386, ..., 117.3887974 ,
         110.22277154, 146.01821276],
        [ 85.85146411,  55.79681177,  78.33801303, ...,  93.37818074,
          85.84754174, 123.4642837 ],
        [100.0702557 ,  75.44102935,  93.91312285, ..., 106.23825943,
         100.06704139, 130.89325896]]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>σ</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">168.5 172.8 168.4 ... 159.4 178.3</div><input id="attrs-0644f4fe-c552-47fa-91dc-79454a08b568" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0644f4fe-c552-47fa-91dc-79454a08b568" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c1980c28-37e1-4821-9878-d5e45c2fb131" class="xr-var-data-in" type="checkbox"><label for="data-c1980c28-37e1-4821-9878-d5e45c2fb131" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[168.5193324 , 172.75449318, 168.38667999, ..., 163.14853048,
        160.84224916, 164.20176184],
       [167.5906032 , 180.49112665, 169.93434131, ..., 152.39144481,
        184.39053547, 187.05346251],
       [169.08284223, 175.7237506 , 165.40491574, ..., 167.8089673 ,
        166.59478807, 178.89837676],
       [161.26600918, 172.03105632, 173.81270242, ..., 163.72896967,
        159.42143163, 178.33931821]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-f2394bf3-4f2f-4273-ab4a-96b045129c45" class="xr-section-summary-in" type="checkbox"><label for="section-f2394bf3-4f2f-4273-ab4a-96b045129c45" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-3922da54-b86a-42f6-be70-66ee4ddc8c26" class="xr-index-data-in" type="checkbox"><label for="index-3922da54-b86a-42f6-be70-66ee4ddc8c26" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-ed245959-4543-4a3d-837b-8fdc736d72b1" class="xr-index-data-in" type="checkbox"><label for="index-ed245959-4543-4a3d-837b-8fdc736d72b1" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>μ_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-2a97bff2-f301-4ed7-8f62-82d4e1f93a63" class="xr-index-data-in" type="checkbox"><label for="index-2a97bff2-f301-4ed7-8f62-82d4e1f93a63" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       338, 339, 340, 341, 342, 343, 344, 345, 346, 347],
      dtype='int64', name='μ_dim_0', length=348))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-f08e99bd-e7fa-4c34-bfce-b2726e3b5591" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-f08e99bd-e7fa-4c34-bfce-b2726e3b5591" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-07-22T17:15:59.387370+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>sampling_time :</span></dt><dd>2.4274613857269287</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_posterior_predictive843629fd-0d8d-4704-bc99-d9cece2aa802" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior_predictive843629fd-0d8d-4704-bc99-d9cece2aa802" class="xr-section-summary">posterior_predictive</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 11MB
Dimensions:       (chain: 4, draw: 1000, y_pred_dim_2: 348)
Coordinates:
  * chain         (chain) int64 32B 0 1 2 3
  * draw          (draw) int64 8kB 0 1 2 3 4 5 6 ... 993 994 995 996 997 998 999
  * y_pred_dim_2  (y_pred_dim_2) int64 3kB 0 1 2 3 4 5 ... 343 344 345 346 347
Data variables:
    y_pred        (chain, draw, y_pred_dim_2) float64 11MB -6.052 50.2 ... 143.3
Attributes:
    created_at:                 2024-07-22T17:16:10.668979+00:00
    arviz_version:              0.19.0
    inference_library:          pymc
    inference_library_version:  5.15.1</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-30a213df-5f72-40c4-ab9f-1661ee6a0ecb" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-30a213df-5f72-40c4-ab9f-1661ee6a0ecb" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">y_pred_dim_2</span>: 348</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-d64462c7-d298-4bd1-bb67-e2998bb35720" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-d64462c7-d298-4bd1-bb67-e2998bb35720" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-43a0f03d-7000-44e4-83ed-442eee6d164f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-43a0f03d-7000-44e4-83ed-442eee6d164f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-37017fb9-8f86-4ea7-a865-bfee3be51123" class="xr-var-data-in" type="checkbox"><label for="data-37017fb9-8f86-4ea7-a865-bfee3be51123" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-b05086ea-a17c-49ca-bf6e-e2e0b7484387" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b05086ea-a17c-49ca-bf6e-e2e0b7484387" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3ea55dc3-56e9-40e5-ab73-43912b6d71a5" class="xr-var-data-in" type="checkbox"><label for="data-3ea55dc3-56e9-40e5-ab73-43912b6d71a5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y_pred_dim_2</span></div><div class="xr-var-dims">(y_pred_dim_2)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 343 344 345 346 347</div><input id="attrs-de732c3d-79f4-4aa0-bbf6-d81b4ca9ddac" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-de732c3d-79f4-4aa0-bbf6-d81b4ca9ddac" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-75c4a175-81da-47e3-9f93-367f6fe86e9d" class="xr-var-data-in" type="checkbox"><label for="data-75c4a175-81da-47e3-9f93-367f6fe86e9d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 345, 346, 347])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-4de4f0c6-50e5-451e-bc3e-297af71f62ca" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-4de4f0c6-50e5-451e-bc3e-297af71f62ca" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>y_pred</span></div><div class="xr-var-dims">(chain, draw, y_pred_dim_2)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-6.052 50.2 64.69 ... 184.3 143.3</div><input id="attrs-eef85b92-2ccf-413c-8a0d-ff1518db2e01" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-eef85b92-2ccf-413c-8a0d-ff1518db2e01" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-33346618-a8fc-4cfd-9ad2-adcb41b19723" class="xr-var-data-in" type="checkbox"><label for="data-33346618-a8fc-4cfd-9ad2-adcb41b19723" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[-6.05155896e+00,  5.02047422e+01,  6.46926080e+01, ...,
          3.76660321e+02,  3.28003382e+02, -2.50354642e+01],
        [ 1.50492591e+02,  1.09691254e+02,  3.60819245e+02, ...,
          1.47698056e+02, -3.67746203e+01,  9.18606093e+01],
        [ 9.01975360e+01, -2.91342775e+02,  2.93138046e+02, ...,
         -2.45628211e+02, -9.99494724e+01,  1.04579562e+02],
        ...,
        [ 1.90613993e+02, -1.83680288e+02,  2.26622238e+02, ...,
          2.05949234e+02,  3.38825827e+02,  3.20729070e+02],
        [-1.21152826e+02,  8.14465864e+01,  1.35818644e+02, ...,
         -2.22302294e+02, -6.82669221e+01,  2.70600533e+02],
        [ 2.71909184e+01, -2.91668328e+01,  8.93924135e+01, ...,
          2.74103924e+02, -7.81866064e+01, -1.53368671e+02]],

       [[ 4.39810655e+01,  1.23604195e+02,  3.15248981e+02, ...,
         -3.09305335e+01,  3.42710548e+02,  7.73660265e+01],
        [-1.66827808e+02, -7.14719365e+00,  1.49014032e+02, ...,
          9.57363142e+01,  2.67616367e+02,  3.55588690e+01],
        [ 2.21255761e+02,  1.20934237e+02,  3.83859099e+00, ...,
          1.21233965e+02, -2.67192256e+02,  8.96933872e+01],
...
        [-9.73001731e+01,  1.22065471e+02, -7.01086631e+01, ...,
          3.46960801e+02,  2.16748755e+02,  3.28927890e+02],
        [ 3.75171296e+02,  2.31616710e+02,  3.20900178e+02, ...,
         -3.88860388e+01,  2.33705523e+01,  8.36921175e+01],
        [-2.25927075e+01,  3.72281197e+01, -1.66667266e+02, ...,
          2.95374716e+02,  2.18755971e+02,  3.15278589e+02]],

       [[ 2.23214995e+02,  1.95613273e+00,  6.26998927e+01, ...,
          5.46011703e+01, -1.35335488e+02,  1.65455692e+02],
        [ 2.38825080e+02,  4.02976096e+00, -6.26069488e+01, ...,
          2.08303225e+02,  3.19734445e+01, -2.63227241e+02],
        [-3.00792851e+01,  2.07819559e+01,  2.56357878e+02, ...,
          1.25024308e+02, -5.97975929e+01, -1.06019622e+02],
        ...,
        [ 1.76273949e+02, -1.17196334e+00,  1.28180064e+02, ...,
          1.50507543e+02,  8.52055432e+01,  7.13830106e+01],
        [ 3.12623456e+02, -3.43460967e-01,  6.56571721e+01, ...,
          1.21679028e+02, -3.86687805e+01,  1.20966016e+02],
        [ 7.01281216e+01, -7.83165070e+00, -2.16394678e+02, ...,
          4.31197787e+02,  1.84307685e+02,  1.43264069e+02]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-4de6f5a7-6ea9-469b-8a9a-29c2bfaa6979" class="xr-section-summary-in" type="checkbox"><label for="section-4de6f5a7-6ea9-469b-8a9a-29c2bfaa6979" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-a2399935-125e-4c43-9247-41054c8a0b05" class="xr-index-data-in" type="checkbox"><label for="index-a2399935-125e-4c43-9247-41054c8a0b05" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-5c96a513-9dc9-4b1a-9a49-da6cade7867a" class="xr-index-data-in" type="checkbox"><label for="index-5c96a513-9dc9-4b1a-9a49-da6cade7867a" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>y_pred_dim_2</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-e22fa375-0f3b-43af-b32c-1f2d9252ce69" class="xr-index-data-in" type="checkbox"><label for="index-e22fa375-0f3b-43af-b32c-1f2d9252ce69" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       338, 339, 340, 341, 342, 343, 344, 345, 346, 347],
      dtype='int64', name='y_pred_dim_2', length=348))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-d40abf1c-a382-497b-b48a-e31aca8a0e69" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-d40abf1c-a382-497b-b48a-e31aca8a0e69" class="xr-section-summary">Attributes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-07-22T17:16:10.668979+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_sample_stats95bb18ff-c46a-405b-8522-a54e2a1786e2" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_sample_stats95bb18ff-c46a-405b-8522-a54e2a1786e2" class="xr-section-summary">sample_stats</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 496kB
Dimensions:                (chain: 4, draw: 1000)
Coordinates:
  * chain                  (chain) int64 32B 0 1 2 3
  * draw                   (draw) int64 8kB 0 1 2 3 4 5 ... 995 996 997 998 999
Data variables: (12/17)
    acceptance_rate        (chain, draw) float64 32kB 0.7564 0.8197 ... 0.7183
    diverging              (chain, draw) bool 4kB False False ... False False
    energy                 (chain, draw) float64 32kB 2.292e+03 ... 2.294e+03
    energy_error           (chain, draw) float64 32kB 0.4801 -0.2678 ... 0.5114
    index_in_trajectory    (chain, draw) int64 32kB 1 2 -3 -2 -3 ... -2 0 -2 -4
    largest_eigval         (chain, draw) float64 32kB nan nan nan ... nan nan
    ...                     ...
    process_time_diff      (chain, draw) float64 32kB 0.0003078 ... 0.0006075
    reached_max_treedepth  (chain, draw) bool 4kB False False ... False False
    smallest_eigval        (chain, draw) float64 32kB nan nan nan ... nan nan
    step_size              (chain, draw) float64 32kB 0.5204 0.5204 ... 0.5206
    step_size_bar          (chain, draw) float64 32kB 0.5068 0.5068 ... 0.5639
    tree_depth             (chain, draw) int64 32kB 2 2 3 3 3 3 ... 3 3 3 1 3 3
Attributes:
    created_at:                 2024-07-22T17:15:59.398088+00:00
    arviz_version:              0.19.0
    inference_library:          pymc
    inference_library_version:  5.15.1
    sampling_time:              2.4274613857269287
    tuning_steps:               1000</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-51a1f161-9716-469c-b728-3abaa39b0a14" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-51a1f161-9716-469c-b728-3abaa39b0a14" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-dfab6769-8254-4ac0-9f8a-3144fba5a369" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-dfab6769-8254-4ac0-9f8a-3144fba5a369" class="xr-section-summary">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-06f8d0cc-6d2e-48f4-b17d-6eb6835e5c98" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-06f8d0cc-6d2e-48f4-b17d-6eb6835e5c98" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-71a4e38c-a737-468f-b559-7e987d0175ec" class="xr-var-data-in" type="checkbox"><label for="data-71a4e38c-a737-468f-b559-7e987d0175ec" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-5e57414d-75db-4cf6-8634-57328b47e692" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5e57414d-75db-4cf6-8634-57328b47e692" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-0e840340-9362-4cc4-8e07-cd1625255dce" class="xr-var-data-in" type="checkbox"><label for="data-0e840340-9362-4cc4-8e07-cd1625255dce" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-90d117f6-5bae-4259-b666-f2ba393d1cc1" class="xr-section-summary-in" type="checkbox"><label for="section-90d117f6-5bae-4259-b666-f2ba393d1cc1" class="xr-section-summary">Data variables: <span>(17)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>acceptance_rate</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.7564 0.8197 0.8515 ... 1.0 0.7183</div><input id="attrs-8092390f-fb37-4c86-bea9-bcb5d0dbe18f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-8092390f-fb37-4c86-bea9-bcb5d0dbe18f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9218c557-55b4-4097-bf78-a1ca14e5dc2a" class="xr-var-data-in" type="checkbox"><label for="data-9218c557-55b4-4097-bf78-a1ca14e5dc2a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.75635563, 0.81967172, 0.8515365 , ..., 0.89163324, 0.56127166,
        0.42770019],
       [1.        , 0.80732849, 0.71814044, ..., 0.98528259, 0.99898804,
        0.80181998],
       [0.99105692, 0.97253908, 0.67635143, ..., 0.75383604, 0.95766215,
        0.92824628],
       [0.99672972, 0.9016479 , 0.86364315, ..., 0.25422238, 1.        ,
        0.71827462]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>diverging</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-cb4325b6-d809-4d16-b34d-09542d9f0136" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-cb4325b6-d809-4d16-b34d-09542d9f0136" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-75455b55-b78d-42e1-a782-6629886a112d" class="xr-var-data-in" type="checkbox"><label for="data-75455b55-b78d-42e1-a782-6629886a112d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.292e+03 2.293e+03 ... 2.294e+03</div><input id="attrs-1f430bf8-3a11-4d3e-9d3e-852113ec999d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1f430bf8-3a11-4d3e-9d3e-852113ec999d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a9572555-7b2f-4f52-a9ca-d183524d77d2" class="xr-var-data-in" type="checkbox"><label for="data-a9572555-7b2f-4f52-a9ca-d183524d77d2" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2292.49667558, 2292.66198725, 2293.53496919, ..., 2293.87381972,
        2293.84069071, 2292.95133406],
       [2291.82346937, 2293.57630663, 2296.54998371, ..., 2296.11555248,
        2297.81123818, 2297.12009399],
       [2291.83189635, 2294.18917652, 2295.39044244, ..., 2295.38070214,
        2294.45185538, 2295.49584313],
       [2293.31220759, 2293.16420825, 2294.62537468, ..., 2293.89873468,
        2293.38079253, 2294.1485723 ]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.4801 -0.2678 ... -0.0812 0.5114</div><input id="attrs-944525da-550e-4b31-b888-71eb50bdee3f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-944525da-550e-4b31-b888-71eb50bdee3f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b39b9815-f157-483b-9114-3c319d7a3c00" class="xr-var-data-in" type="checkbox"><label for="data-b39b9815-f157-483b-9114-3c319d7a3c00" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 0.48011874, -0.26779274,  0.33163064, ...,  0.17124502,
        -0.43563145,  0.42704104],
       [-0.15384544,  0.14513703, -0.13887986, ..., -0.15512917,
        -0.16025993,  0.46059285],
       [ 0.01888158, -0.00671088, -0.09329776, ...,  0.53555502,
        -0.56831456,  0.10863194],
       [-0.2550174 , -0.15052447,  0.21794821, ...,  0.        ,
        -0.08119834,  0.51139737]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>index_in_trajectory</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">1 2 -3 -2 -3 4 ... -2 -1 -2 0 -2 -4</div><input id="attrs-8a30c6d5-158b-4e2b-ac12-852356b56e96" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-8a30c6d5-158b-4e2b-ac12-852356b56e96" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3e142de4-afe5-4c4d-aaeb-b2d09da096da" class="xr-var-data-in" type="checkbox"><label for="data-3e142de4-afe5-4c4d-aaeb-b2d09da096da" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 1,  2, -3, ...,  1, -3, -2],
       [ 1,  2, -2, ...,  2, -7,  1],
       [-4, -4, -5, ...,  4,  1,  4],
       [-7,  4, -1, ...,  0, -2, -4]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>largest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-a64ece4c-6f54-4cf8-84cd-fab831585b1c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a64ece4c-6f54-4cf8-84cd-fab831585b1c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5953d2b4-5c96-4143-a013-9ee3b29d7d30" class="xr-var-data-in" type="checkbox"><label for="data-5953d2b4-5c96-4143-a013-9ee3b29d7d30" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>lp</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-2.292e+03 ... -2.294e+03</div><input id="attrs-7640f5ab-e867-4d79-99b8-598de58df56a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-7640f5ab-e867-4d79-99b8-598de58df56a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-26309d8c-8202-4343-914b-79e534954a8e" class="xr-var-data-in" type="checkbox"><label for="data-26309d8c-8202-4343-914b-79e534954a8e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-2292.1150571 , -2292.0410545 , -2292.42477831, ...,
        -2292.30515483, -2291.80771532, -2291.87697076],
       [-2291.13076956, -2292.6492259 , -2293.30543439, ...,
        -2295.18386224, -2293.68808697, -2295.6995725 ],
       [-2291.37285478, -2293.33695976, -2291.72605722, ...,
        -2294.16204339, -2293.30043937, -2292.79231182],
       [-2292.7062563 , -2291.31543857, -2292.62358171, ...,
        -2292.17071093, -2292.615977  , -2293.70146615]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>max_energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.4801 0.4125 ... -0.3926 0.8692</div><input id="attrs-e92e7e29-6fec-43d7-b5ee-2f16951e8db3" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e92e7e29-6fec-43d7-b5ee-2f16951e8db3" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-0733bc14-a913-49bb-bd1c-7db2c56f18ee" class="xr-var-data-in" type="checkbox"><label for="data-0733bc14-a913-49bb-bd1c-7db2c56f18ee" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 0.48011874,  0.41252217,  0.33283552, ...,  0.48701634,
         1.7745814 ,  1.23766289],
       [-0.15384544,  0.2938744 ,  0.85348546, ..., -0.43798004,
        -0.25531883,  0.5353822 ],
       [-0.09070367,  0.10372755,  0.8146555 , ...,  0.57776326,
        -0.56831456,  0.16845522],
       [-0.45834808,  0.36422584,  0.29924066, ...,  1.36954587,
        -0.39259843,  0.86917849]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>n_steps</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">3.0 3.0 7.0 7.0 ... 7.0 1.0 7.0 7.0</div><input id="attrs-b0b55e87-5e4b-4fbc-b2e2-b66519713e0c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b0b55e87-5e4b-4fbc-b2e2-b66519713e0c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-36af109c-639b-4fb2-be06-8f3d50014e4a" class="xr-var-data-in" type="checkbox"><label for="data-36af109c-639b-4fb2-be06-8f3d50014e4a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 3.,  3.,  7., ...,  7.,  3.,  3.],
       [ 7.,  7.,  7., ...,  3.,  7.,  7.],
       [ 7.,  7.,  7., ...,  7.,  3., 11.],
       [15.,  7.,  7., ...,  1.,  7.,  7.]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0003078 0.0003006 ... 0.0006072</div><input id="attrs-7033dba2-39c6-466d-85f1-96ae512b85a0" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-7033dba2-39c6-466d-85f1-96ae512b85a0" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6c021a9b-1069-4276-9bfd-7725f0e50797" class="xr-var-data-in" type="checkbox"><label for="data-6c021a9b-1069-4276-9bfd-7725f0e50797" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00030781, 0.0003006 , 0.00057401, ..., 0.00082419, 0.00039798,
        0.00041605],
       [0.00060114, 0.0006144 , 0.00061627, ..., 0.00029955, 0.00056821,
        0.00055532],
       [0.00082267, 0.00064485, 0.00062062, ..., 0.00059669, 0.00029769,
        0.00084636],
       [0.0018366 , 0.00092547, 0.00090717, ..., 0.00020601, 0.00057097,
        0.00060724]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_start</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.544e+03 2.544e+03 ... 2.545e+03</div><input id="attrs-9a50876c-c181-4ce7-b9a3-661d39a84129" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9a50876c-c181-4ce7-b9a3-661d39a84129" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e2ae2a52-1547-4723-b3aa-0a61fd2aed0f" class="xr-var-data-in" type="checkbox"><label for="data-e2ae2a52-1547-4723-b3aa-0a61fd2aed0f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2544.38488424, 2544.38526362, 2544.38563142, ..., 2545.04110478,
        2545.04200902, 2545.04250536],
       [2544.2286101 , 2544.22929216, 2544.22998741, ..., 2544.93774749,
        2544.93811563, 2544.93875243],
       [2544.49499104, 2544.49596298, 2544.49668508, ..., 2545.19857197,
        2545.19923763, 2545.19960468],
       [2544.52858074, 2544.53052761, 2544.53155778, ..., 2545.2439378 ,
        2545.24422037, 2545.24486053]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>process_time_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0003078 0.0003007 ... 0.0006075</div><input id="attrs-fc9ae617-350c-47c8-a43c-4716824606c2" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-fc9ae617-350c-47c8-a43c-4716824606c2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d12cb714-be10-4f8b-ba66-ca5e43d85f5e" class="xr-var-data-in" type="checkbox"><label for="data-d12cb714-be10-4f8b-ba66-ca5e43d85f5e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00030784, 0.00030066, 0.00057414, ..., 0.00082458, 0.00039829,
        0.00041636],
       [0.00060119, 0.00061446, 0.00061642, ..., 0.00029967, 0.00056835,
        0.0005554 ],
       [0.00082305, 0.00064517, 0.00062082, ..., 0.00059686, 0.00029782,
        0.00084665],
       [0.00183679, 0.00092302, 0.00090734, ..., 0.00020617, 0.0005712 ,
        0.0006075 ]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>reached_max_treedepth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-2522f987-42ac-48f3-8ece-fea9f1b13b15" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2522f987-42ac-48f3-8ece-fea9f1b13b15" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-115247df-a74b-4010-a16d-6fff2b7294c1" class="xr-var-data-in" type="checkbox"><label for="data-115247df-a74b-4010-a16d-6fff2b7294c1" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>smallest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-aa913709-ce0d-4fb8-a99d-5d7fb972ca8e" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-aa913709-ce0d-4fb8-a99d-5d7fb972ca8e" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ce7bb4f5-3042-421b-8a74-af9b335f6752" class="xr-var-data-in" type="checkbox"><label for="data-ce7bb4f5-3042-421b-8a74-af9b335f6752" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.5204 0.5204 ... 0.5206 0.5206</div><input id="attrs-1c2c2701-549f-4fc2-869e-e62054ad43a7" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1c2c2701-549f-4fc2-869e-e62054ad43a7" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ec694522-28e1-44cd-a481-ddf763ef6801" class="xr-var-data-in" type="checkbox"><label for="data-ec694522-28e1-44cd-a481-ddf763ef6801" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.52044606, 0.52044606, 0.52044606, ..., 0.52044606, 0.52044606,
        0.52044606],
       [0.57077188, 0.57077188, 0.57077188, ..., 0.57077188, 0.57077188,
        0.57077188],
       [0.53340825, 0.53340825, 0.53340825, ..., 0.53340825, 0.53340825,
        0.53340825],
       [0.52058287, 0.52058287, 0.52058287, ..., 0.52058287, 0.52058287,
        0.52058287]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size_bar</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.5068 0.5068 ... 0.5639 0.5639</div><input id="attrs-7c02fc6c-e395-418b-b5e0-04a91831367c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-7c02fc6c-e395-418b-b5e0-04a91831367c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-bfe06511-330b-4e27-b865-47a22fb361ad" class="xr-var-data-in" type="checkbox"><label for="data-bfe06511-330b-4e27-b865-47a22fb361ad" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.50678698, 0.50678698, 0.50678698, ..., 0.50678698, 0.50678698,
        0.50678698],
       [0.54682871, 0.54682871, 0.54682871, ..., 0.54682871, 0.54682871,
        0.54682871],
       [0.52497026, 0.52497026, 0.52497026, ..., 0.52497026, 0.52497026,
        0.52497026],
       [0.56387316, 0.56387316, 0.56387316, ..., 0.56387316, 0.56387316,
        0.56387316]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>tree_depth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">2 2 3 3 3 3 2 3 ... 3 3 3 3 3 1 3 3</div><input id="attrs-0d0279c3-5a32-4ce0-b22b-d6e7efae6690" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0d0279c3-5a32-4ce0-b22b-d6e7efae6690" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-32fcfa1a-2f56-430c-b3cc-9deecd0a2807" class="xr-var-data-in" type="checkbox"><label for="data-32fcfa1a-2f56-430c-b3cc-9deecd0a2807" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2, 2, 3, ..., 3, 2, 2],
       [3, 3, 3, ..., 2, 3, 3],
       [3, 3, 3, ..., 3, 2, 4],
       [4, 3, 3, ..., 1, 3, 3]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-56e48c5d-015a-4bab-bc04-bef4cbf1c6d8" class="xr-section-summary-in" type="checkbox"><label for="section-56e48c5d-015a-4bab-bc04-bef4cbf1c6d8" class="xr-section-summary">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-632ec374-924c-4ec7-afa0-9ebf7a86f60f" class="xr-index-data-in" type="checkbox"><label for="index-632ec374-924c-4ec7-afa0-9ebf7a86f60f" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-54789c09-0b28-40eb-ba9f-b33ca581f295" class="xr-index-data-in" type="checkbox"><label for="index-54789c09-0b28-40eb-ba9f-b33ca581f295" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-b5317c60-483a-4b81-8917-a39806a7f5cd" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-b5317c60-483a-4b81-8917-a39806a7f5cd" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-07-22T17:15:59.398088+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>sampling_time :</span></dt><dd>2.4274613857269287</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_observed_data7ea67be9-ab92-4269-b482-d3f74463b1c6" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_observed_data7ea67be9-ab92-4269-b482-d3f74463b1c6" class="xr-section-summary">observed_data</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 6kB
Dimensions:       (y_pred_dim_0: 348)
Coordinates:
  * y_pred_dim_0  (y_pred_dim_0) int64 3kB 0 1 2 3 4 5 ... 343 344 345 346 347
Data variables:
    y_pred        (y_pred_dim_0) float64 3kB 16.0 3.0 115.0 ... 13.0 271.0 102.0
Attributes:
    created_at:                 2024-07-22T17:15:59.401126+00:00
    arviz_version:              0.19.0
    inference_library:          pymc
    inference_library_version:  5.15.1</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-04f988a0-44cf-4c88-9729-79d55d7c78b6" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-04f988a0-44cf-4c88-9729-79d55d7c78b6" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">y_pred_dim_0</span>: 348</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-c1168e5b-ad02-4042-a799-1d9be910f0b9" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-c1168e5b-ad02-4042-a799-1d9be910f0b9" class="xr-section-summary">Coordinates: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y_pred_dim_0</span></div><div class="xr-var-dims">(y_pred_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 343 344 345 346 347</div><input id="attrs-0a04e0b7-e924-4419-b330-f77f2f054a9c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0a04e0b7-e924-4419-b330-f77f2f054a9c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e010d673-2abe-4982-8798-035868a80617" class="xr-var-data-in" type="checkbox"><label for="data-e010d673-2abe-4982-8798-035868a80617" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 345, 346, 347])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-4a0fe074-f2ec-495b-88c2-d94f5f97bcd0" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-4a0fe074-f2ec-495b-88c2-d94f5f97bcd0" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>y_pred</span></div><div class="xr-var-dims">(y_pred_dim_0)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">16.0 3.0 115.0 ... 13.0 271.0 102.0</div><input id="attrs-a4ab6454-e00c-4275-b9a9-6b5386419771" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a4ab6454-e00c-4275-b9a9-6b5386419771" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-fdf752b9-f1d7-43be-87b8-030ed519a161" class="xr-var-data-in" type="checkbox"><label for="data-fdf752b9-f1d7-43be-87b8-030ed519a161" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([ 16.,   3., 115.,  73.,  82.,  51.,  15.,  16.,  61., 152.,  30.,
         2.,  16.,  64.,  52.,  78.,  84.,  78.,  16.,   1., 256.,  86.,
       191., 146.,   4.,  11.,  59.,  78.,  68., 164.,  54.,  18.,   1.,
       241.,  88., 173., 226., 135.,  33.,  20.,   8.,  92.,  87., 124.,
       112.,  25., 236., 103., 104.,  33.,  13.,   6.,  11., 353.,  92.,
       223., 238., 271., 520., 219., 116.,  44.,  52.,   6., 101., 517.,
       305., 170., 189., 402., 249., 256., 171.,  29.,   7.,   4.,  14.,
       486., 121., 420., 175., 258., 452., 213., 134.,  68.,  69.,   5.,
       118., 182., 117., 174., 265., 317., 530., 237., 125.,  28.,   7.,
        10., 100., 437., 163., 370., 148., 298., 292., 285., 171., 128.,
         8.,   7., 105., 186.,  93.,  32.,  43.,  72.,  69., 360., 189.,
       277., 482., 180., 148.,  52., 106.,   8., 111.,  67., 101., 214.,
       256., 470., 539., 181., 166.,  31.,   1.,   8., 285., 240., 168.,
       345., 186., 498., 204., 139.,  66.,  54.,   7.,  13., 216., 138.,
        32., 175., 314., 416., 190., 102.,  24.,   6.,   2.,  10., 400.,
       109., 244., 137., 101.,  95.,  19.,  10.,   6.,   5., 354.,  86.,
       376.,  50., 134., 206.,  72.,  17.,  11.,   2.,  89., 530., 191.,
       134., 192., 311., 181., 190.,  84.,  24.,   3.,  20.,  41., 143.,
       190.,  94., 287., 306., 126.,  72.,   4.,   2.,  12., 281., 220.,
       260., 554., 750., 586., 104.,  48.,  33.,  31., 110., 684., 238.,
       457., 224., 656., 459., 271.,  70.,  88.,   1.,  24., 315., 185.,
       229., 265., 541., 769.,  98., 270.,  74.,  21.,  14.,   8., 324.,
       301., 520., 556., 275., 227., 453., 283., 177., 116.,  12.,  40.,
        78., 250., 188., 300., 487., 900., 571., 213., 102.,  30.,  31.,
        28., 497., 414., 451., 221., 292., 241., 582., 397., 189.,  19.,
         7.,  37.,  68., 327., 260., 569., 274., 851., 491., 190., 136.,
        42.,  53.,  42., 532., 237., 459., 234., 331., 671., 596., 317.,
       229.,   5.,   6.,  17., 530., 334., 361., 594., 209., 901., 341.,
       151., 136., 146.,   4.,  41., 154., 269., 253., 313., 711.,  24.,
       357., 217., 216., 182., 605., 551., 267., 162.,  27.,   8.,   4.,
        11., 500., 163., 509., 268., 605., 352.,  96.,  64.,  26.,  38.,
        36., 350.,  90., 135.,  13., 271., 102.])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-8f4041ea-7c38-4cac-a5c2-2d9e8db787a5" class="xr-section-summary-in" type="checkbox"><label for="section-8f4041ea-7c38-4cac-a5c2-2d9e8db787a5" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>y_pred_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-fc147175-f015-4f37-81ca-5293fcccb87e" class="xr-index-data-in" type="checkbox"><label for="index-fc147175-f015-4f37-81ca-5293fcccb87e" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       338, 339, 340, 341, 342, 343, 344, 345, 346, 347],
      dtype='int64', name='y_pred_dim_0', length=348))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-c19f5ed9-4751-49b3-89f3-6db3047fbf59" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-c19f5ed9-4751-49b3-89f3-6db3047fbf59" class="xr-section-summary">Attributes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-07-22T17:15:59.401126+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
              </ul>
            </div>
            <style> /* CSS stylesheet for displaying InferenceData objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-sections.group-sections {
  grid-template-columns: auto;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
.xr-wrap{width:700px!important;} </style>
</div>
</div>
<p>En la siguiente figura la línea azul es la media del número de bicicletas alquiladas, esto es lo mismo que ya vimos en la figura anterior. Los nuevos elementos son la banda turquesa oscuro, que representa el 50% central (cuartiles 0,25 y 0,5) para las bicicletas alquiladas y la banda turquesa claro, que representa el 94% central (cuartiles 0,03 y 0,97).</p>
<p>Podemos notar que nuestro modelo predice un número negativo de bicicletas, lo cual no tiene sentido para nuestro problema, ya que no estemas modelando robo o pérdida de bicicletas. Pero detengamonos un momento a reflexionar sobre nuestro modelo. Tiene sentido, según el modelo, que tengamos valores negativos de bicicletas?</p>
<p>Si, esto debería esperarse ya que usamos una distribución Normal como likelihood en <code>modelo_bl</code>. Una <em>solución</em> muy sucia podría ser recortar las predicciones para valores inferiores a cero, pero eso es feo, feo. En la siguiente sección, veremos que podemos mejorar fácilmente este modelo para evitar predicciones sin sentido.</p>
<div id="38b136fb" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>linea_media <span class="op">=</span> idata_bl.posterior[<span class="st">'μ'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb14-2"><a href="#cb14-2"></a>idx <span class="op">=</span> np.argsort(bicis.temperatura.values)</span>
<span id="cb14-3"><a href="#cb14-3"></a>x <span class="op">=</span> np.linspace(bicis.temperatura.<span class="bu">min</span>(), bicis.temperatura.<span class="bu">max</span>(), <span class="dv">15</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>y_pred_q <span class="op">=</span> idata_bl.posterior_predictive[<span class="st">'y_pred'</span>].quantile([<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>], dim<span class="op">=</span>[<span class="st">'chain'</span>, <span class="st">'draw'</span>])</span>
<span id="cb14-5"><a href="#cb14-5"></a>y_hat_bounds <span class="op">=</span> <span class="bu">iter</span>([PchipInterpolator(bicis.temperatura.values[idx], y_pred_q[i][idx])(x) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)])</span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb14-8"><a href="#cb14-8"></a>ax.plot(bicis.temperatura, bicis.alquiladas, <span class="st">'.'</span>, color<span class="op">=</span><span class="st">"0.75"</span>,  zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb14-9"><a href="#cb14-9"></a>ax.plot(bicis.temperatura[idx], linea_media[idx], c<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb14-10"><a href="#cb14-10"></a></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="cf">for</span> lb, ub <span class="kw">in</span> <span class="bu">zip</span>(y_hat_bounds, y_hat_bounds): </span>
<span id="cb14-12"><a href="#cb14-12"></a>    ax.fill_between(x,</span>
<span id="cb14-13"><a href="#cb14-13"></a>                    lb, ub,</span>
<span id="cb14-14"><a href="#cb14-14"></a>                    color<span class="op">=</span><span class="st">"C1"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb14-15"><a href="#cb14-15"></a></span>
<span id="cb14-16"><a href="#cb14-16"></a></span>
<span id="cb14-17"><a href="#cb14-17"></a>ax.set_xlabel(<span class="st">'temperatura'</span>)</span>
<span id="cb14-18"><a href="#cb14-18"></a>ax.set_ylabel(<span class="st">'bicis alquiladas'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="generalizando-el-modelo-lineal" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="generalizando-el-modelo-lineal"><span class="header-section-number">5.3</span> Generalizando el modelo lineal</h2>
<p>El modelo lineal que hemos estado usando es un caso especial de un modelo más general, el modelo lineal generalizado (GLM, por su sigla en inglés). El GLM es una generalización del modelo lineal que nos permite utilizar diferentes distribuciones para el likelihood. De forma general (y omitiendo priors), podemos escribir un GLM como:</p>
<p><span class="math display">\[
\begin{aligned}
\mu &amp;= \alpha + \beta X \\
Y &amp;\sim \phi(f(\mu), \theta)
\end{aligned}
\]</span></p>
<p>donde <span class="math inline">\(\phi\)</span> es una distribución arbitraria algunos casos comunes son Normal, Student’s T, Gamma, NegativeBinomial, pero podemos usar otras. <span class="math inline">\(\theta\)</span> representa cualquier parámetro <em>auxiliar</em> o <em>ruido</em> que pueda tener la distribución, por ejemplo <span class="math inline">\(\sigma\)</span> para la distribución Normal. También tenemos <span class="math inline">\(f\)</span>, generalmente llamada función de enlace inverso. Cuando <span class="math inline">\(\phi\)</span> es Normal, entonces <span class="math inline">\(f\)</span> es la función identidad. Para distribuciones como Gamma y NegativeBinomial, <span class="math inline">\(f\)</span> suele ser la función exponencial. ¿Por qué necesitamos <span class="math inline">\(f\)</span>? Porque <span class="math inline">\(\mu\)</span> generalmente tomará valores en los reales, para una distribución como la Normal esto es correcto ya que la media está definida en los reales, pero esto no es necesariamente así para otras distribuciones. Por ejemplo, el parámetro <span class="math inline">\(\mu\)</span> de la Negativa Binomial se define solo para números positivos, por lo que necesitamos una transformación que nos lleve de los reales a los positivos. La función exponencial es un buen candidato para esta transformación. Vamos a explorar varios GLM, un buen ejercicio es crear una tabla y cada vez que veamos una un nuevo GLM, agregar una línea que indique qué es <span class="math inline">\(\phi\)</span>, <span class="math inline">\(\theta\)</span>, <span class="math inline">\(f\)</span> y tal vez algunas notas sobre cuándo se usa este GLM. Bien, comencemos con nuestro primer ejemplo concreto de un GLM.</p>
</section>
<section id="generalizando-el-modelo-lineal-para-datos-de-conteo" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="generalizando-el-modelo-lineal-para-datos-de-conteo"><span class="header-section-number">5.4</span> Generalizando el modelo lineal para datos de conteo</h2>
<p>¿Cómo podemos cambiar <code>modelo_bl</code> para acomodar mejor los datos de las bicicletas? Hay dos cosas a tener en cuenta, el número de bicicletas alquiladas es discreto y está acotado en cero. Esto generalmente se conoce como datos de conteo. Se les llama así porque son el resultado de contar algo. Los datos de conteo a veces se modelan usando una distribución continua como una Normal, especialmente cuando el número de conteos es grande. Pero a menudo es una buena idea usar una distribución discreta. Dos opciones comunes son la distribución de Poisson y el NegativaBinomial. La principal diferencia es que, para la distribución de Poisson, la media y la varianza son iguales y están controladas por un mismo parámetro. Asumir que la media y la varianza son idénticas puede no ser adecuado. En esos casos es común tomar como alternativa la distribución NegativaBinomial, ya que permite que la media y la varianza sean diferentes. Ante la duda es posible generar dos modelos y evaluar si una Poisson o una NegativaBinomial es más adecuada. Más adelante veremos algunos criterios para comparar modelos, por ahora vamos a usar la distribución NegativaBinomial.</p>
<p>El modelo de PyMC es muy similar al anterior, pero con dos diferencias principales. Primero, usamos <code>pm.NegativeBinomial</code> en lugar de <code>pm.Normal</code> para el likelihood. La distribución NegativaBinomial tiene dos parámetros, la media <span class="math inline">\(\mu\)</span> y un parámetro de dispersión <span class="math inline">\(\alpha\)</span>. La varianza de la NegativaBinomial es <span class="math inline">\(\mu + \frac{\mu^2}{\alpha}\)</span>. Entonces, cuanto mayor sea el valor de <span class="math inline">\(\alpha\)</span>, mayor será la varianza. La segunda diferencia es que <span class="math inline">\(\mu\)</span> es <code>pm.math.exp(α + β * bikes.temperatura)</code> en lugar de solo <code>α + β * bikes.temperatura</code>, como ya explicamos, esto es necesario para transformar los realaes a valores positivos.</p>
<div id="561fd4ca" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> modelo_neg:</span>
<span id="cb15-2"><a href="#cb15-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a>    σ <span class="op">=</span> pm.HalfCauchy(<span class="st">'σ'</span>, <span class="dv">10</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, pm.math.exp(α <span class="op">+</span> β <span class="op">*</span> bicis.temperatura))</span>
<span id="cb15-6"><a href="#cb15-6"></a>    y_pred <span class="op">=</span> pm.NegativeBinomial(<span class="st">'y_pred'</span>, mu<span class="op">=</span>μ, alpha<span class="op">=</span>σ, observed<span class="op">=</span>bicis.alquiladas)</span>
<span id="cb15-7"><a href="#cb15-7"></a>    idata_neg <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb15-8"><a href="#cb15-8"></a>    idata_neg.extend(pm.sample_posterior_predictive(idata_neg, random_seed<span class="op">=</span><span class="dv">123</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, σ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.
Sampling: [y_pred]</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"373c967bd639498faf21295260fac2f0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b7ac8bac430b48fbbf961a345d633776","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>La distribución predictiva a posteriori para <code>modelo_neg</code> se muestra en la siguiente figura. Podemos ver que ya no predecimos valores negativos y que la varianza de las predicciones aumenta con la media. Esto es de esperar ya que la varianza de la NegativaBinomial es <span class="math inline">\(\mu + \frac{\mu^2}{\alpha}\)</span>.</p>
<div id="4c01d23b" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>linea_media <span class="op">=</span> idata_neg.posterior[<span class="st">'μ'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb17-2"><a href="#cb17-2"></a>idx <span class="op">=</span> np.argsort(bicis.temperatura.values)</span>
<span id="cb17-3"><a href="#cb17-3"></a>x <span class="op">=</span> np.linspace(bicis.temperatura.<span class="bu">min</span>(), bicis.temperatura.<span class="bu">max</span>(), <span class="dv">15</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>y_pred_q <span class="op">=</span> idata_neg.posterior_predictive[<span class="st">'y_pred'</span>].quantile([<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>], dim<span class="op">=</span>[<span class="st">'chain'</span>, <span class="st">'draw'</span>])</span>
<span id="cb17-5"><a href="#cb17-5"></a>y_hat_bounds <span class="op">=</span> <span class="bu">iter</span>([PchipInterpolator(bicis.temperatura.values[idx], y_pred_q[i][idx])(x) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)])</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb17-8"><a href="#cb17-8"></a>ax.plot(bicis.temperatura, bicis.alquiladas, <span class="st">'.'</span>, color<span class="op">=</span><span class="st">"0.75"</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb17-9"><a href="#cb17-9"></a>ax.plot(bicis.temperatura[idx], linea_media[idx], c<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="cf">for</span> lb, ub <span class="kw">in</span> <span class="bu">zip</span>(y_hat_bounds, y_hat_bounds): </span>
<span id="cb17-12"><a href="#cb17-12"></a>    ax.fill_between(x,</span>
<span id="cb17-13"><a href="#cb17-13"></a>                    lb, ub,</span>
<span id="cb17-14"><a href="#cb17-14"></a>                    color<span class="op">=</span><span class="st">"C1"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb17-15"><a href="#cb17-15"></a></span>
<span id="cb17-16"><a href="#cb17-16"></a>ax.set_xlabel(<span class="st">'temperatura'</span>)</span>
<span id="cb17-17"><a href="#cb17-17"></a>ax.set_ylabel(<span class="st">'bicis alquiladas'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En la siguiente figura tenemos una prueba predictiva a posteriori para <code>modelo_bl</code> a la izquierda y <code>modelo_neg</code> a la derecha. Podemos ver que cuando se usa una Normal, la discrepancia más grande es que el modelo predice valores negativos para las bicicletas alquiladas, pero incluso para los valores positivos vemos que el el ajuste no es tan bueno. Por otro lado, el modelo con la distribución NegativaBinomial ajusta mejor los datos. Aunque el ajuste no es del todo perfecto, vemos que la cola de la distribución es más pesada para las predicciones que para las observaciones, pero también observamos que la probabilidad de esta demanda tan alta es baja. Entonces, en general, reafirmamos que el modelo NegativoBinomial es mejor que el Normal.</p>
<div id="3f1d9ba5" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a>az.plot_ppc(idata_bl,  num_pp_samples<span class="op">=</span><span class="dv">200</span>,  alpha<span class="op">=</span><span class="fl">0.1</span>, colors<span class="op">=</span>[<span class="st">"C1"</span>, <span class="st">"C0"</span>, <span class="st">"C0"</span>], ax<span class="op">=</span>ax[<span class="dv">0</span>], mean<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>az.plot_ppc(idata_neg, num_pp_samples<span class="op">=</span><span class="dv">200</span>,  alpha<span class="op">=</span><span class="fl">0.1</span>, colors<span class="op">=</span>[<span class="st">"C1"</span>, <span class="st">"C0"</span>, <span class="st">"C0"</span>], ax<span class="op">=</span>ax[<span class="dv">1</span>], mean<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a>ax[<span class="dv">0</span>].set_title(<span class="st">"Normal"</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a>ax[<span class="dv">1</span>].set_title(<span class="st">"NegativaBinomial"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regresión-robusta" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="regresión-robusta"><span class="header-section-number">5.5</span> Regresión robusta</h2>
<p>Una vez estaba ejecutando una simulación compleja de un sistema molecular. En cada paso de la simulación, necesitabamos calcular una regresión lineal como paso intermedio. Teníamos razones teóricas y empíricas para pensar que nuestra “Y” era condicionalmente normal dada nuestra “X”, por lo que la regresión lineal simple debía funcionar. Pero de vez en cuando la simulación generaba algunos valores de “Y” muy por encima o por debajo de la del grueso de los datos, esto arruinaba completamente nuestra simulación y teníamos que reiniciarla. Estos valores muy diferentes al grueso de los datos se denominan valores atípicos o aberrantes. El motivo del fracaso de nuestras simulaciones era que los valores atípicos estaban <em>tirando</em> de la línea de regresión hacia valores que daban un muy mal ajuste para el grueso de los datos y cuando pasabamos de esta estimación al siguiente paso de la simulación, todo se detenía. Resolvimos esto con la ayuda de nuestra buena amiga, la distribución T de Student, que como vimos anteriormente, tiene colas más pesadas que la distribución Normal. Esto significa que los valores atípicos tienen menos <em>influencia</em> en el resultado final, que se asemeja más al resultado que hubieramos obtenido en ausencia de los valores <em>atípicos</em>. Esto es un ejemplo de una regresión robusta.</p>
<p>Para ejemplificar la robustez que la distribución T de Student aporta a la regresión lineal, vamos a utilizar un conjunto de datos muy simple. Una versión ligeramente modificada del tercer grupo de datos del <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet">cuarteto de Anscombe</a>.</p>
<p>En el siguiente modelo, estamos usando una exponencial desplazada (le sumamos 1) para evitar valores cercanos a cero. La distribución exponencial (no desplazada) pone demasiado peso en los valores cercanos a cero. En mi experiencia, esto está bien para datos con valores atípicos “moderados”, pero en algunos conjuntos de datos pequeños como este, es mejor evitar valores tan bajos. Esta recomendación, como otras, hay que tomarlas con una pizca de sal. Los valores por defecto son buenos puntos de partida, pero no es necesario ceñirse a ellos. Otro priors comunes para Gamma(2, 0.1) o Gamma(mu = 20, sd = 15).</p>
<div id="486578c7" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>ans <span class="op">=</span> pd.read_csv(<span class="st">'datos/anscombe_3.csv'</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>ans.plot(<span class="st">"x"</span>, <span class="st">"y"</span>, kind<span class="op">=</span><span class="st">"scatter"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="9b44dd67" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> modelo_t:</span>
<span id="cb20-2"><a href="#cb20-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, mu<span class="op">=</span>ans.y.mean(), sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">'σ'</span>, <span class="dv">5</span>)</span>
<span id="cb20-5"><a href="#cb20-5"></a>    ν_ <span class="op">=</span> pm.Exponential(<span class="st">'ν_'</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">29</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a>    ν <span class="op">=</span> pm.Deterministic(<span class="st">'ν'</span>, ν_ <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, α <span class="op">+</span> β <span class="op">*</span> ans.x)</span>
<span id="cb20-8"><a href="#cb20-8"></a>    _ <span class="op">=</span> pm.StudentT(<span class="st">'y_pred'</span>, mu<span class="op">=</span>μ, sigma<span class="op">=</span>σ, nu<span class="op">=</span>ν, observed<span class="op">=</span>ans.y)</span>
<span id="cb20-9"><a href="#cb20-9"></a>    idata_t <span class="op">=</span> pm.sample(<span class="dv">2000</span>, random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, σ, ν_]
Sampling 4 chains for 1_000 tune and 2_000 draw iterations (4_000 + 8_000 draws total) took 4 seconds.
There were 1 divergences after tuning. Increase `target_accept` or reparameterize.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8330ef72a44d45edbac33228d359b535","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>En la siguiente figura podemos ver el ajuste robusto, según <code>model_t</code>, y el ajuste no robusto, según <code>linregress</code> de SciPy (esta función está haciendo una regresión por mínimos cuadrados).</p>
<p>Mientras que el ajuste no robusto trata de <em>comprometerse</em> e incluir todos los puntos, el ajuste Bayesiano robusto, <code>model_t</code>, automáticamente <em>descarta</em> (o le reduce <em>peso</em>) a un punto y ajusta una línea que pasa más cerca de todos los puntos restantes</p>
<div id="a8ac5a3a" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>beta_c, alpha_c, <span class="op">*</span>_ <span class="op">=</span> linregress(ans.x, ans.y)</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a>_, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb22-4"><a href="#cb22-4"></a>ax.plot(ans.x, (alpha_c <span class="op">+</span> beta_c <span class="op">*</span> ans.x), <span class="st">'C0:'</span>, label<span class="op">=</span><span class="st">'non-robust'</span>)</span>
<span id="cb22-5"><a href="#cb22-5"></a>ax.plot(ans.x, ans.y, <span class="st">'C0o'</span>)</span>
<span id="cb22-6"><a href="#cb22-6"></a>alpha_m <span class="op">=</span> idata_t.posterior[<span class="st">'α'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb22-7"><a href="#cb22-7"></a>beta_m <span class="op">=</span> idata_t.posterior[<span class="st">'β'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a>x_plot <span class="op">=</span> xr.DataArray(np.linspace(ans.x.<span class="bu">min</span>(), ans.x.<span class="bu">max</span>(), <span class="dv">50</span>), dims<span class="op">=</span><span class="st">"plot_id"</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a>ax.plot(x_plot, alpha_m <span class="op">+</span> beta_m <span class="op">*</span> x_plot, c<span class="op">=</span><span class="st">'C0'</span>, label<span class="op">=</span><span class="st">"robust"</span>)</span>
<span id="cb22-11"><a href="#cb22-11"></a>az.plot_hdi(ans.x, az.hdi(idata_t.posterior[<span class="st">'μ'</span>])[<span class="st">'μ'</span>].T, ax<span class="op">=</span>ax)</span>
<span id="cb22-12"><a href="#cb22-12"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb22-13"><a href="#cb22-13"></a>ax.set_ylabel(<span class="st">'y'</span>, rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb22-14"><a href="#cb22-14"></a>ax.legend(loc<span class="op">=</span><span class="dv">2</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En la siguiente figura podemos ver que obtenemos una muy buena coincidencia. También podemos ver que nuestro modelo predice valores alejados del grueso de los datos hacia ambos lados.</p>
<div id="40caafc8" class="cell" data-scrolled="true" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>pm.sample_posterior_predictive(idata_t, model<span class="op">=</span>modelo_t, random_seed<span class="op">=</span><span class="dv">2</span>, extend_inferencedata<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>ax <span class="op">=</span> az.plot_ppc(idata_t, num_pp_samples<span class="op">=</span><span class="dv">200</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>),  colors<span class="op">=</span>[<span class="st">"C1"</span>, <span class="st">"C0"</span>, <span class="st">"C1"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling: [y_pred]</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9b8710214b3c485d904e6c3a211a237e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-19-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regresión-logística" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="regresión-logística"><span class="header-section-number">5.6</span> Regresión logística</h2>
<p>La regresión logistica es la generalización del modelo de regresión simple para cuando la variable dependiente es binaria. Esta generalización se logra en dos pasos. Primero utilizamos la funcion logística como función inversa de enlace:</p>
<p><span class="math display">\[ \text{logística}(z) = \frac{1}{1 + e^{-z}} \]</span></p>
<p>Usamos esta función por que una de sus propiedades es que no importa el valor del argumento <span class="math inline">\(z\)</span>, el resultado siempre será un valor en el intervalo [0, 1]. La función logística es conocida también como función sigmoide, por su aspecto típico de <em>S</em> como se puede ver al ejecutar la siguiente celda:</p>
<div id="7270de8a" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>z <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>logística <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>z))</span>
<span id="cb25-3"><a href="#cb25-3"></a>plt.plot(z, logística)</span>
<span id="cb25-4"><a href="#cb25-4"></a>plt.xlabel(<span class="st">'z'</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a>plt.ylabel(<span class="st">'logística(z)'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>El segundo paso consiste en usar como likelihood una distribución binomial y no una Gaussiana. De esta forma el modelo queda expresado como:</p>
<p><span class="math display">\[
\begin{aligned}
\theta &amp;= \text{logística}(\alpha + \beta X) \\
Y &amp;\sim \text{Bern}(\theta)
\end{aligned}
\]</span></p>
<p>Este modelo se puede explicar de la siguiente forma. Si nuestros datos son binarios <span class="math inline">\(y \in \{0, 1\}\)</span>, como con el ejemplo de la moneda, vemos que tiene sentido usar una distribución Bernoulli. Esta distribución está parametrizada por un único parámetro en el intervalo [0, 1], el cual puede ser generado desde un modelo lineal siempre y cuando los valores generados por el modelo lineal sean <em>comprimidos</em> al intervalo [0, 1], algo que puede ser obtenido al emplear una función logística.</p>
</section>
<section id="el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris." class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris."><span class="header-section-number">5.7</span> El modelo logístico aplicado al conjunto de datos del iris.</h2>
<p>Vamos a aplicar una regresión logística al conjunto de datos Iris. Este es un conjunto de datos clásico que contiene información sobre flores de 3 especies estrechamente relacionadas: setosa, virginica y versicolor. Estas serán nuestras variables dependientes, las clases que queremos predecir. Tenemos 50 individuos de cada especie y para cada individuo el conjunto de datos contiene cuatro variables que vamos a usar como variables independientes. Estas son el largo del pétalo, el ancho del pétalo, el largo del sépalo y el ancho del sépalo. Por si se lo están preguntando, los sépalos son hojas modificadas cuya función está generalmente relacionada con la protección de las flores en la yema.</p>
<div id="646db145" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>iris <span class="op">=</span> pd.read_csv(<span class="st">'datos/iris.csv'</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>iris.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sepal_length</th>
<th data-quarto-table-cell-role="th">sepal_width</th>
<th data-quarto-table-cell-role="th">petal_length</th>
<th data-quarto-table-cell-role="th">petal_width</th>
<th data-quarto-table-cell-role="th">species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>5.1</td>
<td>3.5</td>
<td>1.4</td>
<td>0.2</td>
<td>setosa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4.9</td>
<td>3.0</td>
<td>1.4</td>
<td>0.2</td>
<td>setosa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4.7</td>
<td>3.2</td>
<td>1.3</td>
<td>0.2</td>
<td>setosa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.6</td>
<td>3.1</td>
<td>1.5</td>
<td>0.2</td>
<td>setosa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5.0</td>
<td>3.6</td>
<td>1.4</td>
<td>0.2</td>
<td>setosa</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Vamos a comenzar con la regresión logística más simple posible: dos clases, setosa y versicolor, y solo una variable independiente, la longitud del sépalo. Como se hace normalmente, vamos a codificar las variables categóricas setosa y versicolor con los números 0 y 1. Usando Pandas podemos hacer:</p>
<div id="04bbe6e6" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>df <span class="op">=</span> iris.query(<span class="st">"species == ('setosa', 'versicolor')"</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>y_0 <span class="op">=</span> pd.Categorical(df[<span class="st">'species'</span>]).codes</span>
<span id="cb27-3"><a href="#cb27-3"></a>x_n <span class="op">=</span> <span class="st">'sepal_length'</span> </span>
<span id="cb27-4"><a href="#cb27-4"></a>x_0 <span class="op">=</span> df[x_n].values</span>
<span id="cb27-5"><a href="#cb27-5"></a>x_c <span class="op">=</span> x_0 <span class="op">-</span> x_0.mean()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Al igual que con otros modelos lineales, centrar los datos puede ayudar con el muestreo. Ahora que tenemos los datos en el formato adecuado, finalmente podemos construir el modelo con PyMC.</p>
<p>Observe cómo la primera parte del siguiente modelo se asemeja a un modelo de regresión lineal. Este modelo tiene dos variables deterministas: <code>θ</code> y<code>bd</code>. <code>θ</code> es la salida de la función logística aplicada a la variable <code>μ</code> y <code>bd</code> es límite de decisión (el cual explicaremos más adelante). Otro punto que vale la pena mencionar es que en lugar de escribir explícitamente la función logística estamos usando <code>pm.math.sigmoid</code>.</p>
<div id="9f18553c" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> modelo_rl:</span>
<span id="cb28-2"><a href="#cb28-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a>    </span>
<span id="cb28-5"><a href="#cb28-5"></a>    μ <span class="op">=</span> α <span class="op">+</span> β <span class="op">*</span> x_c   </span>
<span id="cb28-6"><a href="#cb28-6"></a>    θ <span class="op">=</span> pm.Deterministic(<span class="st">'θ'</span>, pm.math.sigmoid(μ))</span>
<span id="cb28-7"><a href="#cb28-7"></a>    bd <span class="op">=</span> pm.Deterministic(<span class="st">'bd'</span>, <span class="op">-</span>α<span class="op">/</span>β)</span>
<span id="cb28-8"><a href="#cb28-8"></a>    </span>
<span id="cb28-9"><a href="#cb28-9"></a>    yl <span class="op">=</span> pm.Bernoulli(<span class="st">'yl'</span>, p<span class="op">=</span>θ, observed<span class="op">=</span>y_0)</span>
<span id="cb28-10"><a href="#cb28-10"></a></span>
<span id="cb28-11"><a href="#cb28-11"></a>    idata_rl <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3e40b26d6932411d807d80744e195feb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="99609b36" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>az.summary(idata_rl, var_names<span class="op">=</span><span class="st">'~θ'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sd</th>
<th data-quarto-table-cell-role="th">hdi_3%</th>
<th data-quarto-table-cell-role="th">hdi_97%</th>
<th data-quarto-table-cell-role="th">mcse_mean</th>
<th data-quarto-table-cell-role="th">mcse_sd</th>
<th data-quarto-table-cell-role="th">ess_bulk</th>
<th data-quarto-table-cell-role="th">ess_tail</th>
<th data-quarto-table-cell-role="th">r_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">bd</td>
<td>-0.050</td>
<td>0.059</td>
<td>-0.160</td>
<td>0.064</td>
<td>0.001</td>
<td>0.001</td>
<td>3673.0</td>
<td>2726.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">α</td>
<td>0.265</td>
<td>0.307</td>
<td>-0.294</td>
<td>0.852</td>
<td>0.005</td>
<td>0.004</td>
<td>3615.0</td>
<td>2750.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">β</td>
<td>5.187</td>
<td>1.012</td>
<td>3.462</td>
<td>7.241</td>
<td>0.018</td>
<td>0.014</td>
<td>3180.0</td>
<td>2344.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Ahora vamos a graficar los datos junto con la curva sigmoide ajustada:</p>
<div id="946d05e1" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>posterior <span class="op">=</span> idata_rl.posterior</span>
<span id="cb31-2"><a href="#cb31-2"></a>theta <span class="op">=</span> posterior[<span class="st">"θ"</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb31-3"><a href="#cb31-3"></a>idx <span class="op">=</span> np.argsort(x_c)</span>
<span id="cb31-4"><a href="#cb31-4"></a></span>
<span id="cb31-5"><a href="#cb31-5"></a>_, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb31-6"><a href="#cb31-6"></a></span>
<span id="cb31-7"><a href="#cb31-7"></a>ax.plot(x_c[idx], theta[idx], color<span class="op">=</span><span class="st">'C0'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb31-8"><a href="#cb31-8"></a>ax.vlines(posterior[<span class="st">'bd'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>)), <span class="dv">0</span>, <span class="dv">1</span>, color<span class="op">=</span><span class="st">'C1'</span>, zorder<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb31-9"><a href="#cb31-9"></a>bd_hdi <span class="op">=</span> az.hdi(posterior[<span class="st">'bd'</span>])</span>
<span id="cb31-10"><a href="#cb31-10"></a>ax.fill_betweenx([<span class="dv">0</span>, <span class="dv">1</span>], bd_hdi[<span class="st">"bd"</span>][<span class="dv">0</span>], bd_hdi[<span class="st">"bd"</span>][<span class="dv">1</span>], color<span class="op">=</span><span class="st">'C1'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, lw<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb31-11"><a href="#cb31-11"></a>ax.scatter(x_c, np.random.normal(y_0, <span class="fl">0.02</span>), marker<span class="op">=</span><span class="st">'.'</span>, color<span class="op">=</span>[<span class="ss">f'</span><span class="sc">{</span><span class="fl">0.5</span><span class="op">*</span>x<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> x <span class="kw">in</span> y_0])</span>
<span id="cb31-12"><a href="#cb31-12"></a>az.plot_hdi(x_c, posterior[<span class="st">'θ'</span>], color<span class="op">=</span><span class="st">'C0'</span>, ax<span class="op">=</span>ax, fill_kwargs<span class="op">=</span>{<span class="st">"lw"</span>: <span class="dv">0</span>})</span>
<span id="cb31-13"><a href="#cb31-13"></a>ax.set_xlabel(x_n)</span>
<span id="cb31-14"><a href="#cb31-14"></a>ax.set_ylabel(<span class="st">'θ'</span>, rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="co"># usar escala original para los xticks</span></span>
<span id="cb31-16"><a href="#cb31-16"></a>locs, _ <span class="op">=</span> plt.xticks()</span>
<span id="cb31-17"><a href="#cb31-17"></a>ax.set_xticks(locs, np.<span class="bu">round</span>(locs <span class="op">+</span> x_0.mean(), <span class="dv">1</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>La figura anterior muestra la longitud del sépalo para las especies (setosa = 0, versicolor = 1). Para mitigar la superposición de los datos, hemos agregado ruido (<em>jitter</em>) a las variable-respuesta que es binaria. Una línea azul en forma de <em>S</em> representa el valor medio de <span class="math inline">\(\theta\)</span>. Esta línea se puede interpretar como la probabilidad que una flor sea versicolor dado el valor de longitud del sépalo. La banda azul semitransparente es el HDI 94%.</p>
</section>
<section id="clasificación-con-regresión-logística" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="clasificación-con-regresión-logística"><span class="header-section-number">5.8</span> Clasificación con regresión logística</h2>
<p>Mi madre prepara un plato delicioso llamado sopa seca, que básicamente es una receta a base de tallarines y que prácticamente no tienen agua. Si bien puede parecer un nombre inapropiado, el nombre del plato cobra total sentido cuando aprendemos cómo se cocina, una parte del agua que se agrega inicialmente se pierde por evaporación y la otra es absorvida por los fideos. Algo similar sucede con la regresión logística. Es usual que este modelo se muestre como un método de clasificación (y no de regresión). Veamos la fuente de esta dualidad.</p>
<p>Los problemas de regresión consisten en predecir un valor continuo para una variable de salida dados los valores de una o más variables de entrada. Y una clasificación es un problema de asignación de valores discretos a una variable de salida dadas unas variables de entrada. Por ejemplo, asignar la clases <code>versicolor</code> dada la longitud de su sépalo.</p>
<p>Entonces, ¿la regresión logística es una regresión o un método de clasificación? La respuesta es que es un método de regresión, solo que la regresión se hace sobre la probabilidad de pertenecer a una de dos clases. Pero también es posible usar una regresión logística como clasificador. Lo único que necesitamos es una regla de decisión. Por ej asignár la clase <code>versicolor</code> si <span class="math inline">\(\theta \ge 0.5\)</span> y <code>setosa</code> en caso contrario.</p>
<p>La línea vertical en la figura anterior es el límite de decisión, y se define como el valor de la variable independiente que hace que la probabilidad de la clase 1 (versicolor en nuestro ejemplo) sea igual a 0,5. Para este modelo podemos calcular este valor analíticamente y es <span class="math inline">\(-\frac{\alpha}{\beta}\)</span>.</p>
<p>A partir de la definición del modelo tenemos la relación:</p>
<p><span class="math display">\[\theta = \text{logística}(\alpha + x \beta)\]</span></p>
<p>Y a partir de la definición de la función logística tenemos que <span class="math inline">\(\theta = 0.5\)</span>, cuando el argumento de la regresión logística es 0, es decir:</p>
<p><span class="math display">\[0.5 = \text{logística}(\alpha + x_i \beta) \Leftrightarrow 0 = \alpha + x_i \beta\]</span></p>
<p>Reordenando encontramos que el valor de <span class="math inline">\(x_i\)</span>, para el cual, <span class="math inline">\(\theta = 0.5\)</span> corresponde a la expresión:</p>
<p><span class="math display">\[x_i = - \frac{\alpha}{\beta}\]</span></p>
<p>Resumiendo los puntos más importantes hasta el momento:</p>
<ul>
<li><p>El valor de <span class="math inline">\(\theta\)</span> es, en términos generales, <span class="math inline">\(p(y= 1 \mid x)\)</span>. En este sentido, la regresión logística es en realidad una regresión, solo que estamos <em>regresionando</em> la probabilidad que una observación pertenezca a la clase 1.</p></li>
<li><p>Estamos modelando la media de una variable dicotómica, es decir, un número en el intervalo [0-1]. Luego, introducimos una regla para convertir esta probabilidad en una asignación de dos clases. En este caso, si <span class="math inline">\(p(y = 1) &gt;= 0.5\)</span> asignamos clase 1, de lo contrario clase 0.</p></li>
<li><p>No hay nada especial en el valor 0.5, aparte de que es el número en el medio entre 0 y 1. Podemos argumentar que este límite solo es razonable si estamos de acuerdo en cometer un error en una u otra dirección. En otras palabras, si es lo mismo para nosotros clasificar erróneamente una setosa como versicolor o una versicolor como setosa. Resulta que este no es siempre el caso, y el costo asociado a la clasificación errónea no tiene por qué ser simétrico.</p></li>
</ul>
</section>
<section id="interpretación-de-los-coeficientes-de-una-regresión-logística" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="interpretación-de-los-coeficientes-de-una-regresión-logística"><span class="header-section-number">5.9</span> Interpretación de los coeficientes de una regresión logística</h2>
<p>Debemos tener cuidado al interpretar los coeficientes <span class="math inline">\(\beta\)</span> de una regresión logística. La interpretación no es tan sencilla como con los modelos lineales en el capítulo anterior. La función logística introduce una no linearidad, que debemos tener en cuenta. Si <span class="math inline">\(\beta\)</span> es positivo, aumentar <span class="math inline">\(x\)</span> aumentará <span class="math inline">\(p(y = 1)\)</span> en cierta cantidad, pero la cantidad no es una función lineal de <span class="math inline">\(x\)</span>, es en cambio una función no-lineal de <span class="math inline">\(x\)</span>. Podemos visualizar este hecho en la figura anterior, en lugar de una línea con una pendiente constante, tenemos una línea en forma de S con una pendiente que cambia en función de <span class="math inline">\(x\)</span>. Un poco de álgebra nos puede dar una idea de cuánto cambia <span class="math inline">\(p(y=1)\)</span> con <span class="math inline">\(\beta\)</span>:</p>
<p>El modelo logístico básico es:</p>
<p><span class="math display">\[\theta = logistic (\alpha + X \beta) \]</span></p>
<p>El inverso de la logística es la función logit, que es:</p>
<p><span class="math display">\[ logit(z) = log \left (\frac{z}{1-z} \right)\]</span></p>
<p>Por lo tanto, si tomamos la primera ecuación en esta sección y aplicamos la función logit a ambos términos, obtenemos:</p>
<p><span class="math display">\[ logit(\theta) = \alpha + X \beta\]</span></p>
<p>O equivalente:</p>
<p><span class="math display">\[ log \left (\frac{\theta} {1-\theta} \right) = \alpha + X \beta\]</span></p>
<p>Recuerden que <span class="math inline">\(\theta\)</span> en nuestro modelo era la probabilidad de <span class="math inline">\(y = 1\)</span>, por lo tanto:</p>
<p><span class="math display">\[ log \left(\frac {p(y = 1)} {1-p (y = 1)} \right) = \alpha + X \beta \]</span></p>
<p>La cantidad <span class="math display">\[\frac{p (y = 1)} {1-p (y = 1)}\]</span> se conoce como <strong>odds</strong>. Los odds a favor se definen como la relación entre la probabilidad de éxito y la probabilidad de no éxito. Mientras que la probabilidad de obtener 2 tirando un dado es 1/6, los odds para el mismo evento son <span class="math inline">\(\frac{1/6}{5/6} = 0.2\)</span> o dicho de otra forma 1 evento favorable frente a 5 eventos desfavorables. Mientras las probabilidades toman valores en el intervalo [0, 1], los odds lo hacen en <span class="math inline">\([0, \infty)\)</span>. Veamos otro ejemplo, si la probabilidad de lluvia mañana es <span class="math inline">\(\frac{3}{4}\)</span>, entonces la probabilidad de que no llueva es <span class="math inline">\(\frac{1}{4}\)</span> y entonces el odds será de 3. Es decir es tres veces más probable que llueva respecto de que no llueva. Si en cambio la probabilidad fuese <span class="math inline">\(\frac{1}{2}\)</span> entonces el odds sería 1. Es tan probable que llueva como que no lo haga. Los odds suelen ser utilizadas por los apostadores ya que proporcionan una herramienta más intuitiva que las probabilidades <em>en bruto</em> cuando se piensa en la forma correcta de apostar.</p>
<blockquote class="blockquote">
<p>En una regresión logística, el coeficiente <span class="math inline">\(\beta\)</span> codifica el aumento en unidades de log-odds por unidad de aumento de la variable <span class="math inline">\(x\)</span>.</p>
</blockquote>
<p>La transformación de probabilidad a odds es una transformación monotónica, lo que significa que los odds aumentan a medida que aumenta la probabilidad. Mientras que las probabilidades están restringidas al intervalo <span class="math inline">\([0, 1]\)</span>, los odds viven en el intervalo <span class="math inline">\([0, \infty]\)</span>. El logaritmo es otra transformación monótonica y los log-odds están en el intervalo <span class="math inline">\([-\infty, \infty]\)</span>. La siguiente figura muestra cómo la probabilidad está relacionada con los odds y los log-odds.</p>
<div id="3b3938c8" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>probability <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>odds <span class="op">=</span> probability <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> probability)</span>
<span id="cb32-3"><a href="#cb32-3"></a></span>
<span id="cb32-4"><a href="#cb32-4"></a>_, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb32-5"><a href="#cb32-5"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb32-6"><a href="#cb32-6"></a>ax1.plot(probability, odds, <span class="st">'C0'</span>)</span>
<span id="cb32-7"><a href="#cb32-7"></a>ax2.plot(probability, np.log(odds), <span class="st">'C2'</span>)</span>
<span id="cb32-8"><a href="#cb32-8"></a></span>
<span id="cb32-9"><a href="#cb32-9"></a>ax1.set_xlabel(<span class="st">'probabilidad'</span>)</span>
<span id="cb32-10"><a href="#cb32-10"></a>ax1.set_ylabel(<span class="st">'odds'</span>, color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb32-11"><a href="#cb32-11"></a>ax2.set_ylabel(<span class="st">'log-odds'</span>, color<span class="op">=</span><span class="st">'C2'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_12140/2677285095.py:2: RuntimeWarning: divide by zero encountered in divide
  odds = probability / (1 - probability)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-26-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="varianza-variable" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="varianza-variable"><span class="header-section-number">5.10</span> Varianza variable</h2>
<p>Hemos estado usando el modelo lineal para modelar la media de una distribución, dejando la varianza de lado. En caso que consideremos que el supuesto de varianza constante no tiene sentido podemos considerar la varianza como una función (lineal) de la variable dependiente.</p>
<p>La Organización Mundial de la Salud y otras instituciones de salud de todo el mundo recopilan datos para recién nacidos y diseñan estándares de crecimiento. Estas tablas son un componente esencial del conjunto de herramientas pediátricas y también como una medida del bienestar general de las poblaciones con el fin de formular políticas de salud, planificar intervenciones y controlar su eficacia. Un ejemplo de tales datos son la longitud (alturas) de las niñas recién nacidas en función de la edad (en meses):</p>
<div id="8e0d0442" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'datos/babies.csv'</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>data.plot.scatter(<span class="st">'Meses'</span>, <span class="st">'Longitud'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Para modelar estos datos, presentaremos 3 elementos nuevos en comparación con los modelos anteriores:</p>
<ul>
<li><span class="math inline">\(\sigma\)</span> ahora es una función lineal de <span class="math inline">\(x\)</span>, y para hacer esto agregamos dos nuevos parámetros <span class="math inline">\(\gamma\)</span> y <span class="math inline">\(\delta\)</span>, estos son análogos directos de <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>.</li>
<li>El modelo lineal para la media es una función de <span class="math inline">\(\sqrt{x}\)</span>, esto es solo un truco simple para ajustar un modelo lineal a una curva.</li>
<li>Hemos definido una variable compartida <code>x_shared</code>, esto nos permitirá cambiar los valores de la variable <span class="math inline">\(x\)</span> (<code>Meses</code> en este ejemplo) sin la necesidad de volver a muestrear el modelo. Esto quedará más claro con el ejemplo.</li>
</ul>
<div id="6018e8f6" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> model_vv:</span>
<span id="cb35-2"><a href="#cb35-2"></a>    x_shared <span class="op">=</span> pm.MutableData(<span class="st">"x_shared"</span>, data.Meses.values.astype(<span class="bu">float</span>))</span>
<span id="cb35-3"><a href="#cb35-3"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a>    γ <span class="op">=</span> pm.HalfNormal(<span class="st">'γ'</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb35-6"><a href="#cb35-6"></a>    δ <span class="op">=</span> pm.HalfNormal(<span class="st">'δ'</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, α <span class="op">+</span> β <span class="op">*</span> x_shared<span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb35-9"><a href="#cb35-9"></a>    σ <span class="op">=</span> pm.Deterministic(<span class="st">'σ'</span>, γ <span class="op">+</span> δ <span class="op">*</span> x_shared)</span>
<span id="cb35-10"><a href="#cb35-10"></a>    </span>
<span id="cb35-11"><a href="#cb35-11"></a>    y_pred <span class="op">=</span> pm.Normal(<span class="st">'y_pred'</span>, mu<span class="op">=</span>μ, sigma<span class="op">=</span>σ, observed<span class="op">=</span>data.Longitud)</span>
<span id="cb35-12"><a href="#cb35-12"></a>    </span>
<span id="cb35-13"><a href="#cb35-13"></a>    idata_vv <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, γ, δ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 5 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1e46f363641946e28ed0efff504e8020","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>La siguiente figura muestra el resultado de nuestro modelo. La media de <span class="math inline">\(\mu\)</span> es representada con una curva negra, y las dos bandas turquesa semitransparentes representan 1 y 2 desviaciones estándar.</p>
<div id="0e0bbb2c" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>axes[<span class="dv">0</span>].plot(data.Meses, data.Longitud, <span class="st">'C0.'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb37-4"><a href="#cb37-4"></a></span>
<span id="cb37-5"><a href="#cb37-5"></a>posterior <span class="op">=</span> az.extract(idata_vv)</span>
<span id="cb37-6"><a href="#cb37-6"></a></span>
<span id="cb37-7"><a href="#cb37-7"></a>μ_m <span class="op">=</span> posterior[<span class="st">'μ'</span>].mean(<span class="st">"sample"</span>).values</span>
<span id="cb37-8"><a href="#cb37-8"></a>σ_m <span class="op">=</span> posterior[<span class="st">'σ'</span>].mean(<span class="st">"sample"</span>).values</span>
<span id="cb37-9"><a href="#cb37-9"></a></span>
<span id="cb37-10"><a href="#cb37-10"></a>axes[<span class="dv">0</span>].plot(data.Meses, μ_m, c<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb37-11"><a href="#cb37-11"></a>axes[<span class="dv">0</span>].fill_between(data.Meses, μ_m <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> σ_m, μ_m <span class="op">-</span> <span class="dv">1</span> <span class="op">*</span> σ_m, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'C1'</span>)</span>
<span id="cb37-12"><a href="#cb37-12"></a>axes[<span class="dv">0</span>].fill_between(data.Meses, μ_m <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> σ_m, μ_m <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> σ_m, alpha<span class="op">=</span><span class="fl">0.4</span>, color<span class="op">=</span><span class="st">'C1'</span>)</span>
<span id="cb37-13"><a href="#cb37-13"></a></span>
<span id="cb37-14"><a href="#cb37-14"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Meses'</span>)</span>
<span id="cb37-15"><a href="#cb37-15"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Longitud'</span>)<span class="op">;</span></span>
<span id="cb37-16"><a href="#cb37-16"></a></span>
<span id="cb37-17"><a href="#cb37-17"></a></span>
<span id="cb37-18"><a href="#cb37-18"></a>axes[<span class="dv">1</span>].plot(data.Meses, σ_m)</span>
<span id="cb37-19"><a href="#cb37-19"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Meses'</span>)<span class="op">;</span></span>
<span id="cb37-20"><a href="#cb37-20"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="vs">r'$\bar ϵ$'</span>, rotation<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ahora que tenemos ajustado el modelo podríamos querer usar el modelo para averiguar cómo se compara la longitud de una niña en particular respecto de la distribución. Una forma de responder a esta pregunta es preguntarle al modelo por la distribución de la variable <em>longitud</em> para bebas de digamos de 0.5 meses. Usando PyMC podemos hacer estas preguntas con la función <code>pm.sample_posterior_predictive</code>, ya que esto arrojará muestras de <span class="math inline">\(\tilde y\)</span> es decir los valores predichos considerando la incertidumbre de los parámetros. El único problema es que, por defecto, esta función devolverá valores de <span class="math inline">\(\tilde y\)</span> para los valores observados de <span class="math inline">\(x\)</span>, es decir los valores usando para ajustar el modelo. Pero que pasa si queremos obtener predicciones para que el modelo no vio? Como 0,5 meses que no es parte de los datos originales. La manera más fácil de obtener predicciones para valores no observados es definir una variable compartida (<code>x_shared</code> en el ejemplo) y luego actualizar el valor de la variable compartida justo antes del muestreo de la distribución predictiva <em>a posteriori</em>.</p>
<div id="9ff40d55" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="cf">with</span> model_vv:</span>
<span id="cb38-2"><a href="#cb38-2"></a>    pm.set_data({<span class="st">"x_shared"</span>: [<span class="fl">0.5</span>]})</span>
<span id="cb38-3"><a href="#cb38-3"></a>    ppc <span class="op">=</span> pm.sample_posterior_predictive(idata_vv, random_seed<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a>    y_ppc <span class="op">=</span> ppc.posterior_predictive[<span class="st">'y_pred'</span>].stack(sample<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling: [y_pred]</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5f247bb73c8f4c6c9c0a520bd2bedff8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>Ahora podemos graficar la distribución esperada de las longitudes para las bebas con 2 semanas de vida y calcular cantidades adicionales, por ejemplo, el percentil de una niña de esa longitud:</p>
<div id="1f957131" class="cell" data-scrolled="true" data-execution_count="30">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>ref <span class="op">=</span> <span class="fl">52.5</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>grid, pdf <span class="op">=</span> az.stats.density_utils._kde_linear(y_ppc.values)</span>
<span id="cb40-3"><a href="#cb40-3"></a>plt.plot(grid, pdf)</span>
<span id="cb40-4"><a href="#cb40-4"></a>percentile <span class="op">=</span> <span class="bu">int</span>((y_ppc <span class="op">&lt;=</span> ref).mean() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb40-5"><a href="#cb40-5"></a>plt.fill_between(grid[grid <span class="op">&lt;</span> ref], pdf[grid <span class="op">&lt;</span> ref], label<span class="op">=</span><span class="st">'percentil = </span><span class="sc">{:2d}</span><span class="st">'</span>.<span class="bu">format</span>(percentile))</span>
<span id="cb40-6"><a href="#cb40-6"></a>plt.xlabel(<span class="st">'longitud'</span>)</span>
<span id="cb40-7"><a href="#cb40-7"></a>plt.yticks([])</span>
<span id="cb40-8"><a href="#cb40-8"></a>plt.legend()<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regresión-por-cuantiles" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="regresión-por-cuantiles"><span class="header-section-number">5.11</span> Regresión por cuantiles</h2>
<p>En los ejemplos anteriores nos focalizamos en usar un modelo lineal para estimar la media de la variable respuesta, también vimos que es posible usar la misma idea para estimar la varianza. Además, aprendimos que usar un likelihood Normal es solo una de muchas opciones, como Binomial, Negativa Binomial, t de Student, etc.</p>
<p>En esta sección vamos a discutir un modelo lineal, cuyo objetivo no es la estimación de media o varianza, en cambio la estimación de <a href="https://es.wikipedia.org/wiki/Cuantil">cuantiles</a>. Cuando el cuantil a estimar es la mediana, la motivación suele ser la necesidad de una regresión robusta. Así como la mediana es un estimador de la media, robusto a valores extremos, una <em>regresión mediana</em> será también robusta. En ese caso la regresión por cuantiles cumpliría una función similar al modelo robusto que vimos anteriormente usando una distribución t de Student. Otras veces, la motivación está en modelar cuantiles específicos por que estos son “intrínsecamente” de interés. Esto sucede por ejemplo cuando nos interesa modelador valores en los extremos de una distribución. Por ejemplo podríamos estar interesados en modelar temperaturas altas, o eventos de lluvia intensos. A veces también se usa para explorar relaciones entre variables cuando no hay relación entre las medias de dichas variables, o cuando esta es muy débil. Una disciplina donde las regresiones por cuantiles son frecuentes es la ecología. Esto se debe posiblemente, a que la existencia de complejas interacciones entre variables, donde el efecto de una variable sobre otra es distinto para distintos rangos de la variable.</p>
<p>Para hacer regresiones por cuantiles utilizamos la distribución asimétrica de Laplace como likelihood. Esta distribución la podemos pensar como dos distribuciones exponenciales espalda-con-espalda. La distribución tiene 3 parámetros <span class="math inline">\(\mu\)</span> controla la localización, <span class="math inline">\(\sigma\)</span> la escala y <span class="math inline">\(q\)</span> la asimetría. <span class="math inline">\(q\)</span> varía entre [0, 1], cuando <span class="math inline">\(q=0.5\)</span> la distribución asimétrica de Laplace es en realidad simétrica. Este caso especial es conocido también como distribución de Laplace. Cuando hacemos regresión por cuantiles, podemos pensar a <span class="math inline">\(q\)</span> como los cuantiles que nos interesa asociar con la variable respuesta. Por ejemplo, si <span class="math inline">\(q=0.5\)</span> estamos modelando la mediana, si <span class="math inline">\(q=0.25\)</span> estamos modelando el primer cuartil, etc.</p>
<p>La siguiente figuras muestras tres distribuciones de esta familia.</p>
<div id="f580d678" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>q <span class="op">=</span> np.array([<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>])</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="cf">for</span> q_i, mu <span class="kw">in</span> <span class="bu">zip</span>(q, [<span class="dv">0</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>]):</span>
<span id="cb41-3"><a href="#cb41-3"></a>    pz.AsymmetricLaplace(mu<span class="op">=</span>mu, b<span class="op">=</span><span class="dv">1</span>, q<span class="op">=</span>q_i).plot_pdf(support<span class="op">=</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Quiere decir esto que al hacer una regresión por cuantiles estamos asumiendo que la variable respuesta se distribuye (condicionalmente) como una Asimétrica de Laplace? No necesariamente.</p>
<p>Una forma alternativa de pensar el likelihood, es como una función de error (o de diferencia) entre el ajuste lineal y los datos. Al elegir una distribución determinada estamos, indirectamente, eligiendo como penalizaremos esa diferencia y al hacer inferencia estámos encontrando la distribución de parámetros que reducen esa diferencia. Usando esta lógica podemos pensar que una gaussiana le asigna un determinado peso a valores alejados de la media y una t de Student le asigna un menor peso, y por ende terminamos teniendo un ajuste más robusto. De la misma forma una asimétrica de Laplace le asigna una determinado peso a estas diferencias de forma tal que el resultado final es ajustar cuantiles en vez de medias. Si esto les suena extraño es por que están prestando atención.</p>
<p>Para ejemplificar la regresión por cuantiles vamos a usar el dataset de las longitudes de bebés que usamos anteriormente. Vamos a ajustar 3 cuantiles al mismo tiempo, 0.05, 0.5, 0.95. Esto nos va a permitir ver como cambia la relación entre las variables a medida que nos movemos de los cuantiles bajos a los altos. Para esto vamos a “apilar” el dataset 3 veces, una para cada cuantil.</p>
<div id="7c994c35" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>y_con <span class="op">=</span> np.stack([data.Longitud.values]<span class="op">*</span> <span class="dv">3</span>).T</span>
<span id="cb42-2"><a href="#cb42-2"></a>x_con <span class="op">=</span> np.stack([data.Meses.values]<span class="op">*</span> <span class="dv">3</span>).T</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="64dd660d" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> model_q:</span>
<span id="cb43-2"><a href="#cb43-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, <span class="dv">50</span>, <span class="dv">3</span>, shape<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb43-3"><a href="#cb43-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, <span class="dv">0</span>, <span class="dv">5</span>, shape<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb43-4"><a href="#cb43-4"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">'σ'</span>, <span class="dv">5</span>)</span>
<span id="cb43-5"><a href="#cb43-5"></a></span>
<span id="cb43-6"><a href="#cb43-6"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, α <span class="op">+</span> β <span class="op">*</span> x_con<span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb43-7"><a href="#cb43-7"></a>    </span>
<span id="cb43-8"><a href="#cb43-8"></a>    y_pred <span class="op">=</span> pm.AsymmetricLaplace(<span class="st">'y_pred'</span>,  mu<span class="op">=</span>μ, b<span class="op">=</span>σ, q<span class="op">=</span>q, observed<span class="op">=</span>y_con)</span>
<span id="cb43-9"><a href="#cb43-9"></a>    </span>
<span id="cb43-10"><a href="#cb43-10"></a>    idata_q <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, σ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 11 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"47e3d5d0cd494a1b8cdfda3e69f2d8bb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="5c4cea82" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>plt.plot(data.Meses, data.Longitud, <span class="st">"."</span>, color<span class="op">=</span><span class="st">"0.5"</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="cf">for</span> idx, label <span class="kw">in</span> <span class="bu">enumerate</span>((<span class="st">"q=0.1"</span>, <span class="st">"q=0.5"</span>, <span class="st">"q=0.9"</span>)):</span>
<span id="cb45-3"><a href="#cb45-3"></a>    plt.plot(data.Meses.values, idata_q.posterior[<span class="st">"μ"</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))[:,idx],</span>
<span id="cb45-4"><a href="#cb45-4"></a>            label<span class="op">=</span>label, lw<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>    </span>
<span id="cb45-6"><a href="#cb45-6"></a>plt.legend()<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-35-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Para que sea más claro que estámos haciendo al hacer una regresión por cuantiles, comparemos el resultado con una regresión “normal”.</p>
<div id="beef3030" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> model_n:</span>
<span id="cb46-2"><a href="#cb46-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, <span class="dv">50</span>, <span class="dv">3</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb46-4"><a href="#cb46-4"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">'σ'</span>, <span class="dv">5</span>)</span>
<span id="cb46-5"><a href="#cb46-5"></a></span>
<span id="cb46-6"><a href="#cb46-6"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, α <span class="op">+</span> β <span class="op">*</span> data.Meses.values<span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb46-7"><a href="#cb46-7"></a>    </span>
<span id="cb46-8"><a href="#cb46-8"></a>    y_pred <span class="op">=</span> pm.Normal(<span class="st">'y_pred'</span>,  μ, σ, observed<span class="op">=</span>data.Longitud.values)</span>
<span id="cb46-9"><a href="#cb46-9"></a>    </span>
<span id="cb46-10"><a href="#cb46-10"></a>    idata_n <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, σ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 4 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d609b9ee430c40708e64e7cd6aafa806","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="c1cf290d" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb48-2"><a href="#cb48-2"></a></span>
<span id="cb48-3"><a href="#cb48-3"></a>ax.plot(data.Meses, data.Longitud, <span class="st">"."</span>, color<span class="op">=</span><span class="st">"0.8"</span>)</span>
<span id="cb48-4"><a href="#cb48-4"></a>lines <span class="op">=</span> []</span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="cf">for</span> idx, label <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="ss">f"</span><span class="sc">{</span>q_i<span class="op">=</span><span class="sc">:}</span><span class="ss">"</span> <span class="cf">for</span> q_i <span class="kw">in</span> q]):</span>
<span id="cb48-6"><a href="#cb48-6"></a>    line, <span class="op">=</span> ax.plot(data.Meses,</span>
<span id="cb48-7"><a href="#cb48-7"></a>                   idata_q.posterior[<span class="st">"μ"</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))[:,idx],</span>
<span id="cb48-8"><a href="#cb48-8"></a>                   label<span class="op">=</span>label)</span>
<span id="cb48-9"><a href="#cb48-9"></a>    lines.append(line)</span>
<span id="cb48-10"><a href="#cb48-10"></a>    </span>
<span id="cb48-11"><a href="#cb48-11"></a>q_legend <span class="op">=</span> ax.legend(handles<span class="op">=</span>lines, loc<span class="op">=</span><span class="st">'upper left'</span>, title<span class="op">=</span><span class="st">"Regresión por cuantiles"</span>)</span>
<span id="cb48-12"><a href="#cb48-12"></a></span>
<span id="cb48-13"><a href="#cb48-13"></a><span class="co"># aproximamos los cuantiles de la distribución posterior</span></span>
<span id="cb48-14"><a href="#cb48-14"></a>q_95 <span class="op">=</span> (idata_n.posterior[<span class="st">"μ"</span>] <span class="op">+</span> idata_n.posterior[<span class="st">"σ"</span>]<span class="op">*</span><span class="fl">1.65</span>).mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb48-15"><a href="#cb48-15"></a>q_05 <span class="op">=</span> (idata_n.posterior[<span class="st">"μ"</span>] <span class="op">-</span> idata_n.posterior[<span class="st">"σ"</span>]<span class="op">*</span><span class="fl">1.65</span>).mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb48-16"><a href="#cb48-16"></a></span>
<span id="cb48-17"><a href="#cb48-17"></a>line0, <span class="op">=</span> ax.plot(data.Meses, q_05, <span class="st">"C0"</span>, label<span class="op">=</span><span class="st">"μ - 1.65σ"</span>, ls<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb48-18"><a href="#cb48-18"></a>line1, <span class="op">=</span> ax.plot(data.Meses, idata_n.posterior[<span class="st">"μ"</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>)), <span class="st">"C1"</span>, label<span class="op">=</span><span class="st">"μ"</span>, ls<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb48-19"><a href="#cb48-19"></a>line2, <span class="op">=</span> ax.plot(data.Meses, q_95, <span class="st">"C2"</span>, label<span class="op">=</span><span class="st">"μ + 1.65σ"</span>, ls<span class="op">=</span><span class="st">"--"</span>)<span class="op">;</span></span>
<span id="cb48-20"><a href="#cb48-20"></a></span>
<span id="cb48-21"><a href="#cb48-21"></a>ax.add_artist(q_legend)</span>
<span id="cb48-22"><a href="#cb48-22"></a></span>
<span id="cb48-23"><a href="#cb48-23"></a>ax.legend(handles<span class="op">=</span>[line0, line1, line2], loc<span class="op">=</span><span class="st">'lower right'</span>, title<span class="op">=</span><span class="st">"Regresión normal"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Podemos ver que al usar una distribución Normal y a partir de ella computar los cuantiles, q=0.1 (<span class="math inline">\(\mu - 1.65\sigma\)</span>) y q=0.9 (<span class="math inline">\(\mu + 1.65\sigma\)</span>) estos son simétricos respecto de la media <span class="math inline">\(\mu\)</span>. Además podemos ver que la forma de la curva es esencialmente la misma para los 3 casos, solo que desplazada hacia arriba o abajo. Además las curvas generadas al usar la distribución asimétrica de Laplace permite acomodarse a la varianza no constante, vean como las curvas empiezan muy cerca en el mes cero y se van separando a medida que pasan los meses.</p>
</section>
<section id="regresión-lineal-jerárquica" class="level2" data-number="5.12">
<h2 data-number="5.12" class="anchored" data-anchor-id="regresión-lineal-jerárquica"><span class="header-section-number">5.12</span> Regresión lineal jerárquica</h2>
<p>Hace dos capítulos, aprendimos los rudimentos de los modelos jerárquicos. Este mismo concepto se puede aplicar a las regresiones lineales. Esto permite que los modelos realicen inferencias a nivel de subgrupo y a nivel global. Como ya vimos, esto se hace incluyendo hiperpriors.</p>
<p>Vamos a crear ocho grupos de datos relacionados, incluido un grupo con un solo dato</p>
<div id="962a5eda" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>N <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>grupos <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"H"</span>]</span>
<span id="cb49-3"><a href="#cb49-3"></a>M <span class="op">=</span> <span class="bu">len</span>(grupos)</span>
<span id="cb49-4"><a href="#cb49-4"></a>idx <span class="op">=</span> np.repeat(<span class="bu">range</span>(M <span class="op">-</span> <span class="dv">1</span>), N)</span>
<span id="cb49-5"><a href="#cb49-5"></a>idx <span class="op">=</span> np.append(idx, <span class="dv">7</span>)</span>
<span id="cb49-6"><a href="#cb49-6"></a>np.random.seed(<span class="dv">314</span>)</span>
<span id="cb49-7"><a href="#cb49-7"></a>alpha_real <span class="op">=</span> np.random.normal(<span class="fl">2.5</span>, <span class="fl">0.5</span>, size<span class="op">=</span>M)</span>
<span id="cb49-8"><a href="#cb49-8"></a>beta_real <span class="op">=</span> np.random.beta(<span class="dv">6</span>, <span class="dv">1</span>, size<span class="op">=</span>M)</span>
<span id="cb49-9"><a href="#cb49-9"></a>eps_real <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.5</span>, size<span class="op">=</span><span class="bu">len</span>(idx))</span>
<span id="cb49-10"><a href="#cb49-10"></a>y_m <span class="op">=</span> np.zeros(<span class="bu">len</span>(idx))</span>
<span id="cb49-11"><a href="#cb49-11"></a>x_m <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(idx))</span>
<span id="cb49-12"><a href="#cb49-12"></a>y_m <span class="op">=</span> alpha_real[idx] <span class="op">+</span> beta_real[idx] <span class="op">*</span> x_m <span class="op">+</span> eps_real</span>
<span id="cb49-13"><a href="#cb49-13"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-14"><a href="#cb49-14"></a>ax <span class="op">=</span> np.ravel(ax)</span>
<span id="cb49-15"><a href="#cb49-15"></a>j, k <span class="op">=</span> <span class="dv">0</span>, N</span>
<span id="cb49-16"><a href="#cb49-16"></a><span class="cf">for</span> i, g <span class="kw">in</span> <span class="bu">enumerate</span>(grupos):</span>
<span id="cb49-17"><a href="#cb49-17"></a>    ax[i].scatter(x_m[j:k], y_m[j:k], marker<span class="op">=</span><span class="st">"."</span>)</span>
<span id="cb49-18"><a href="#cb49-18"></a>    ax[i].set_title(<span class="ss">f"grupo </span><span class="sc">{</span>g<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-19"><a href="#cb49-19"></a>    j <span class="op">+=</span> N</span>
<span id="cb49-20"><a href="#cb49-20"></a>    k <span class="op">+=</span> N</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-38-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Veamos un posible modelo para estos datos:</p>
<div id="38832bf4" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a>coords <span class="op">=</span> {<span class="st">"grupo"</span>: grupos}</span>
<span id="cb50-2"><a href="#cb50-2"></a></span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="cf">with</span> pm.Model(coords<span class="op">=</span>coords) <span class="im">as</span> modelo_jerárquico:</span>
<span id="cb50-4"><a href="#cb50-4"></a>    <span class="co"># hyper-priors</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>    α_μ <span class="op">=</span> pm.Normal(<span class="st">"α_μ"</span>, mu<span class="op">=</span>y_m.mean(), sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb50-6"><a href="#cb50-6"></a>    α_σ <span class="op">=</span> pm.HalfNormal(<span class="st">"α_σ"</span>, <span class="dv">5</span>)</span>
<span id="cb50-7"><a href="#cb50-7"></a>    β_μ <span class="op">=</span> pm.Normal(<span class="st">"β_μ"</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb50-8"><a href="#cb50-8"></a>    β_σ <span class="op">=</span> pm.HalfNormal(<span class="st">"β_σ"</span>, sigma<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb50-9"><a href="#cb50-9"></a></span>
<span id="cb50-10"><a href="#cb50-10"></a>    <span class="co"># priors</span></span>
<span id="cb50-11"><a href="#cb50-11"></a>    α <span class="op">=</span> pm.Normal(<span class="st">"α"</span>, mu<span class="op">=</span>α_μ, sigma<span class="op">=</span>α_σ, dims<span class="op">=</span><span class="st">"grupo"</span>)</span>
<span id="cb50-12"><a href="#cb50-12"></a>    β <span class="op">=</span> pm.Normal(<span class="st">"β"</span>, mu<span class="op">=</span>β_μ, sigma<span class="op">=</span>β_σ, dims<span class="op">=</span><span class="st">"grupo"</span>)</span>
<span id="cb50-13"><a href="#cb50-13"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">"σ"</span>, <span class="dv">5</span>)</span>
<span id="cb50-14"><a href="#cb50-14"></a>    _ <span class="op">=</span> pm.Normal(<span class="st">"y_pred"</span>, mu<span class="op">=</span>α[idx] <span class="op">+</span> β[idx] <span class="op">*</span> x_m, sigma<span class="op">=</span>σ, observed<span class="op">=</span>y_m)</span>
<span id="cb50-15"><a href="#cb50-15"></a></span>
<span id="cb50-16"><a href="#cb50-16"></a>    idata_mj <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α_μ, α_σ, β_μ, β_σ, α, β, σ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 8 seconds.
There were 172 divergences after tuning. Increase `target_accept` or reparameterize.
The effective sample size per chain is smaller than 100 for some parameters.  A higher number is needed for reliable rhat and ess computation. See https://arxiv.org/abs/1903.08008 for details</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b5587b0c35334e08a434a90f44fcf9be","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>Vemos que obtenemos un mesaje de advertencia indicando divergencias y dos sugerencias para solucionar el problema. La primera es incrementar <code>target_accept</code> la segunda reparametrizar. Este mensaje indica que las muestras generadas por PyMC pueden no ser confiables, esto se vincula a los diagnósticos que vimos en el capítulo anterior.</p>
<p>La primer sugerencias es aumentar <code>target_accept</code>, que es un argumento de <code>pm.sample()</code> que por defecto toma el valor 0.8 y puede tomar valores en el intervalo (0, 1). Si ves divergencias, como en este caso, cambiar el valor por defecto a valores tales como 0.85, 0.9 o incluso más puede ayudar. En algunos casos incluso valores altos como 0.99 no serán de ayuda. Un efecto adverso de aumentar <code>target_accept</code> es que el sampler suele demorar más en generar una misma cantidad de muestras.</p>
<p>Si las divergencias no desaparecen al cambiar <code>target_accept</code>, en general la única solución es reparametrizar. ¿Qué es esto? Reparametrizar es escribir un modelo de una manera diferente, pero matemáticamente equivalente a su versión original. Muchos modelos (por no decir todos) se pueden escribir de formas alternativas. A veces, la reparametrización puede tener un efecto positivo en la eficiencia del método de muestreo o en la interpretabilidad del modelo. Por ejemplo, al reparametrizar podemos eliminar las divergencias.</p>
<p>Si prueban volver a correr <code>modelo_jerárquico</code> pero con valores más altos de <code>target_accept</code> verán que las divergecias disminuyen pero no desaparecen. Lamentablemente esto es algo común con modelos lineales jerárquicos, lo bueno es que existe una reparametrización que suele solucionar el problema. La reparametrización consiste en reescribir el modelo de la siguiente forma:</p>
<p>En vez definir <span class="math inline">\(\beta \sim \mathcal{N}(\beta_\mu, \beta_\sigma)\)</span> como en <code>modelo_jerárquico</code> vamos a escribir <span class="math inline">\(\beta = \beta_\mu + \beta_\text{offset} * \beta_\sigma\)</span>. Donde <span class="math inline">\(\beta_\text{offset}\)</span> es una distribución normal con media 0 y desviación estándar 1. Conceptualmente la diferencia es que en el primer caso estamos modelando la pendiente de cada grupo de forma explícita, mientras que en el segundo caso lo estamos haciendo como una desviación respecto de un valor común (<span class="math inline">\(\beta_\mu\)</span>). A la primer versión se la suele llamar centrada y a la segunda no-centrada. Veamos como queda el modelo no-centrado en PyMC:</p>
<div id="eb586cb9" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a><span class="cf">with</span> pm.Model(coords<span class="op">=</span>coords) <span class="im">as</span> jerárquico_no_centrado:</span>
<span id="cb52-2"><a href="#cb52-2"></a>    <span class="co"># hyper-priors</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>    α_μ <span class="op">=</span> pm.Normal(<span class="st">"α_μ"</span>, mu<span class="op">=</span>y_m.mean(), sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb52-4"><a href="#cb52-4"></a>    α_σ <span class="op">=</span> pm.HalfNormal(<span class="st">"α_σ"</span>, <span class="dv">5</span>)</span>
<span id="cb52-5"><a href="#cb52-5"></a>    β_μ <span class="op">=</span> pm.Normal(<span class="st">"β_μ"</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb52-6"><a href="#cb52-6"></a>    β_σ <span class="op">=</span> pm.HalfNormal(<span class="st">"β_σ"</span>, sigma<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb52-7"><a href="#cb52-7"></a></span>
<span id="cb52-8"><a href="#cb52-8"></a>    <span class="co"># priors</span></span>
<span id="cb52-9"><a href="#cb52-9"></a>    α <span class="op">=</span> pm.Normal(<span class="st">"α"</span>, mu<span class="op">=</span>α_μ, sigma<span class="op">=</span>α_σ, dims<span class="op">=</span><span class="st">"grupo"</span>)</span>
<span id="cb52-10"><a href="#cb52-10"></a></span>
<span id="cb52-11"><a href="#cb52-11"></a>    β_offset <span class="op">=</span> pm.Normal(<span class="st">"β_offset"</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>, dims<span class="op">=</span><span class="st">"grupo"</span>)</span>
<span id="cb52-12"><a href="#cb52-12"></a>    β <span class="op">=</span> pm.Deterministic(<span class="st">"β"</span>, β_μ <span class="op">+</span> β_offset <span class="op">*</span> β_σ, dims<span class="op">=</span><span class="st">"grupo"</span>)</span>
<span id="cb52-13"><a href="#cb52-13"></a></span>
<span id="cb52-14"><a href="#cb52-14"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">"σ"</span>, <span class="dv">5</span>)</span>
<span id="cb52-15"><a href="#cb52-15"></a>    _ <span class="op">=</span> pm.Normal(<span class="st">"y_pred"</span>, mu<span class="op">=</span>α[idx] <span class="op">+</span> β[idx] <span class="op">*</span> x_m, sigma<span class="op">=</span>σ, observed<span class="op">=</span>y_m)</span>
<span id="cb52-16"><a href="#cb52-16"></a></span>
<span id="cb52-17"><a href="#cb52-17"></a>    idata_ncen <span class="op">=</span> pm.sample(target_accept<span class="op">=</span><span class="fl">0.85</span>, random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α_μ, α_σ, β_μ, β_σ, α, β_offset, σ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 10 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8ce4fcb7531d44dfbcb7d6a1742cc178","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>Al correr <code>jerárquico_no_centrado</code> sin modificar <code>target_accept</code> verán todavía quedan unas pocas divergencias. 2 en mi caso, un número tan bajo no suele ser problemático. Pero para estar seguros podemos aumentar <code>target_accept</code> a 0.85, como en el bloque de código anterior. Al hacer eso veremos que no hay divergencias y podremos seguir con nuestro análisis. Pero antes de hacer eso veamos que es lo que estamos haciendo al reparametrizar.</p>
<p>La siguiente figura muestra muestra dos paneles, a la izquierda tenemos un gráfico de dispersión entre los valores de <span class="math inline">\(\log \beta_\sigma\)</span> (el logaritmo de la desviación estándar global) y <span class="math inline">\(\beta_B\)</span>. A la derecha entre <span class="math inline">\(\log \beta_\sigma\)</span> y la pendiente del grupo H. Los puntos negros representan divergencias. En ambos casos se observa una forma de “embudo” más ancha arriba y más angosta abajo (esto es más acentuado en el panel de la derecha). En ambos casos a medida que <span class="math inline">\(\beta_\sigma\)</span> aumenta el embudo se ensancha, ya que la dispersión de <span class="math inline">\(\beta\)</span> aumenta. Esto es razonable ya que precisamente <span class="math inline">\(\beta_\sigma\)</span> controla cuan variable puede ser <span class="math inline">\(\beta\)</span> respecto de su media. En si mismo esto no es un problema, es simplemente una consecuencia directa del modelo. Pero si es un problema para el método de muestreo, como vimos en el capítulo anterior, para obtener un método eficiente el método de muestreo debe “aprender” ciertos hiper-parámetros. El problema que en una geometría como el embudo, no hay un solo conjunto de hiper-parámetros que sean lo suficientemente buenos para muestrear tanto la boca del embudo como su pico. En general el método “aprende” a muestrear la parate ancha y cuando se aproxima a la parte angosta la trayectoria “diverge” de la correcta. Es como si usáramos los cálculos para poner un satélite en orbita de la tierra, para ponerlo en órbita de la luna, perderíamos el satélite en el espacio.</p>
<p>Nota: Para la figura usamos <span class="math inline">\(\log \beta_\sigma\)</span> en vez de <span class="math inline">\(\beta_\sigma\)</span>, por que esto es lo que “ve” el sampler. Por qué? Por que internamente PyMC muestrea los parámetros en un espacio sin “bordes” para eso convierte distribuciones como la Beta que tienen soporte en el intervalo (0, 1) a una distribución que tiene soporte en todo el espacio real. Lo mismo hace con distribuciones como la media-normal. En el caso de esta última la transformación es logarítmica. Una vez terminado el muestreo PyMC invierte la trasformación quedando los parámetros en la escala original y por eso nosotros vemos los valores de <span class="math inline">\(\beta_\sigma\)</span> y no <span class="math inline">\(\log \beta_\sigma\)</span>. Pero el sampler ve <span class="math inline">\(\log \beta_\sigma\)</span> por eso es conveniente graficar en esa escala.</p>
<div id="f5b4a642" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>idata_mj.posterior[<span class="st">"log(β_σ)"</span>] <span class="op">=</span> np.log(idata_mj.posterior[<span class="st">"β_σ"</span>])</span>
<span id="cb54-2"><a href="#cb54-2"></a></span>
<span id="cb54-3"><a href="#cb54-3"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="st">"row"</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb54-4"><a href="#cb54-4"></a></span>
<span id="cb54-5"><a href="#cb54-5"></a>nvars <span class="op">=</span> [<span class="st">"log(β_σ)"</span>, <span class="st">"log(β_σ)"</span>]</span>
<span id="cb54-6"><a href="#cb54-6"></a>glabel <span class="op">=</span> [<span class="st">"B"</span>, <span class="st">"H"</span>]</span>
<span id="cb54-7"><a href="#cb54-7"></a><span class="cf">for</span> ax, var, gl <span class="kw">in</span> <span class="bu">zip</span>(axes.ravel(), nvars, glabel):</span>
<span id="cb54-8"><a href="#cb54-8"></a>    az.plot_pair(</span>
<span id="cb54-9"><a href="#cb54-9"></a>        idata_mj,</span>
<span id="cb54-10"><a href="#cb54-10"></a>        var_names<span class="op">=</span>[<span class="st">"β"</span>, var],</span>
<span id="cb54-11"><a href="#cb54-11"></a>        coords<span class="op">=</span>{<span class="st">"grupo"</span>: [gl]},</span>
<span id="cb54-12"><a href="#cb54-12"></a>        divergences<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb54-13"><a href="#cb54-13"></a>        scatter_kwargs<span class="op">=</span>{<span class="st">"color"</span>: <span class="st">"C2"</span>},</span>
<span id="cb54-14"><a href="#cb54-14"></a>        divergences_kwargs<span class="op">=</span>{<span class="st">"color"</span>: <span class="st">"k"</span>, <span class="st">"marker"</span>: <span class="st">"."</span>, <span class="st">"mec"</span>: <span class="va">None</span>},</span>
<span id="cb54-15"><a href="#cb54-15"></a>        ax<span class="op">=</span>ax,</span>
<span id="cb54-16"><a href="#cb54-16"></a>    )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ahora bien, que pasa cuando usamos un modelo jerárquico no centrado? Veamos la siguiente figura:</p>
<p>Ahora tenemos 4 paneles, en la primer fila vemos <span class="math inline">\(\log \beta_\sigma\)</span> vs <span class="math inline">\(\log \beta_{offset}\)</span>, que es la nueva variable que introdujimos en la versión no centrada. Ahora vemos que el posterior es más “esférico” o al menos que la forma de embudo es mucho menos pronunciada. Esta geométrica es mucho más simple de muestrear que la anterior y por eso no observamos divergencias.</p>
<p>En la segunda fila vemos <span class="math inline">\(\log \beta_\sigma\)</span> vs <span class="math inline">\(\beta\)</span>, ahora vemos que el embudo es aún más acentuado que en la figura anterior. Esto no debería ser aún más problemático? En realidad no, esto no es un problema para el sampler por que el sampler nunca “ve” este embudo ya que <span class="math inline">\(\beta\)</span> lo obtenemos al combinar <span class="math inline">\(\beta_\text{offset}\)</span>, <span class="math inline">\(\beta_\sigma\)</span> y <span class="math inline">\(\beta_\mu\)</span>. Es decir con la reparametrización logramos obtener un embudo más “profundo”, pero sin muestrearlo directamente!</p>
<p>Ahora que quiere decir que ahora el embudo sea “más profundo”? Quiere decir que ahora somos capaces de muestrear una región de la distribución a posteriori que antes no podíamos. En la versión centrada del modelo el sampler divergía antes de poder encontrar la zona angosta y por lo tanto esa zona NO estaba presente en la distribución a posteriori. Nos estábamos perdiendo parte de la distribución a posteriori, que si no fuera por las divergencias no sabríamos que existe y estaríamos trabajando con una distribución a posteriori sesgada sin siquiera saberlo.</p>
<div id="64eb0564" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>idata_ncen.posterior[<span class="st">"log(β_σ)"</span>] <span class="op">=</span> np.log(idata_ncen.posterior[<span class="st">"β_σ"</span>])</span>
<span id="cb55-2"><a href="#cb55-2"></a></span>
<span id="cb55-3"><a href="#cb55-3"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="st">"row"</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb55-4"><a href="#cb55-4"></a></span>
<span id="cb55-5"><a href="#cb55-5"></a>nvars <span class="op">=</span> np.repeat([<span class="st">"β_offset"</span>, <span class="st">"β"</span>], <span class="dv">2</span>)</span>
<span id="cb55-6"><a href="#cb55-6"></a>glabel <span class="op">=</span> [<span class="st">"B"</span>, <span class="st">"H"</span>] <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb55-7"><a href="#cb55-7"></a></span>
<span id="cb55-8"><a href="#cb55-8"></a><span class="cf">for</span> ax, var, gl <span class="kw">in</span> <span class="bu">zip</span>(axes.ravel(), nvars, glabel):</span>
<span id="cb55-9"><a href="#cb55-9"></a>    az.plot_pair(</span>
<span id="cb55-10"><a href="#cb55-10"></a>        idata_ncen,</span>
<span id="cb55-11"><a href="#cb55-11"></a>        var_names<span class="op">=</span>[var, <span class="st">"log(β_σ)"</span>],</span>
<span id="cb55-12"><a href="#cb55-12"></a>        coords<span class="op">=</span>{<span class="st">"grupo"</span>: [gl]},</span>
<span id="cb55-13"><a href="#cb55-13"></a>        divergences<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb55-14"><a href="#cb55-14"></a>        scatter_kwargs<span class="op">=</span>{<span class="st">"color"</span>: <span class="st">"C2"</span>},</span>
<span id="cb55-15"><a href="#cb55-15"></a>        divergences_kwargs<span class="op">=</span>{<span class="st">"color"</span>: <span class="st">"k"</span>, <span class="st">"marker"</span>: <span class="st">"."</span>, <span class="st">"mec"</span>: <span class="va">None</span>},</span>
<span id="cb55-16"><a href="#cb55-16"></a>        ax<span class="op">=</span>ax,</span>
<span id="cb55-17"><a href="#cb55-17"></a>    )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ahora que nuestras muestras están libres de divergencias, podemos continuar con el análisis de los resultados. La siguiente figura muestra los valores estimados para <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>. Podemos ver como las estimaciones para el grupo H son las de mayor incertidumbre. Lo cual es razonable dado que tenemos un solo punto.</p>
<div id="ade827a7" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>az.plot_forest(idata_ncen, var_names<span class="op">=</span>[<span class="st">'α'</span>, <span class="st">'β'</span>], figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>), combined<span class="op">=</span><span class="va">True</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-43-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>La siguiente figura muestra las líneas ajustadas para cada uno de los ocho grupos. Podemos ver que logramos ajustar una línea a un solo punto. Al principio, esto puede sonar extraño o incluso sospechoso, pero es solo una consecuencia de la estructura del modelo jerárquico. Cada línea está informada por las líneas de los otros grupos, por lo que no estamos realmente ajustando una línea a un solo punto. En cambio, estamos ajustando una línea que ha sido informada por los puntos en los otros grupos a un solo punto.</p>
<div id="f2cc3eb6" class="cell" data-scrolled="true" data-execution_count="43">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a>ax <span class="op">=</span> np.ravel(ax)</span>
<span id="cb57-3"><a href="#cb57-3"></a>j, k <span class="op">=</span> <span class="dv">0</span>, N</span>
<span id="cb57-4"><a href="#cb57-4"></a>x_range <span class="op">=</span> np.linspace(x_m.<span class="bu">min</span>(), x_m.<span class="bu">max</span>(), <span class="dv">10</span>)</span>
<span id="cb57-5"><a href="#cb57-5"></a>posterior <span class="op">=</span> az.extract(idata_ncen)</span>
<span id="cb57-6"><a href="#cb57-6"></a></span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="cf">for</span> i, g <span class="kw">in</span> <span class="bu">enumerate</span>(grupos):</span>
<span id="cb57-8"><a href="#cb57-8"></a>    ax[i].scatter(x_m[j:k], y_m[j:k], marker<span class="op">=</span><span class="st">"."</span>)</span>
<span id="cb57-9"><a href="#cb57-9"></a>    ax[i].set_xlabel(<span class="st">"$x_</span><span class="sc">{}</span><span class="st">$"</span>.<span class="bu">format</span>(i))</span>
<span id="cb57-10"><a href="#cb57-10"></a>    ax[i].set_ylabel(<span class="st">"$y_</span><span class="sc">{}</span><span class="st">$"</span>.<span class="bu">format</span>(i), labelpad<span class="op">=</span><span class="dv">10</span>, rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb57-11"><a href="#cb57-11"></a>    alfas <span class="op">=</span> posterior[<span class="st">"α"</span>].sel(grupo<span class="op">=</span>g)</span>
<span id="cb57-12"><a href="#cb57-12"></a>    betas <span class="op">=</span> posterior[<span class="st">"β"</span>].sel(grupo<span class="op">=</span>g)</span>
<span id="cb57-13"><a href="#cb57-13"></a>    alfa_m <span class="op">=</span> alfas.mean(<span class="st">"sample"</span>).item()</span>
<span id="cb57-14"><a href="#cb57-14"></a>    beta_m <span class="op">=</span> betas.mean(<span class="st">"sample"</span>).item()</span>
<span id="cb57-15"><a href="#cb57-15"></a>    ax[i].plot(x_range, alfa_m <span class="op">+</span> beta_m <span class="op">*</span> x_range, c<span class="op">=</span><span class="st">"k"</span>)</span>
<span id="cb57-16"><a href="#cb57-16"></a>    az.plot_hdi(x_range, alfas <span class="op">+</span> betas <span class="op">*</span> xr.DataArray(x_range).transpose(), ax<span class="op">=</span>ax[i])</span>
<span id="cb57-17"><a href="#cb57-17"></a>    plt.xlim(x_m.<span class="bu">min</span>() <span class="op">-</span> <span class="dv">1</span>, x_m.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb57-18"><a href="#cb57-18"></a>    plt.ylim(y_m.<span class="bu">min</span>() <span class="op">-</span> <span class="dv">1</span>, y_m.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb57-19"><a href="#cb57-19"></a>    j <span class="op">+=</span> N</span>
<span id="cb57-20"><a href="#cb57-20"></a>    k <span class="op">+=</span> N</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-44-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regresión-lineal-múltiple" class="level2" data-number="5.13">
<h2 data-number="5.13" class="anchored" data-anchor-id="regresión-lineal-múltiple"><span class="header-section-number">5.13</span> Regresión lineal múltiple</h2>
<p>Hasta ahora, hemos estado trabajando con una variable dependiente y una variable independiente. Sin embargo, no es inusual tener varias variables independientes que queremos incluir en nuestro modelo. Algunos ejemplos podrían ser:</p>
<ul>
<li>Calidad percibida del vino (dependiente) y acidez, densidad, grado alcohólico, azúcar residual y contenido de sulfatos (variables independientes)</li>
<li>Calificaciones promedio de un estudiante (dependiente) e ingreso familiar, distancia del hogar a la escuela y nivel de educación de la madre (variable categórica)</li>
</ul>
<p>Podemos extender fácilmente el modelo de regresión lineal simple para tratar con más de una variable independiente. Llamamos a este modelo regresión lineal múltiple o menos a menudo modelo de regresión lineal multivariable (que no debe confundirse con la regresión lineal multivariable, el caso en el que tenemos múltiples variables dependientes).</p>
<p>En un modelo de regresión lineal múltiple, modelamos la media de la variable dependiente de la siguiente manera:</p>
<p><span class="math display">\[
\mu = \alpha + \beta_1 X_{1} + \beta_2 X_{2} + \dots + \beta_k X_{k}
\]</span></p>
<p>Usando notación de álgebra lineal, podemos escribir una versión más corta:</p>
<p><span class="math display">\[
\mu = \alpha + \mathbf{X} \beta
\]</span></p>
<p>donde <span class="math inline">\(\mathbf{X}\)</span> es una matriz de tamaño <span class="math inline">\(n \times k\)</span> con los valores de las variables independientes y <span class="math inline">\(\beta\)</span> es un vector de tamaño <span class="math inline">\(k\)</span> con los coeficientes de las variables independientes, y $n $ es el número de observaciones.</p>
<p>Si estás un poco oxidado con respecto al álgebra lineal, podés consultar el artículo de Wikipedia sobre el producto escalar entre dos vectores y su generalización a la multiplicación de matrices. Pero básicamente, lo que necesitás saber es que solo estamos usando una forma más corta y conveniente de escribir nuestro modelo:</p>
<p><span class="math display">\[
\mathbf{X} \beta = \sum_i^n \beta_i X_{i} = \beta_1 X_{1} + \beta_2 X_{2} + \dots + \beta_k X_{k}
\]</span></p>
<p>Usando el modelo de regresión lineal simple, encontramos una línea recta que (con suerte) explica nuestros datos. Bajo el modelo de regresión lineal múltiple encontramos, en cambio, un hiperplano de dimensión <span class="math inline">\(k\)</span>. Por lo tanto, el modelo de regresión lineal múltiple es esencialmente el mismo que el modelo de regresión lineal simple, con la única diferencia de que ahora <span class="math inline">\(\beta\)</span> es un vector y <span class="math inline">\(\mathbf{X}\)</span> es una matriz.</p>
<p>Para ver un ejemplo de un modelo de regresión lineal múltiple, volvamos al ejemplo de las bicicletas. Usaremos la temperatura y la humedad del día para predecir el número de bicicletas alquiladas.</p>
<div id="a9e2a622" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> model_mlb:</span>
<span id="cb58-2"><a href="#cb58-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">"α"</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb58-3"><a href="#cb58-3"></a>    β<span class="dv">0</span> <span class="op">=</span> pm.Normal(<span class="st">"β0"</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb58-4"><a href="#cb58-4"></a>    β<span class="dv">1</span> <span class="op">=</span> pm.Normal(<span class="st">"β1"</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb58-5"><a href="#cb58-5"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">"σ"</span>, <span class="dv">10</span>)</span>
<span id="cb58-6"><a href="#cb58-6"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">"μ"</span>, pm.math.exp(α <span class="op">+</span> β<span class="dv">0</span> <span class="op">*</span> bicis.temperatura <span class="op">+</span> β<span class="dv">1</span> <span class="op">*</span> bicis.hora))</span>
<span id="cb58-7"><a href="#cb58-7"></a>    _ <span class="op">=</span> pm.NegativeBinomial(<span class="st">"y_pred"</span>, mu<span class="op">=</span>μ, alpha<span class="op">=</span>σ, observed<span class="op">=</span>bicis.alquiladas)</span>
<span id="cb58-8"><a href="#cb58-8"></a></span>
<span id="cb58-9"><a href="#cb58-9"></a>    idata_mlb <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β0, β1, σ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 7 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b0ce5d61275d4c8ab15e2d0ecede27de","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>Tomemos un momento para comparar <code>model_mlb</code> que tiene dos variables independientes <code>temperatura</code> y <code>hora</code> con <code>model_neg</code> que solo tiene una variable independiente <code>temperatura</code>. La única diferencia es que ahora tenemos dos coeficientes <span class="math inline">\(\beta\)</span>, uno para cada variable independiente. El resto del modelo es el mismo. Podríamos haber escrito <code>β = pm.Normal("β1", mu=0, sigma=10, shape=2)</code> y luego usar <code>β1[0]</code> y <code>β1[1]</code> en la definición de <span class="math inline">\(\mu\)</span>. Yo suelo hacer eso, pero acá por ser el primer modelo de regresión múltiple, me pareció más claro escribirlo de esta manera.</p>
<p>Podemos ver que escribir un modelo de regresión múltiple no es tan diferente de escribir un modelo de regresión simple. Sin embargo, interpretar los resultados puede ser más desafiante. Por ejemplo, el coeficiente de <code>temperatura</code> ahora es <span class="math inline">\(\beta_0\)</span> y el coeficiente de <code>hora</code> es <span class="math inline">\(\beta_1\)</span>. Todavía podemos interpretar los coeficientes como el cambio en la variable dependiente por cambio unitario en la variable independiente. Pero ahora debemos tener cuidado de especificar de qué variable independiente estamos hablando. Por ejemplo, podemos decir que por una unidad de aumento en la temperatura, el número de bicicletas alquiladas aumenta en <span class="math inline">\(\beta_0\)</span> unidades, <em>manteniendo constante la hora</em>. O podemos decir que por una unidad de aumento en la hora, el número de bicicletas alquiladas aumenta en <span class="math inline">\(\beta_1\)</span> unidades, <em>manteniendo la temperatura constante</em>. Pero tenemos que entender que dado que las variables participan todas del mismo modelo, no podemos hablar de sus coeficientes de forma aislada. Esto lo podemos ver en la siguiente figura, que muestra los coeficientes <span class="math inline">\(\beta\)</span> para los modelos <code>model_neg</code> (solo <code>temperatura</code>) y para el modelo <code>model_mld</code> (<code>temperatura</code> y <code>hora</code>).</p>
<div id="af5a48f4" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Para hacer comparables los coeficientes los escalamos respecto de su correspondiente desviación estándar</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>idata_neg.posterior[<span class="st">"β0_scaled"</span>] <span class="op">=</span> idata_neg.posterior[<span class="st">"β"</span>] <span class="op">*</span> bicis.temperatura.std()</span>
<span id="cb60-3"><a href="#cb60-3"></a></span>
<span id="cb60-4"><a href="#cb60-4"></a>idata_mlb.posterior[<span class="st">"β0_scaled"</span>] <span class="op">=</span> idata_mlb.posterior[<span class="st">"β0"</span>] <span class="op">*</span> bicis.temperatura.std()</span>
<span id="cb60-5"><a href="#cb60-5"></a>idata_mlb.posterior[<span class="st">"β1_scaled"</span>] <span class="op">=</span> idata_mlb.posterior[<span class="st">"β1"</span>] <span class="op">*</span> bicis.hora.std()</span>
<span id="cb60-6"><a href="#cb60-6"></a></span>
<span id="cb60-7"><a href="#cb60-7"></a>az.plot_forest([idata_neg, idata_mlb], model_names<span class="op">=</span>[<span class="st">"model_neg"</span>, <span class="st">"model_mlb"</span>], var_names<span class="op">=</span>[<span class="st">"β0_scaled"</span>, <span class="st">"β1_scaled"</span>], figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">3</span>), combined<span class="op">=</span><span class="va">True</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>array([&lt;Axes: title={'center': '94.0% HDI'}&gt;], dtype=object)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-46-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En la figura anterior podemos ver que el coeficiente <span class="math inline">\(\beta_0\)</span>, que se corresponde con la temperatura es diferente en ambos modelos. Esto se debe a que el efecto de la hora ya explica algunas de las variaciones en el número de bicicletas alquiladas que anteriormente solo se explicaban por la temperatura. En casos extremos, la adición de una nueva variable puede llevar el coeficiente a cero o incluso cambiar el signo. Hablaremos más de esto en el próximo capítulo.</p>
</section>
<section id="bambi-una-sintaxis-para-gobernarlos-a-todos" class="level2" data-number="5.14">
<h2 data-number="5.14" class="anchored" data-anchor-id="bambi-una-sintaxis-para-gobernarlos-a-todos"><span class="header-section-number">5.14</span> Bambi: una sintaxis para gobernarlos a todos</h2>
<p>PyMC tiene una sintaxis muy simple y expresiva, que nos permite construir modelos arbitrarios, esta capacidad puede ser vista como una bendición, pero también como una carga. Bambi, en cambio, se centra en modelos de regresión; esta restricción conduce a una sintaxis más focalizada y características que serían difíciles de implementar en paquetes más generales.</p>
<p>Bambi utiliza una sintaxis de fórmula de Wilkinson similar a la utilizada por muchos paquetes de R como nlme, lme4 o brms. Supongamos que tenemos un DataFrame como el siguiente:</p>
<div id="8bc41bc6" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>SIZE <span class="op">=</span> <span class="dv">117</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>datos <span class="op">=</span> pd.DataFrame(</span>
<span id="cb62-3"><a href="#cb62-3"></a>    {</span>
<span id="cb62-4"><a href="#cb62-4"></a>        <span class="st">"y"</span>: np.random.normal(size<span class="op">=</span>SIZE),</span>
<span id="cb62-5"><a href="#cb62-5"></a>        <span class="st">"x"</span>: np.random.normal(size<span class="op">=</span>SIZE),</span>
<span id="cb62-6"><a href="#cb62-6"></a>        <span class="st">"z"</span>: np.random.normal(size<span class="op">=</span>SIZE),</span>
<span id="cb62-7"><a href="#cb62-7"></a>        <span class="st">"g"</span>: [<span class="st">"Group A"</span>, <span class="st">"Group B"</span>, <span class="st">"Group C"</span>] <span class="op">*</span> <span class="dv">39</span>,</span>
<span id="cb62-8"><a href="#cb62-8"></a>    }</span>
<span id="cb62-9"><a href="#cb62-9"></a>)</span>
<span id="cb62-10"><a href="#cb62-10"></a>datos.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">g</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.407373</td>
<td>0.926419</td>
<td>0.363536</td>
<td>Group A</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.077750</td>
<td>-2.315925</td>
<td>-1.165464</td>
<td>Group B</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.459236</td>
<td>1.177808</td>
<td>0.422089</td>
<td>Group C</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.117329</td>
<td>1.772152</td>
<td>0.682265</td>
<td>Group A</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.788372</td>
<td>1.089291</td>
<td>0.375650</td>
<td>Group B</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Usando estos datos queremos construir un modelo lineal que prediga <code>y</code> a partir de <code>x</code>. Usando PyMC haríamos algo como:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> lm:</span>
<span id="cb63-2"><a href="#cb63-2"></a>    Intercept <span class="op">=</span> pm.Normal(<span class="st">"Intercept"</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb63-3"><a href="#cb63-3"></a>    x <span class="op">=</span> pm.Normal(<span class="st">"x"</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb63-4"><a href="#cb63-4"></a>    y_sigma <span class="op">=</span> pm.HalfNormal(<span class="st">"sigma"</span>, <span class="dv">1</span>)</span>
<span id="cb63-5"><a href="#cb63-5"></a>    y_mean <span class="op">=</span> Intercept <span class="op">+</span> x <span class="op">*</span> data[<span class="st">"x"</span>]</span>
<span id="cb63-6"><a href="#cb63-6"></a>    y <span class="op">=</span> pm.Normal(<span class="st">"y"</span>, y_mean, y_sigma, observed<span class="op">=</span>data[<span class="st">"y"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Usando la sintaxis de Bambi, podemos escribir el mismo modelo como:</p>
<div id="8da88e8f" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>un_modelo <span class="op">=</span> bmb.Model(<span class="st">"y ~ x"</span>, datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En el lado izquierdo de <code>~</code> tenemos la variable dependiente y en el lado derecho la(s) variable(s) independiente(s). Con esta sintaxis, solo estamos especificando la media (<span class="math inline">\(\mu\)</span> en el modelo <code>lm</code> de PyMC). De forma predeterminada, Bambi asume que el likelihood es una Normal. Esto se puede cambiar con el argumento <code>family</code>. Esta sintáxis solo especifica cómo se relacionan las variables dependientes e independiente, pero no especifica las distribuciones <em>a priori</em>. Bambi internamente define distribuciones a priori debilmente informativas. Al imprimir un modelo de Bambi obtenemos mucha información útil sobre su especificación.</p>
<div id="8bcab983" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>un_modelo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>       Formula: y ~ x
        Family: gaussian
          Link: mu = identity
  Observations: 117
        Priors: 
    target = mu
        Common-level effects
            Intercept ~ Normal(mu: 0.0108, sigma: 2.6365)
            x ~ Normal(mu: 0.0, sigma: 2.4114)
        
        Auxiliary parameters
            sigma ~ HalfStudentT(nu: 4.0, sigma: 1.0541)</code></pre>
</div>
</div>
<p>La primera línea muestra la fórmula que usamos para definir el modelo y la segunda línea es el likelihood. En Bambi, usamos el argumento <code>family</code> para especificar el likelihood. La tercera línea es la función de enlace. Por defecto cada familia tiene asociada una función de enlace, por ej la Gaussiana se asocia a la función identidad. Luego tenemos el número de observaciones utilizadas para ajustar el modelo, y lo siguiente nos dice que estamos modelando linealmente el parámetro <span class="math inline">\(\mu\)</span> de la Gaussiana. Luego, en las siguientes líneas tenemos la estructura del modelo. La primera parte muestra los efectos de nivel común, en este caso, el intercepto y el coefficiente de regressión (la “pendiente”) asociado a <code>x</code>. En la segunda parte se muestran los parámetros auxiliares, es decir, todos los parámetros no modelados linealmente, en este caso, la desviación estándar.</p>
<p>Si querés omitir el intercepto, tenés dos opciones:</p>
<div id="6fe95ad2" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a>no_intercepto_1 <span class="op">=</span> bmb.Model(<span class="st">"y ~ 0 + x"</span>, datos)</span>
<span id="cb67-2"><a href="#cb67-2"></a>no_intercepto_1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>       Formula: y ~ 0 + x
        Family: gaussian
          Link: mu = identity
  Observations: 117
        Priors: 
    target = mu
        Common-level effects
            x ~ Normal(mu: 0.0, sigma: 2.4114)
        
        Auxiliary parameters
            sigma ~ HalfStudentT(nu: 4.0, sigma: 1.0541)</code></pre>
</div>
</div>
<div id="5b06d560" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>no_intercepto_2 <span class="op">=</span> bmb.Model(<span class="st">"y ~ -1 + x"</span>, datos)</span>
<span id="cb69-2"><a href="#cb69-2"></a>no_intercepto_2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>       Formula: y ~ -1 + x
        Family: gaussian
          Link: mu = identity
  Observations: 117
        Priors: 
    target = mu
        Common-level effects
            x ~ Normal(mu: 0.0, sigma: 2.4114)
        
        Auxiliary parameters
            sigma ~ HalfStudentT(nu: 4.0, sigma: 1.0541)</code></pre>
</div>
</div>
<p>Con Bambi también podemos incluir efectos a nivel de grupo (es decir jerarquías), por ejemplo, si queremos usar la variable <code>g</code> para agrupar parcialmente las estimaciones de <code>x</code> podemos hacerlo así:</p>
<div id="87214d44" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>modelo_h <span class="op">=</span> bmb.Model(<span class="st">"y ~ x + z + (x | g)"</span>, datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para obtener una representación gráfica de la estructura de un modelo de Bambi podemos usar el método <code>.graph()</code>, esto requiere que previamente hayamos usado el método <code>.build()</code> para construir el modelo. O el método <code>.fit()</code> para ajustar el modelo (calcular la distribución posterior de los parámetros). Veamos como lucen <code>un_modelo</code> y <code>modelo_h</code>:</p>
<div id="46f4f5f6" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a>un_modelo.build()</span>
<span id="cb72-2"><a href="#cb72-2"></a>un_modelo.graph()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-53-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="c733e4ce" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>modelo_h.build()</span>
<span id="cb73-2"><a href="#cb73-2"></a>modelo_h.graph()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-54-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>La sintaxis de la fórmula es muy simple, pero también muy poderosa. Acabamos de arañar la superficie de lo que podemos hacer con él. En lugar de describir la sintaxis de una vez, la mostraremos mediante ejemplos. Así que comencemos ajustando el modelo de bicicleta del capítulo anterior.</p>
</section>
<section id="bicicletas-bambinas" class="level2" data-number="5.15">
<h2 data-number="5.15" class="anchored" data-anchor-id="bicicletas-bambinas"><span class="header-section-number">5.15</span> Bicicletas bambinas</h2>
<div id="8ef12e96" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a>bicis <span class="op">=</span> pd.read_csv(<span class="st">"datos/bicis.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="42b6f0d0" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a>modelo_t <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ temperatura"</span>, bicis, family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb75-2"><a href="#cb75-2"></a>idata_t <span class="op">=</span> modelo_t.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, temperatura]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8f3e9a52249143d699c2f4a91883802e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="aa288278" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a>modelo_t.graph()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-57-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ahora vamos a graficar el ajuste medio a posteriori y las predicciones. Para ello usaremos la función <code>plot_predictions</code> del módulo <code>interpret</code>.</p>
<div id="c863cf6d" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>)) </span>
<span id="cb78-2"><a href="#cb78-2"></a>bmb.interpret.plot_predictions(modelo_t, idata_t, <span class="st">"temperatura"</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb78-3"><a href="#cb78-3"></a>bmb.interpret.plot_predictions(modelo_t, idata_t, <span class="st">"temperatura"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb78-4"><a href="#cb78-4"></a></span>
<span id="cb78-5"><a href="#cb78-5"></a>axes[<span class="dv">0</span>].plot(bicis.temperatura, bicis.alquiladas, <span class="st">"."</span>, color<span class="op">=</span><span class="st">"0.5"</span>,  zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb78-6"><a href="#cb78-6"></a>axes[<span class="dv">1</span>].plot(bicis.temperatura, bicis.alquiladas, <span class="st">"."</span>, color<span class="op">=</span><span class="st">"0.5"</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb78-7"><a href="#cb78-7"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"media"</span>)</span>
<span id="cb78-8"><a href="#cb78-8"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"predicciones"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-58-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Probemos ahora ajustar un modelo de regresión con dos variables predictoras, <code>temperatura</code> y <code>humedad</code>.</p>
<div id="7c74bab9" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a>modelo_th <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ temperatura + humedad"</span>, bicis, </span>
<span id="cb79-2"><a href="#cb79-2"></a>                     family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb79-3"><a href="#cb79-3"></a>                     </span>
<span id="cb79-4"><a href="#cb79-4"></a>idata_th <span class="op">=</span> modelo_th.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, temperatura, humedad]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 4 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"637f4c978ea94764b5ee2c6d4d47f112","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="1b1abfb1" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a>bmb.interpret.plot_predictions(modelo_th, idata_th, [<span class="st">"temperatura"</span>, <span class="st">"humedad"</span>],</span>
<span id="cb81-2"><a href="#cb81-2"></a>                               subplot_kwargs<span class="op">=</span>{<span class="st">"group"</span>:<span class="va">None</span>, <span class="st">"panel"</span>:<span class="st">"humedad"</span>},</span>
<span id="cb81-3"><a href="#cb81-3"></a>                               legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb81-4"><a href="#cb81-4"></a>                               fig_kwargs<span class="op">=</span>{<span class="st">"sharey"</span>:<span class="va">True</span>, <span class="st">"sharex"</span>:<span class="va">True</span>})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-60-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En la figura anterior podemos ver que la temperatura tiene un efecto positivo en el número de bicicletas alquiladas, mientras que la humedad tiene un efecto negativo. También podemos ver que el efecto de la temperatura es más fuerte que el de la humedad.</p>
</section>
<section id="regresión-polinomial" class="level2" data-number="5.16">
<h2 data-number="5.16" class="anchored" data-anchor-id="regresión-polinomial"><span class="header-section-number">5.16</span> Regresión polinomial</h2>
<p>Una forma de ajustar curvas usando un modelo de regresión lineal es construyendo un polinomio, como este:</p>
<p><span class="math display">\[
   \mu = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3 + \beta_4 x^4 \dots \beta_m x^m
\]</span></p>
<p>donde <span class="math inline">\(m\)</span> es el grado del polinomio.</p>
<p>Hay dos cosas importantes a tener en cuenta. Primero, la regresión polinómica sigue siendo una regresión lineal; la linealidad se refiere a los coeficientes (los <span class="math inline">\(\beta\)</span>s), no a las variables (los <span class="math inline">\(x\)</span>s). La segunda es que simplemente estamos creando nuevas variables de la nada. La única variable observada es <span class="math inline">\(x\)</span>, el resto son sólo potencias de <span class="math inline">\(x\)</span>. Crear nuevas variables a partir de las observadas es un “truco” perfectamente válido al hacer regresión, a veces la transformación puede estar motivada o justificada por la teoría (como sacar la raíz cuadrada de la longitud de los bebés), pero a veces es solo una forma de ajustar una curva. La intuición con los polinomios es que para un valor dado de <span class="math inline">\(x\)</span>, cuanto mayor sea el grado del polinomio, más flexible será el ajuste. Un polinomio de grado 1 es una línea, un polinomio de grado 2 es una curva que puede subir o bajar, un polinomio de grado 3 es una curva que puede subir y luego bajar (o al revés), y así sucesivamente. Note que dije “puede” porque si tenemos un polinomio de grado 3 como <span class="math inline">\(\beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3\)</span> pero los coeficientes <span class="math inline">\(\beta_2\)</span> y <span class="math inline">\(\beta_3\)</span> son 0 (o prácticamente 0), entonces la curva será una línea.</p>
<p>Hay dos formas de definir una regresión polinómica con Bambi. Podemos escribir los polinomios <em>brutos</em>:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a><span class="co">"y ~ x + I(x ** 2) + I(x ** 3) + I(x ** 4)"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>donde usamos la función de identidad <code>I</code> para dejar claro que queremos elevar <span class="math inline">\(x\)</span> a alguna potencia. Necesitamos esto porque el operador <code>**</code> tiene un significado especial para Bambi. Si usamos esta sintaxis, le estamos diciendo a Bambi que modele la media de <span class="math inline">\(y\)</span> como <span class="math inline">\(\alpha + \beta_0 x + \beta_0 x^2 + \beta_0 x^3 + \beta_0 x^4\)</span></p>
<p>Alternativamente podemos escribir</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a><span class="co">"y ~ poly(x, 4)"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Esto también generará un polinomio de grado 4, pero los términos del polinomio serán ortogonales entre sí, lo que significa que la correlación entre los términos se reduce. Sin entrar en detalles matemáticos, esto tiene al menos dos consecuencias importantes con respecto a los polinomios <em>brutos</em>. En primer lugar, la estimación puede ser numéricamente más estable y, en segundo lugar, la interpretación de los coeficientes es diferente. En la regresión polinómica <em>estándar</em>, los coeficientes pueden ser difíciles de interpretar, ya que cambiar el valor de un coeficiente afecta a todo el polinomio. En cambio, los polinomios ortogonales permiten interpretar más claramente el efecto de cada término, ya que son independientes entre sí. Si bien la interpretación de los coeficientes es diferente, otros resultados siguen siendo los mismos. Por ejemplo, deberías obtener las mismas predicciones con ambos enfoques.</p>
<p>Construyamos un polinomio ortogonal de grado 4 para modelar los datos de la bicis. Para este ejemplo, usaremos la variable <code>hora</code>:</p>
<div id="29a85614" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>modelo_poly4 <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ poly(hora, degree=4)"</span>, bicis,</span>
<span id="cb84-2"><a href="#cb84-2"></a>                       family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb84-3"><a href="#cb84-3"></a>idata_poly4 <span class="op">=</span> modelo_poly4.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, poly(hora, degree=4)]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 4 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4368f722ebbd4d34af2b9a194179029a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="0488381a" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">3</span>)) </span>
<span id="cb86-2"><a href="#cb86-2"></a>bmb.interpret.plot_predictions(modelo_poly4, idata_poly4, <span class="st">"hora"</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb86-3"><a href="#cb86-3"></a>bmb.interpret.plot_predictions(modelo_poly4, idata_poly4, <span class="st">"hora"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb86-4"><a href="#cb86-4"></a></span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="cf">for</span> ax <span class="kw">in</span> axes.ravel():</span>
<span id="cb86-6"><a href="#cb86-6"></a>    ax.plot(bicis.hora, bicis.alquiladas, <span class="st">"C2."</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb86-7"><a href="#cb86-7"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"media"</span>)</span>
<span id="cb86-8"><a href="#cb86-8"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"predicciones"</span>)</span>
<span id="cb86-9"><a href="#cb86-9"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">""</span>)</span>
<span id="cb86-10"><a href="#cb86-10"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">""</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>Text(0, 0.5, '')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-62-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Un problema con los polinomios es que actúan <em>globalmente</em>. Cuando aplicamos un polinomio de grado <span class="math inline">\(m\)</span> estamos diciendo que la relación entre las variables independientes y dependientes es de grado <span class="math inline">\(m\)</span> para todo el conjunto de datos. Esto puede resultar problemático cuando diferentes regiones de nuestros datos necesitan diferentes niveles de flexibilidad. Esto podría conducir, por ejemplo, a curvas demasiado flexibles. A medida que aumenta el grado, el ajuste se vuelve más sensible a la eliminación de puntos o, de manera equivalente, a la adición de datos futuros. En otras palabras, a medida que aumenta el grado, el modelo se vuelve más propenso a sobreajustarse. La regresión polinomial Bayesiana generalmente sufre menos de este “exceso” gracias al uso de priors y al cálculo de toda una distribución a posteriori y no una estimación puntual.</p>
</section>
<section id="splines" class="level2" data-number="5.17">
<h2 data-number="5.17" class="anchored" data-anchor-id="splines"><span class="header-section-number">5.17</span> Splines</h2>
<p>Una forma general de escribir modelos muy flexibles es aplicar funciones <span class="math inline">\(B_{m}\)</span> a <span class="math inline">\(X_{m}\)</span> y luego multiplicarlas por coeficientes <span class="math inline">\(\beta_m\)</span>:</p>
<p><span class="math display">\[
\mu = \beta_0 + \beta_1 B_{1}(X_{1}) + \beta_2 B_{2}(X_{2}) + \cdots + \beta_m B_{m}(X_{m})
\]</span></p>
<p>Somos libres de elegir las funciones <span class="math inline">\(B_{m}\)</span>, por ejemplo, podemos elegir polinomios. Una opción popular es usar B-splines, no vamos a discutir su definición, pero podemos pensar en ellos como una forma de crear curvas suaves de tal manera que obtengamos flexibilidad, como con los polinomios, pero menos propensos al sobreajuste. Los B-splines son polinomios por partes, es decir, polinomios que están restringidos a afectar solo una parte de los datos. La siguiente figura muestra 3 ejemplos de polinomios por partes de grado creciente. Las líneas verticales punteadas muestran los “nudos”, que son los puntos utilizados para restringir las regiones, la línea gris discontinua representa la función que queremos aproximar y las líneas negras son los polinomios por partes.</p>
<p><img src="img/piecewise.png" class="img-fluid"></p>
<p>La siguiente figura muestra ejemplos de splines de grado 1 y 3, los puntos en la parte inferior representan los nudos y las líneas discontinuas son los B-splines. En la parte superior tenemos todos los B-splines con igual peso, usamos una escala de grises para resaltar que tenemos muchos B-splines. En el panel inferior, cada B-splines tiene un peso diferente (los multiplicamos por coeficientes <span class="math inline">\(\beta_m\)</span>), si sumamos los B-splines ponderados obtenemos como resultado la línea negra. Esta línea negra es lo que solemos llamar “la spline”. Podemos utilizar la estadística Bayesiana para encontrar los pesos adecuados para los B-splines.</p>
<p><img src="img/splines_weighted.png" class="img-fluid"></p>
<p>Podemos usar B-splines con Bambi usando la función <code>bs</code>. Por ejemplo, ajustemos un spline de grado 3 a los datos de las bicis:</p>
<div id="9efabf30" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a>num_knots <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb88-2"><a href="#cb88-2"></a>knots <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">23</span>, num_knots<span class="op">+</span><span class="dv">2</span>)[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb88-3"><a href="#cb88-3"></a>modelo_spline <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ bs(hora, degree=3, knots=knots)"</span>, bicis,           </span>
<span id="cb88-4"><a href="#cb88-4"></a>                         family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb88-5"><a href="#cb88-5"></a>idata_spline <span class="op">=</span> modelo_spline.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, bs(hora, degree=3, knots=knots)]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 6 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"df9c82ec2681419aa836d8fe6085aee8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>En la siguiente figura podemos ver que el número de bicicletas de alquiler es el más bajo a altas horas de la noche. Luego se produce un aumento, probablemente cuando la gente se despierta y va al trabajo, a la escuela u otras actividades. Tenemos un primer pico alrededor de la hora 8, luego un ligero descenso, seguido por el segundo pico alrededor de la hora 18, probablemente porque la gente regresa a casa, después del cual hay un descenso constante. Observe que la curva no es muy suave, esto se debe a que los datos están discretizados (por hora).</p>
<div id="9476c775" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1"></a>_, ax <span class="op">=</span> plt.subplots(sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>)) </span>
<span id="cb90-2"><a href="#cb90-2"></a>bmb.interpret.plot_predictions(modelo_spline, idata_spline, <span class="st">"hora"</span>, ax<span class="op">=</span>ax)</span>
<span id="cb90-3"><a href="#cb90-3"></a>ax.plot(bicis.hora, bicis.alquiladas, <span class="st">"C2."</span>, zorder<span class="op">=-</span><span class="dv">3</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-64-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Cuando trabajamos con splines, una decisión importante es determinar el número y la ubicación de los nudos. Esto puede ser una tarea algo desalentadora ya que el número óptimo de nudos y su espaciado no son evidentes de inmediato. Una sugerencia útil para determinar las ubicaciones de los nudos es considerar colocarlos según cuantiles en lugar de hacerlo de manera uniforme. Por ejemplo <code>nudos = np.quantile(bicis.hora, np.linspace(0, 1, num_knots))</code>. Al hacerlo, colocaríamos más nudos en áreas donde tenemos una mayor cantidad de datos, y menos nudos en áreas con menos datos. Esto da como resultado una aproximación más adaptable que captura efectivamente la variabilidad en regiones con una mayor densidad de puntos de datos. Además, es posible que deseemos ajustar splines con distintos números de nudos y posiciones y luego evaluar los resultados, utilizando herramientas como LOO, como veremos en el próximo capítulo.</p>
</section>
<section id="modelos-distribucionales" class="level2" data-number="5.18">
<h2 data-number="5.18" class="anchored" data-anchor-id="modelos-distribucionales"><span class="header-section-number">5.18</span> Modelos distribucionales</h2>
<p>Anteriormente vimos que podemos usar modelos lineales para parámetros distintos de la media. Por ejemplo, podemos utilizar un modelo lineal para la media y un modelo lineal para la desviación estándar de una distribución Gaussiana. Estos modelos suelen denominarse modelos distribucionales. La sintaxis de Bambi para los modelos distribucionales es muy similar, sólo necesitamos agregar una línea para los parámetros auxiliares que queremos modelar. Por ejemplo, sigma para una Gaussiano o alfa para un NegativaBinomial</p>
<p>Reproduzcamos ahora un ejemplo del capítulo anterior, el ejemplo de los bebés.</p>
<div id="6ec36946" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1"></a>bebes <span class="op">=</span> pd.read_csv(<span class="st">'datos/babies.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bfcf6edc" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a>modelo_cons <span class="op">=</span> bmb.Model(<span class="st">"Longitud ~ np.sqrt(Meses)"</span>, bebes)</span>
<span id="cb92-2"><a href="#cb92-2"></a>idata_cons <span class="op">=</span> modelo_cons.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [Longitud_sigma, Intercept, np.sqrt(Meses)]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"15a1a8d96a5747b3951d7abcb74480f6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>En el modelo anterior sigma es constante, ahora veamos un modelo distribucional. En este modelo <code>sigma</code> es una función lineal de <code>Meses</code>.</p>
<div id="88ce6a6a" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>formula <span class="op">=</span> bmb.Formula(</span>
<span id="cb94-2"><a href="#cb94-2"></a>    <span class="st">"Longitud ~ np.sqrt(Meses)"</span>,</span>
<span id="cb94-3"><a href="#cb94-3"></a>    <span class="st">"sigma ~ Meses"</span></span>
<span id="cb94-4"><a href="#cb94-4"></a>)</span>
<span id="cb94-5"><a href="#cb94-5"></a>modelo_dis <span class="op">=</span> bmb.Model(formula, bebes)</span>
<span id="cb94-6"><a href="#cb94-6"></a>idata_dis <span class="op">=</span> modelo_dis.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [Intercept, np.sqrt(Meses), sigma_Intercept, sigma_Meses]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 4 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8bfb3c699a27462db9f49eed86e4d56d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>En la siguiente figura podemos ver los valores a posteriori de sigma para los modelos con sigma constante y variable. Podemos ver que cuando se permite que sigma varíe obtenemos valores por debajo y por encima de la estimación para un sigma constante, lo que significa que estamos subestimando y sobreestimando este parámetro cuando no permitimos que cambie.</p>
<div id="9e15ac19" class="cell" data-execution_count="67">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="im">from</span> matplotlib.lines <span class="im">import</span> Line2D</span>
<span id="cb96-3"><a href="#cb96-3"></a></span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="cf">for</span> idx <span class="kw">in</span> idata_dis.posterior.coords.get(<span class="st">"Longitud_obs"</span>):</span>
<span id="cb96-5"><a href="#cb96-5"></a>    values <span class="op">=</span> idata_dis.posterior[<span class="st">"sigma"</span>].sel(Longitud_obs<span class="op">=</span>idx).to_numpy().flatten()</span>
<span id="cb96-6"><a href="#cb96-6"></a>    grid, pdf <span class="op">=</span> az.kde(values)</span>
<span id="cb96-7"><a href="#cb96-7"></a>    ax.plot(grid, pdf, lw<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">"C1"</span>)</span>
<span id="cb96-8"><a href="#cb96-8"></a></span>
<span id="cb96-9"><a href="#cb96-9"></a>values <span class="op">=</span> idata_cons.posterior[<span class="st">"Longitud_sigma"</span>].to_numpy().flatten()</span>
<span id="cb96-10"><a href="#cb96-10"></a>grid, pdf <span class="op">=</span> az.kde(values)</span>
<span id="cb96-11"><a href="#cb96-11"></a>ax.plot(grid, pdf, lw<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">"C0"</span>)</span>
<span id="cb96-12"><a href="#cb96-12"></a></span>
<span id="cb96-13"><a href="#cb96-13"></a>handles <span class="op">=</span> [</span>
<span id="cb96-14"><a href="#cb96-14"></a>    Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], label<span class="op">=</span><span class="st">"sigma variable"</span>, lw<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">"k"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>),</span>
<span id="cb96-15"><a href="#cb96-15"></a>    Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], label<span class="op">=</span><span class="st">"sigma constante"</span>, lw<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">"C0"</span>)</span>
<span id="cb96-16"><a href="#cb96-16"></a>]</span>
<span id="cb96-17"><a href="#cb96-17"></a></span>
<span id="cb96-18"><a href="#cb96-18"></a>legend <span class="op">=</span> ax.legend(handles<span class="op">=</span>handles, loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb96-19"><a href="#cb96-19"></a></span>
<span id="cb96-20"><a href="#cb96-20"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"Alfa a posteriori"</span>, yticks<span class="op">=</span>[])<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-68-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>La siguiente figura muestra el ajuste a posteriori para <code>model_dis</code>. Observe que el modelo puede capturar el aumento de la variabilidad a medida que los bebés crecen.</p>
<div id="03ef6348" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1"></a>_, ax <span class="op">=</span> plt.subplots(sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>)) </span>
<span id="cb97-2"><a href="#cb97-2"></a>bmb.interpret.plot_predictions(modelo_dis, idata_dis, <span class="st">"Meses"</span>, ax<span class="op">=</span>ax, fig_kwargs<span class="op">=</span>{<span class="st">"color"</span>:<span class="st">"k"</span>})</span>
<span id="cb97-3"><a href="#cb97-3"></a>bmb.interpret.plot_predictions(modelo_dis, idata_dis, <span class="st">"Meses"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax)</span>
<span id="cb97-4"><a href="#cb97-4"></a>ax_ <span class="op">=</span> bmb.interpret.plot_predictions(modelo_dis, idata_dis, <span class="st">"Meses"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax, prob<span class="op">=</span><span class="fl">0.65</span>)</span>
<span id="cb97-5"><a href="#cb97-5"></a>ax_[<span class="dv">1</span>][<span class="dv">0</span>].get_children()[<span class="dv">5</span>].set_facecolor(<span class="st">'C1'</span>)  </span>
<span id="cb97-6"><a href="#cb97-6"></a></span>
<span id="cb97-7"><a href="#cb97-7"></a>ax.plot(bebes.Meses, bebes.Longitud, <span class="st">"C2."</span>, zorder<span class="op">=-</span><span class="dv">3</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-69-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Al trabajar con PyMC vimos que el muestreo de la distribución predictiva a posteriori, evaluado en valores no observados, requiere que definamos el modelo con las “X” como <code>Mutable_data</code> y luego actualicemos el valor de la variable mutable antes de calcular la distribución predictiva posterior. Con Bambi esto no es necesario, podemos usar el método <code>predict</code> para predecir nuevos valores pasando los nuevos valores al argumento <code>data</code>. Por ejemplo, predigamos la longitud de un bebé a los 0,5 meses (15 días):</p>
<div id="b22c1912" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a>modelo_dis.predict(idata_dis, kind<span class="op">=</span><span class="st">"pps"</span>, data<span class="op">=</span>pd.DataFrame({<span class="st">"Meses"</span>:[<span class="fl">0.5</span>]}))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esto agrega un grupo <code>posterior_predictive</code> a <code>idata_dis</code></p>
<div id="f7e81b47" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1"></a>idata_dis</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">

            <div>
              <div class="xr-header">
                <div class="xr-obj-type">arviz.InferenceData</div>
              </div>
              <ul class="xr-sections group-sections">
              
            <li class="xr-section-item">
                  <input id="idata_posterior5fa1a240-e22e-40da-92a0-18c1f8e584d2" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior5fa1a240-e22e-40da-92a0-18c1f8e584d2" class="xr-section-summary">posterior</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 200kB
Dimensions:          (chain: 4, draw: 1000, Longitud_obs: 1)
Coordinates:
  * chain            (chain) int64 32B 0 1 2 3
  * draw             (draw) int64 8kB 0 1 2 3 4 5 6 ... 994 995 996 997 998 999
  * Longitud_obs     (Longitud_obs) int64 8B 0
Data variables:
    Intercept        (chain, draw) float64 32kB 47.92 47.92 47.94 ... 48.25 47.9
    np.sqrt(Meses)   (chain, draw) float64 32kB 7.892 7.845 ... 7.879 7.934
    sigma_Intercept  (chain, draw) float64 32kB 0.8885 0.9048 ... 0.8158 0.8987
    sigma_Meses      (chain, draw) float64 32kB 0.03082 0.02981 ... 0.03055
    Longitud_mean    (chain, draw, Longitud_obs) float64 32kB 53.5 ... 53.51
    Longitud_sigma   (chain, draw, Longitud_obs) float64 32kB 2.469 ... 2.494
Attributes:
    created_at:                  2024-07-22T17:18:32.797577+00:00
    arviz_version:               0.19.0
    inference_library:           pymc
    inference_library_version:   5.15.1
    sampling_time:               3.6786086559295654
    tuning_steps:                1000
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-0e023695-8812-4040-9fd7-3af8fbf39e0d" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-0e023695-8812-4040-9fd7-3af8fbf39e0d" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">Longitud_obs</span>: 1</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-3948ac00-a535-4cc3-b3dd-7b452951908c" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-3948ac00-a535-4cc3-b3dd-7b452951908c" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-a1f1b781-b16e-4e8e-9f48-608b22f29105" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a1f1b781-b16e-4e8e-9f48-608b22f29105" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ac932735-f9a6-4404-839f-93583053db5b" class="xr-var-data-in" type="checkbox"><label for="data-ac932735-f9a6-4404-839f-93583053db5b" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-e6eeafa2-95c3-4605-977b-659ba1f718db" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e6eeafa2-95c3-4605-977b-659ba1f718db" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-fdda9418-f829-4551-a26c-b83267232562" class="xr-var-data-in" type="checkbox"><label for="data-fdda9418-f829-4551-a26c-b83267232562" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">Longitud_obs</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-9e3bf6a2-4775-4154-b4b9-22bb7142adf3" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9e3bf6a2-4775-4154-b4b9-22bb7142adf3" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-eb454e2e-385e-4117-8622-2d6e8ac443e5" class="xr-var-data-in" type="checkbox"><label for="data-eb454e2e-385e-4117-8622-2d6e8ac443e5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-657a0f20-04ce-4e15-9040-301117521b38" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-657a0f20-04ce-4e15-9040-301117521b38" class="xr-section-summary">Data variables: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>Intercept</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">47.92 47.92 47.94 ... 48.25 47.9</div><input id="attrs-9255eaa4-2bad-4ef1-a5cf-958d6c358761" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9255eaa4-2bad-4ef1-a5cf-958d6c358761" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-aef47dcf-645b-4853-8892-9efc8dfb424d" class="xr-var-data-in" type="checkbox"><label for="data-aef47dcf-645b-4853-8892-9efc8dfb424d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[47.91771846, 47.91992249, 47.93586981, ..., 48.09443877,
        47.96839361, 47.91206188],
       [48.06217855, 48.26491003, 47.98094919, ..., 48.38467063,
        48.25822131, 47.80878658],
       [47.76763464, 48.25976916, 48.08167666, ..., 47.83055773,
        47.86021886, 47.75681441],
       [48.45258761, 47.42670193, 48.34785534, ..., 48.27050085,
        48.25281343, 47.89893323]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>np.sqrt(Meses)</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">7.892 7.845 7.998 ... 7.879 7.934</div><input id="attrs-c058e4ae-8f1b-4d44-b920-ea6e0207b07c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c058e4ae-8f1b-4d44-b920-ea6e0207b07c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e77a0814-d291-47b0-96e5-3dd5b57774f5" class="xr-var-data-in" type="checkbox"><label for="data-e77a0814-d291-47b0-96e5-3dd5b57774f5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[7.89245948, 7.84458374, 7.99800602, ..., 7.8018446 , 7.87920642,
        8.0022317 ],
       [7.8951179 , 7.82140799, 7.88992669, ..., 7.78171594, 7.80611068,
        7.90036559],
       [7.96897533, 7.76135908, 7.80241084, ..., 7.91609043, 7.93040629,
        8.05043247],
       [7.74691012, 8.04629332, 7.78245506, ..., 7.70768771, 7.87867895,
        7.93412924]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>sigma_Intercept</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.8885 0.9048 ... 0.8158 0.8987</div><input id="attrs-10110d63-8317-4f29-819a-34fd4c0e1290" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-10110d63-8317-4f29-819a-34fd4c0e1290" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d4f6daa2-d0ec-48ac-8c46-c6098bdbaf65" class="xr-var-data-in" type="checkbox"><label for="data-d4f6daa2-d0ec-48ac-8c46-c6098bdbaf65" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.88853921, 0.9047667 , 0.84292493, ..., 0.83464737, 0.82742547,
        0.89979627],
       [0.91398902, 0.79656607, 0.7124011 , ..., 0.80292547, 0.87359909,
        0.89603953],
       [0.88232972, 0.7980029 , 0.76379873, ..., 0.86087956, 0.90236582,
        0.91686502],
       [0.76812365, 0.94810923, 0.85706704, ..., 0.87501978, 0.81577323,
        0.89872523]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>sigma_Meses</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.03082 0.02981 ... 0.0321 0.03055</div><input id="attrs-25d2870a-2b67-4185-bada-8af34442307f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-25d2870a-2b67-4185-bada-8af34442307f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-998c93db-94db-4540-8fc7-9f899ca2e503" class="xr-var-data-in" type="checkbox"><label for="data-998c93db-94db-4540-8fc7-9f899ca2e503" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.03082223, 0.0298126 , 0.03431812, ..., 0.0373662 , 0.03700639,
        0.02988437],
       [0.03285147, 0.03696041, 0.04775562, ..., 0.03412524, 0.03359771,
        0.03035567],
       [0.03068677, 0.04135866, 0.03862905, ..., 0.03402629, 0.02965904,
        0.02921001],
       [0.04017426, 0.02594319, 0.03210694, ..., 0.0368629 , 0.0321027 ,
        0.03054941]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>Longitud_mean</span></div><div class="xr-var-dims">(chain, draw, Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">53.5 53.47 53.59 ... 53.82 53.51</div><input id="attrs-cd17a0fd-9486-4316-815c-cb2d3a3ad039" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-cd17a0fd-9486-4316-815c-cb2d3a3ad039" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-64577081-46ee-4fce-ab0d-c195cead950d" class="xr-var-data-in" type="checkbox"><label for="data-64577081-46ee-4fce-ab0d-c195cead950d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[53.49853007],
        [53.46688085],
        [53.5913141 ],
        ...,
        [53.61117599],
        [53.5398339 ],
        [53.57049418]],

       [[53.64486995],
        [53.79548066],
        [53.55996986],
        ...,
        [53.88717474],
        [53.7779751 ],
        [53.39518867]],

       [[53.40255114],
        [53.7478788 ],
        [53.59881427],
        ...,
        [53.42807896],
        [53.46786293],
        [53.4493298 ]],

       [[53.93048029],
        [53.1162905 ],
        [53.85088209],
        ...,
        [53.72065909],
        [53.82388074],
        [53.50920982]]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>Longitud_sigma</span></div><div class="xr-var-dims">(chain, draw, Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.469 2.508 2.363 ... 2.298 2.494</div><input id="attrs-a3bf0d4a-e402-4668-a9f1-65f747bd5da8" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a3bf0d4a-e402-4668-a9f1-65f747bd5da8" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5b4dc5ce-d497-4640-8b25-ed125319cf17" class="xr-var-data-in" type="checkbox"><label for="data-5b4dc5ce-d497-4640-8b25-ed125319cf17" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[2.46933855],
        [2.50846998],
        [2.36335919],
        ...,
        [2.34745197],
        [2.33014073],
        [2.49612231]],

       [[2.5355606 ],
        [2.25928022],
        [2.08815085],
        ...,
        [2.27047279],
        [2.43609888],
        [2.48734869]],

       [[2.45388653],
        [2.26750982],
        [2.18827433],
        ...,
        [2.40582457],
        [2.50226253],
        [2.5382377 ]],

       [[2.19945758],
        [2.61452078],
        [2.39437085],
        ...,
        [2.44354836],
        [2.29750692],
        [2.49427955]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-9b4bd3f2-5964-4324-a668-4e4482ce60b4" class="xr-section-summary-in" type="checkbox"><label for="section-9b4bd3f2-5964-4324-a668-4e4482ce60b4" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-4358f9eb-9886-4857-a66e-2ccae9c00f79" class="xr-index-data-in" type="checkbox"><label for="index-4358f9eb-9886-4857-a66e-2ccae9c00f79" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-7937e783-7215-40f9-b181-3eae4933bf36" class="xr-index-data-in" type="checkbox"><label for="index-7937e783-7215-40f9-b181-3eae4933bf36" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>Longitud_obs</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-108b4e5b-cda3-4621-a388-59d93fc19fe2" class="xr-index-data-in" type="checkbox"><label for="index-108b4e5b-cda3-4621-a388-59d93fc19fe2" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0], dtype='int64', name='Longitud_obs'))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-804bd8bd-584a-4923-8693-e2708e2ef76d" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-804bd8bd-584a-4923-8693-e2708e2ef76d" class="xr-section-summary">Attributes: <span>(8)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-07-22T17:18:32.797577+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>sampling_time :</span></dt><dd>3.6786086559295654</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_posterior_predictive156fff7a-fc15-4860-9c93-7bacba937cf8" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior_predictive156fff7a-fc15-4860-9c93-7bacba937cf8" class="xr-section-summary">posterior_predictive</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 40kB
Dimensions:       (chain: 4, draw: 1000, Longitud_obs: 1)
Coordinates:
  * chain         (chain) int64 32B 0 1 2 3
  * draw          (draw) int64 8kB 0 1 2 3 4 5 6 ... 993 994 995 996 997 998 999
  * Longitud_obs  (Longitud_obs) int64 8B 0
Data variables:
    Longitud      (chain, draw, Longitud_obs) float64 32kB 48.83 49.05 ... 55.52
Attributes:
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-04954059-2415-4f9a-8971-09e59ba18b58" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-04954059-2415-4f9a-8971-09e59ba18b58" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">Longitud_obs</span>: 1</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-c510fcad-44f7-4551-a73a-a8afb6a71399" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-c510fcad-44f7-4551-a73a-a8afb6a71399" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-0980f0ae-cb7e-4c9b-bb06-84e3a0bebb53" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0980f0ae-cb7e-4c9b-bb06-84e3a0bebb53" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a11aea42-a66f-4348-afeb-5518035d00f0" class="xr-var-data-in" type="checkbox"><label for="data-a11aea42-a66f-4348-afeb-5518035d00f0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-07f0e491-05e1-4cbc-9ab5-200118c80c46" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-07f0e491-05e1-4cbc-9ab5-200118c80c46" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-97c5267f-0d54-4523-8724-bdffa09f65c4" class="xr-var-data-in" type="checkbox"><label for="data-97c5267f-0d54-4523-8724-bdffa09f65c4" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">Longitud_obs</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-006defbb-e578-4de5-a210-3e080f159322" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-006defbb-e578-4de5-a210-3e080f159322" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-0f2cef74-c1a1-4395-8baa-286426839348" class="xr-var-data-in" type="checkbox"><label for="data-0f2cef74-c1a1-4395-8baa-286426839348" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-2f80df25-89b6-4a2c-82cc-60c20bb5259d" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-2f80df25-89b6-4a2c-82cc-60c20bb5259d" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>Longitud</span></div><div class="xr-var-dims">(chain, draw, Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">48.83 49.05 50.98 ... 54.06 55.52</div><input id="attrs-36f120af-43eb-4003-8c50-00bc87e867da" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-36f120af-43eb-4003-8c50-00bc87e867da" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-531c1ae7-0e61-4c8d-8352-eaa1f3e76b08" class="xr-var-data-in" type="checkbox"><label for="data-531c1ae7-0e61-4c8d-8352-eaa1f3e76b08" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[48.82697274],
        [49.05169218],
        [50.97820524],
        ...,
        [53.87268366],
        [52.34049638],
        [55.03638748]],

       [[55.16611995],
        [56.3217108 ],
        [51.63934665],
        ...,
        [57.44745826],
        [54.08188411],
        [52.27217071]],

       [[54.59075763],
        [53.85940292],
        [54.41209247],
        ...,
        [54.76602992],
        [55.07923841],
        [50.48000406]],

       [[53.93287158],
        [54.18120697],
        [55.46084545],
        ...,
        [50.81749724],
        [54.0589155 ],
        [55.51943343]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-5720c763-f548-4da9-8693-c4d3de79ffb3" class="xr-section-summary-in" type="checkbox"><label for="section-5720c763-f548-4da9-8693-c4d3de79ffb3" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-ec95238b-a032-4320-af08-5c54d7674183" class="xr-index-data-in" type="checkbox"><label for="index-ec95238b-a032-4320-af08-5c54d7674183" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-3987c719-9470-49dd-9604-650b3cf4ecd7" class="xr-index-data-in" type="checkbox"><label for="index-3987c719-9470-49dd-9604-650b3cf4ecd7" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>Longitud_obs</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-5c294098-a61f-43cf-a03e-b5ae5042425d" class="xr-index-data-in" type="checkbox"><label for="index-5c294098-a61f-43cf-a03e-b5ae5042425d" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0], dtype='int64', name='Longitud_obs'))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-b938f92b-e320-4845-94d4-dd1919351ac9" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-b938f92b-e320-4845-94d4-dd1919351ac9" class="xr-section-summary">Attributes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_sample_stats46dbf5ea-5aa9-4a2c-9556-46c6cfdd8405" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_sample_stats46dbf5ea-5aa9-4a2c-9556-46c6cfdd8405" class="xr-section-summary">sample_stats</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 496kB
Dimensions:                (chain: 4, draw: 1000)
Coordinates:
  * chain                  (chain) int64 32B 0 1 2 3
  * draw                   (draw) int64 8kB 0 1 2 3 4 5 ... 995 996 997 998 999
Data variables: (12/17)
    acceptance_rate        (chain, draw) float64 32kB 0.9634 0.8389 ... 1.0
    diverging              (chain, draw) bool 4kB False False ... False False
    energy                 (chain, draw) float64 32kB 2.128e+03 ... 2.131e+03
    energy_error           (chain, draw) float64 32kB -0.1448 0.4038 ... -1.335
    index_in_trajectory    (chain, draw) int64 32kB -2 -1 3 -3 1 ... 2 -2 2 4 1
    largest_eigval         (chain, draw) float64 32kB nan nan nan ... nan nan
    ...                     ...
    process_time_diff      (chain, draw) float64 32kB 0.0005846 ... 0.0009832
    reached_max_treedepth  (chain, draw) bool 4kB False False ... False False
    smallest_eigval        (chain, draw) float64 32kB nan nan nan ... nan nan
    step_size              (chain, draw) float64 32kB 0.9659 0.9659 ... 1.119
    step_size_bar          (chain, draw) float64 32kB 0.9013 0.9013 ... 0.9766
    tree_depth             (chain, draw) int64 32kB 2 2 3 2 2 2 ... 2 2 2 2 3 2
Attributes:
    created_at:                  2024-07-22T17:18:32.816106+00:00
    arviz_version:               0.19.0
    inference_library:           pymc
    inference_library_version:   5.15.1
    sampling_time:               3.6786086559295654
    tuning_steps:                1000
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-f06c810f-75e2-4eec-b1d9-b96fba7ecb08" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-f06c810f-75e2-4eec-b1d9-b96fba7ecb08" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-909eb728-18f0-4a79-98c8-da0fc0aae0f3" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-909eb728-18f0-4a79-98c8-da0fc0aae0f3" class="xr-section-summary">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-eefc2b54-ad12-40e3-a973-c6ffbc155e36" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-eefc2b54-ad12-40e3-a973-c6ffbc155e36" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c90cf731-3805-48c4-9363-b1dad1025249" class="xr-var-data-in" type="checkbox"><label for="data-c90cf731-3805-48c4-9363-b1dad1025249" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-2727084e-63f5-422e-a3c6-02f1a43aff9a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2727084e-63f5-422e-a3c6-02f1a43aff9a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2b56fbad-0b78-4c9d-b44f-c47146453262" class="xr-var-data-in" type="checkbox"><label for="data-2b56fbad-0b78-4c9d-b44f-c47146453262" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-58f6775d-4666-43ad-ac2e-d5f8ca27fe12" class="xr-section-summary-in" type="checkbox"><label for="section-58f6775d-4666-43ad-ac2e-d5f8ca27fe12" class="xr-section-summary">Data variables: <span>(17)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>acceptance_rate</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.9634 0.8389 0.9794 ... 0.7334 1.0</div><input id="attrs-94b85f27-cfa2-4f0d-bb66-3f5c98322600" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-94b85f27-cfa2-4f0d-bb66-3f5c98322600" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-29a27530-4514-4778-bc97-c20034ad4b1f" class="xr-var-data-in" type="checkbox"><label for="data-29a27530-4514-4778-bc97-c20034ad4b1f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.96339565, 0.83888164, 0.97941019, ..., 0.47986966, 0.99139062,
        0.66572272],
       [0.59462122, 0.95206033, 0.2496578 , ..., 0.81399083, 0.86710035,
        0.93278275],
       [0.76091453, 0.73277358, 0.78687965, ..., 0.85612834, 0.92412518,
        0.78422142],
       [0.90594456, 0.96324394, 1.        , ..., 0.64882654, 0.73336392,
        1.        ]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>diverging</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-95d29e6a-4879-4f76-8080-4046555d35c5" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-95d29e6a-4879-4f76-8080-4046555d35c5" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d7289537-9de9-48cd-96b5-25484beaa67f" class="xr-var-data-in" type="checkbox"><label for="data-d7289537-9de9-48cd-96b5-25484beaa67f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.128e+03 2.128e+03 ... 2.131e+03</div><input id="attrs-773f1084-5dd9-44d5-bf71-9d2d44642a22" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-773f1084-5dd9-44d5-bf71-9d2d44642a22" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-442db6bf-04f4-41d9-8595-209a34187e8c" class="xr-var-data-in" type="checkbox"><label for="data-442db6bf-04f4-41d9-8595-209a34187e8c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2127.56689358, 2128.34534615, 2130.2993243 , ..., 2129.75500971,
        2127.41118168, 2130.21459891],
       [2131.09391846, 2129.56351668, 2137.74447079, ..., 2130.66740891,
        2132.68592627, 2128.09062783],
       [2128.34785545, 2129.80480375, 2131.14698558, ..., 2126.95167641,
        2127.3426137 , 2130.57494795],
       [2129.36270087, 2132.02562962, 2131.31177933, ..., 2130.42550348,
        2133.53445328, 2131.38446494]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-0.1448 0.4038 ... 0.5079 -1.335</div><input id="attrs-9acd6d6e-6633-40c6-a15f-92511ade7a43" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9acd6d6e-6633-40c6-a15f-92511ade7a43" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-27c94a0b-2580-49c3-9761-b38ff57e40e2" class="xr-var-data-in" type="checkbox"><label for="data-27c94a0b-2580-49c3-9761-b38ff57e40e2" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-0.14484357,  0.40378327,  0.15563521, ..., -0.01055528,
        -0.06816132,  0.42902946],
       [-0.04630251, -0.0456077 ,  1.69029629, ...,  0.35630574,
        -0.59419156,  0.04598971],
       [-0.16073785,  0.44430503, -0.26956433, ...,  0.07603307,
         0.07306079,  0.30716679],
       [ 0.33151738,  0.28517792, -0.52463128, ...,  0.74613665,
         0.50788339, -1.33534244]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>index_in_trajectory</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">-2 -1 3 -3 1 3 -1 ... 1 2 -2 2 4 1</div><input id="attrs-c47c1d9e-70d2-4226-bf66-dc7ab8290dd3" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c47c1d9e-70d2-4226-bf66-dc7ab8290dd3" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-20edbe01-17e9-41f8-b0b2-f783e83445c1" class="xr-var-data-in" type="checkbox"><label for="data-20edbe01-17e9-41f8-b0b2-f783e83445c1" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-2, -1,  3, ..., -2,  1,  2],
       [-2, -5, -1, ..., -1, -3, -2],
       [-3,  2,  2, ..., -3, -1,  2],
       [ 2, -2, -2, ...,  2,  4,  1]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>largest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-74c8531b-9114-4689-8b6f-c715eaf32ccf" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-74c8531b-9114-4689-8b6f-c715eaf32ccf" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ba438639-309e-4042-8e6a-913d703e84b1" class="xr-var-data-in" type="checkbox"><label for="data-ba438639-309e-4042-8e6a-913d703e84b1" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>lp</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-2.126e+03 ... -2.127e+03</div><input id="attrs-733d647c-de29-4a1f-9b1f-291c397019fd" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-733d647c-de29-4a1f-9b1f-291c397019fd" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e7c07951-abee-46a8-a2e5-0b1d2e7040f3" class="xr-var-data-in" type="checkbox"><label for="data-e7c07951-abee-46a8-a2e5-0b1d2e7040f3" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-2126.4228394 , -2128.01224118, -2129.2311997 , ...,
        -2126.85826266, -2126.26661791, -2129.11321747],
       [-2128.34146848, -2127.35391357, -2134.67560758, ...,
        -2129.17118802, -2126.7342631 , -2127.20458182],
       [-2126.77399044, -2128.6998843 , -2127.80020544, ...,
        -2126.21013778, -2126.80053591, -2129.6402235 ],
       [-2129.02569227, -2130.62787188, -2127.46720365, ...,
        -2130.34620101, -2131.38065797, -2126.6241714 ]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>max_energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-0.1448 0.4038 ... 0.938 -1.335</div><input id="attrs-4b5e75df-505e-4366-9b9f-53d91cc47129" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-4b5e75df-505e-4366-9b9f-53d91cc47129" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-81d64bee-dc71-4188-8d0d-25b955d327ad" class="xr-var-data-in" type="checkbox"><label for="data-81d64bee-dc71-4188-8d0d-25b955d327ad" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-0.14484357,  0.40378327, -0.34214778, ...,  1.58079586,
        -0.07379508,  0.47034948],
       [ 1.09497979, -0.35333339,  1.69029629, ...,  0.35630574,
        -0.59419156,  0.17043671],
       [ 0.57537264,  0.44430503,  0.710298  , ...,  0.25401912,
         0.14253123,  0.46471475],
       [-0.36061503, -0.64347459, -0.52463128, ...,  0.74613665,
         0.93795119, -1.33534244]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>n_steps</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">3.0 3.0 7.0 3.0 ... 3.0 3.0 7.0 3.0</div><input id="attrs-e9376c49-f03f-49e5-a5ac-f736ce1ff09c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e9376c49-f03f-49e5-a5ac-f736ce1ff09c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-65797220-7e09-4e0d-bd12-83f2e2124a30" class="xr-var-data-in" type="checkbox"><label for="data-65797220-7e09-4e0d-bd12-83f2e2124a30" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[3., 3., 7., ..., 3., 7., 3.],
       [3., 7., 3., ..., 3., 3., 3.],
       [7., 3., 3., ..., 3., 3., 3.],
       [3., 7., 3., ..., 3., 7., 3.]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0005845 0.0006046 ... 0.0009829</div><input id="attrs-fd9be6b8-77b7-4551-b839-10e5fba5bf23" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-fd9be6b8-77b7-4551-b839-10e5fba5bf23" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-bb1c7228-eda9-4f42-ae98-795eb2d46fe2" class="xr-var-data-in" type="checkbox"><label for="data-bb1c7228-eda9-4f42-ae98-795eb2d46fe2" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.0005845 , 0.00060456, 0.0011192 , ..., 0.000572  , 0.00114565,
        0.0005753 ],
       [0.00098293, 0.001981  , 0.00097717, ..., 0.00056389, 0.00057926,
        0.0005686 ],
       [0.00132289, 0.00070568, 0.00128283, ..., 0.00100113, 0.00086162,
        0.00087348],
       [0.00067223, 0.00122514, 0.00066551, ..., 0.00078213, 0.0016246 ,
        0.00098288]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_start</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.697e+03 2.697e+03 ... 2.698e+03</div><input id="attrs-b8773276-0e42-4c1a-a522-21507316fa6c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b8773276-0e42-4c1a-a522-21507316fa6c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8ed4cc7d-6900-46de-bc04-e080fb78cd89" class="xr-var-data-in" type="checkbox"><label for="data-8ed4cc7d-6900-46de-bc04-e080fb78cd89" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2696.7230352 , 2696.72374002, 2696.72445462, ..., 2697.72253817,
        2697.72321501, 2697.72447373],
       [2697.28089751, 2697.28211876, 2697.2842804 , ..., 2698.35513089,
        2698.35579822, 2698.35648238],
       [2696.56302024, 2696.56447781, 2696.56547516, ..., 2697.58761051,
        2697.58874769, 2697.58976629],
       [2696.96978927, 2696.97061183, 2696.97195906, ..., 2698.06628338,
        2698.06724527, 2698.06903785]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>process_time_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0005846 0.0006049 ... 0.0009832</div><input id="attrs-e25e0e0f-acff-4b02-b182-1a24db13da3e" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e25e0e0f-acff-4b02-b182-1a24db13da3e" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b6701997-4400-4e39-b8ca-ab9036dc2e32" class="xr-var-data-in" type="checkbox"><label for="data-b6701997-4400-4e39-b8ca-ab9036dc2e32" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00058465, 0.00060492, 0.00111945, ..., 0.0005723 , 0.00114612,
        0.00057541],
       [0.00098335, 0.00198122, 0.00097756, ..., 0.0005641 , 0.00057958,
        0.00056886],
       [0.00132319, 0.00070613, 0.00110778, ..., 0.00100161, 0.00086222,
        0.00087388],
       [0.00067268, 0.00122559, 0.00066594, ..., 0.00078297, 0.00162533,
        0.00098321]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>reached_max_treedepth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-1f3e3767-5be3-4f0d-8178-aeb9c8cc7643" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1f3e3767-5be3-4f0d-8178-aeb9c8cc7643" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c0745f45-050d-4a4a-af6d-bf1ba4aa0213" class="xr-var-data-in" type="checkbox"><label for="data-c0745f45-050d-4a4a-af6d-bf1ba4aa0213" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>smallest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-2ba69bb8-78ab-451a-8948-8c678527f99b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2ba69bb8-78ab-451a-8948-8c678527f99b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-62f2d419-0a5a-4edc-a4ec-219875a28813" class="xr-var-data-in" type="checkbox"><label for="data-62f2d419-0a5a-4edc-a4ec-219875a28813" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.9659 0.9659 ... 1.119 1.119</div><input id="attrs-fb79d656-0215-4a2e-a734-bfdf55da8dc8" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-fb79d656-0215-4a2e-a734-bfdf55da8dc8" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-df2a3cdd-fba1-41b1-8dcd-e9c4a6728339" class="xr-var-data-in" type="checkbox"><label for="data-df2a3cdd-fba1-41b1-8dcd-e9c4a6728339" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.96586085, 0.96586085, 0.96586085, ..., 0.96586085, 0.96586085,
        0.96586085],
       [0.78534127, 0.78534127, 0.78534127, ..., 0.78534127, 0.78534127,
        0.78534127],
       [1.12921692, 1.12921692, 1.12921692, ..., 1.12921692, 1.12921692,
        1.12921692],
       [1.11897716, 1.11897716, 1.11897716, ..., 1.11897716, 1.11897716,
        1.11897716]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size_bar</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.9013 0.9013 ... 0.9766 0.9766</div><input id="attrs-89539a9d-94c8-4876-9b26-1cdb1012a997" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-89539a9d-94c8-4876-9b26-1cdb1012a997" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-df28576c-005c-44a2-b0ba-0878f839f1f4" class="xr-var-data-in" type="checkbox"><label for="data-df28576c-005c-44a2-b0ba-0878f839f1f4" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.90132524, 0.90132524, 0.90132524, ..., 0.90132524, 0.90132524,
        0.90132524],
       [0.85056648, 0.85056648, 0.85056648, ..., 0.85056648, 0.85056648,
        0.85056648],
       [0.8742606 , 0.8742606 , 0.8742606 , ..., 0.8742606 , 0.8742606 ,
        0.8742606 ],
       [0.97663897, 0.97663897, 0.97663897, ..., 0.97663897, 0.97663897,
        0.97663897]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>tree_depth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">2 2 3 2 2 2 2 2 ... 1 2 2 2 2 2 3 2</div><input id="attrs-240f7645-11bc-407c-8b62-3c2c11e569ee" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-240f7645-11bc-407c-8b62-3c2c11e569ee" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f39446c1-4651-415c-973e-3fbb731592ab" class="xr-var-data-in" type="checkbox"><label for="data-f39446c1-4651-415c-973e-3fbb731592ab" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2, 2, 3, ..., 2, 3, 2],
       [2, 3, 2, ..., 2, 2, 2],
       [3, 2, 2, ..., 2, 2, 2],
       [2, 3, 2, ..., 2, 3, 2]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-516481b8-2011-455d-b8c9-ac6b0a9fc637" class="xr-section-summary-in" type="checkbox"><label for="section-516481b8-2011-455d-b8c9-ac6b0a9fc637" class="xr-section-summary">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-9c090883-279e-48c6-b8ca-9209c438258b" class="xr-index-data-in" type="checkbox"><label for="index-9c090883-279e-48c6-b8ca-9209c438258b" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-dbaf739a-1e45-470e-b414-026f2a12b889" class="xr-index-data-in" type="checkbox"><label for="index-dbaf739a-1e45-470e-b414-026f2a12b889" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-7a9c2242-c0f4-47fa-9562-c025764b4f39" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-7a9c2242-c0f4-47fa-9562-c025764b4f39" class="xr-section-summary">Attributes: <span>(8)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-07-22T17:18:32.816106+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>sampling_time :</span></dt><dd>3.6786086559295654</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_observed_datae1878a16-0114-469a-a158-0a0644e22e04" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_observed_datae1878a16-0114-469a-a158-0a0644e22e04" class="xr-section-summary">observed_data</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 13kB
Dimensions:       (Longitud_obs: 796)
Coordinates:
  * Longitud_obs  (Longitud_obs) int64 6kB 0 1 2 3 4 5 ... 791 792 793 794 795
Data variables:
    Longitud      (Longitud_obs) float64 6kB 49.19 51.22 51.22 ... 97.35 94.19
Attributes:
    created_at:                  2024-07-22T17:18:32.822410+00:00
    arviz_version:               0.19.0
    inference_library:           pymc
    inference_library_version:   5.15.1
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-88f50c75-1bef-4aa0-a051-396d7ca9e664" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-88f50c75-1bef-4aa0-a051-396d7ca9e664" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">Longitud_obs</span>: 796</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-702e123e-3b6e-4c4f-8e97-5d592920cfe8" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-702e123e-3b6e-4c4f-8e97-5d592920cfe8" class="xr-section-summary">Coordinates: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">Longitud_obs</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 791 792 793 794 795</div><input id="attrs-78bd5fee-7b61-442f-9943-1fd3e5e02513" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-78bd5fee-7b61-442f-9943-1fd3e5e02513" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-52b3385a-daa9-4c67-adcf-f18b8fbf3f08" class="xr-var-data-in" type="checkbox"><label for="data-52b3385a-daa9-4c67-adcf-f18b8fbf3f08" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 793, 794, 795])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-6dcff14d-4d30-4daf-a4ce-1d8d4af7fa2d" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-6dcff14d-4d30-4daf-a4ce-1d8d4af7fa2d" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>Longitud</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">49.19 51.22 51.22 ... 97.35 94.19</div><input id="attrs-a93b942f-d2db-4135-a793-e8bfa8e99927" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a93b942f-d2db-4135-a793-e8bfa8e99927" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f12019ec-e14f-46f5-b50f-c9cc6bf6cb33" class="xr-var-data-in" type="checkbox"><label for="data-f12019ec-e14f-46f5-b50f-c9cc6bf6cb33" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([49.19285714, 51.22142857, 51.22142857, 52.74285714, 48.17857143,
       49.7       , 46.15      , 49.19285714, 50.71428571, 48.17857143,
       50.20714286, 49.7       , 50.20714286, 49.19285714, 49.19285714,
       49.7       , 50.71428571, 48.68571429, 50.20714286, 50.20714286,
       52.23571429, 49.7       , 49.19285714, 53.75714286, 46.15      ,
       52.23571429, 51.72857143, 48.17857143, 52.23571429, 50.71428571,
       49.19285714, 47.67142857, 51.22142857, 48.68571429, 47.67142857,
       49.19285714, 49.19285714, 50.20714286, 49.7       , 52.23571429,
       51.22142857, 49.7       , 48.17857143, 52.23571429, 51.72857143,
       55.27857143, 50.71428571, 53.25      , 52.09239497, 52.9773925 ,
       52.15931415, 54.79551317, 55.88960402, 56.15775148, 56.71321613,
       56.14531822, 54.27152775, 53.18845079, 51.58980471, 56.52740991,
       54.27041965, 53.90327795, 56.31186537, 52.85389383, 56.2498965 ,
       55.3230851 , 52.96168533, 54.83012442, 56.90657333, 56.1674208 ,
       57.87042139, 55.03640928, 61.33037799, 52.78255116, 53.94307754,
       54.84143382, 51.75248234, 56.48636007, 56.19388644, 54.60045215,
       53.89607373, 56.1067215 , 61.39098782, 60.03948235, 59.12081467,
       59.47145582, 56.87930169, 57.01821414, 55.0298334 , 57.57946143,
       59.89906647, 57.77073394, 56.61548298, 57.92039996, 59.38318439,
       57.60909694, 59.98242783, 55.18881162, 56.40744072, 56.98018785,
...
       82.65200072, 84.37440979, 91.3085265 , 79.96338712, 81.61261347,
       84.29581338, 88.81517149, 80.29882513, 77.40305079, 87.23796829,
       84.06027194, 91.38395098, 89.59787794, 91.62079733, 92.81936454,
       92.24137361, 76.43942909, 77.71863214, 88.55951887, 88.96395213,
       77.95509383, 82.74625965, 91.23181564, 92.76141866, 85.54573872,
       89.36846664, 89.10512726, 90.92382869, 90.97831844, 85.31646661,
       83.2178514 , 82.74694287, 84.24183082, 88.53873707, 84.24292413,
       77.67609253, 91.9678806 , 91.14871479, 84.65728687, 97.43958338,
       86.3573666 , 90.30806077, 86.76620237, 78.94318283, 89.86260498,
       86.70593948, 92.2386928 , 86.73034187, 81.02343959, 90.37105389,
       80.49576392, 85.51492889, 91.65871132, 88.5279465 , 94.06219176,
       87.13126778, 82.14414651, 83.48512537, 84.1944379 , 90.25150091,
       85.40245169, 84.7221104 , 74.23082134, 92.32109173, 85.30380521,
       86.94866672, 88.17681991, 79.07148226, 87.27725659, 93.07974128,
       87.50474804, 78.82336361, 88.3197443 , 89.21055719, 85.10846706,
       87.99056523, 84.5124126 , 87.9681095 , 83.8704532 , 89.92279315,
       89.15198916, 87.85582658, 83.9765828 , 94.82978854, 89.38589518,
       94.6727304 , 75.4419031 , 95.4900717 , 96.4306434 , 84.42186434,
       86.15102724, 83.64517681, 81.13556856, 90.92918567, 97.35113965,
       94.193379  ])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-3eabd10b-aba7-4a2a-a4d5-e65a1b747d43" class="xr-section-summary-in" type="checkbox"><label for="section-3eabd10b-aba7-4a2a-a4d5-e65a1b747d43" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>Longitud_obs</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-3e653f52-2902-467c-8644-949d617823c6" class="xr-index-data-in" type="checkbox"><label for="index-3e653f52-2902-467c-8644-949d617823c6" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       786, 787, 788, 789, 790, 791, 792, 793, 794, 795],
      dtype='int64', name='Longitud_obs', length=796))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-aeaed810-8703-4658-b1d6-15e01926b46e" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-aeaed810-8703-4658-b1d6-15e01926b46e" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-07-22T17:18:32.822410+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
              </ul>
            </div>
            <style> /* CSS stylesheet for displaying InferenceData objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-sections.group-sections {
  grid-template-columns: auto;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
.xr-wrap{width:700px!important;} </style>
</div>
</div>
<div id="7e83edaf" class="cell" data-execution_count="71">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a>ref <span class="op">=</span> <span class="fl">52.5</span></span>
<span id="cb100-2"><a href="#cb100-2"></a>y_ppc <span class="op">=</span> idata_dis.posterior_predictive[<span class="st">"Longitud"</span>].stack(sample<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb100-3"><a href="#cb100-3"></a>grid, pdf <span class="op">=</span> az.stats.density_utils._kde_linear(y_ppc.values)</span>
<span id="cb100-4"><a href="#cb100-4"></a>plt.plot(grid, pdf)</span>
<span id="cb100-5"><a href="#cb100-5"></a>percentile <span class="op">=</span> <span class="bu">int</span>((y_ppc <span class="op">&lt;=</span> ref).mean() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb100-6"><a href="#cb100-6"></a>plt.fill_between(</span>
<span id="cb100-7"><a href="#cb100-7"></a>    grid[grid <span class="op">&lt;</span> ref],</span>
<span id="cb100-8"><a href="#cb100-8"></a>    pdf[grid <span class="op">&lt;</span> ref],</span>
<span id="cb100-9"><a href="#cb100-9"></a>    label<span class="op">=</span><span class="st">"percentil = </span><span class="sc">{:2d}</span><span class="st">"</span>.<span class="bu">format</span>(percentile),</span>
<span id="cb100-10"><a href="#cb100-10"></a>    color<span class="op">=</span><span class="st">"C1"</span>,</span>
<span id="cb100-11"><a href="#cb100-11"></a>)</span>
<span id="cb100-12"><a href="#cb100-12"></a>plt.xlabel(<span class="st">"Longitud"</span>)</span>
<span id="cb100-13"><a href="#cb100-13"></a>plt.yticks([])</span>
<span id="cb100-14"><a href="#cb100-14"></a>plt.legend()<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-72-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="predictores-categóricos" class="level2" data-number="5.19">
<h2 data-number="5.19" class="anchored" data-anchor-id="predictores-categóricos"><span class="header-section-number">5.19</span> Predictores Categóricos</h2>
<p>Una variable categórica representa distintos grupos o categorías. La variable solo puede tomar un conjunto limitado de valores de esas categorías. Estos valores suelen ser etiquetas o nombres que no poseen significado numérico por sí solos. Algunos ejemplos son:</p>
<ul>
<li>Afiliación política: conservadora, liberal o progresista.</li>
<li>Sexo: femenino o masculino.</li>
<li>Nivel de satisfacción del cliente: muy insatisfecho, insatisfecho, neutral, satisfecho o muy satisfecho.</li>
</ul>
<p>Los modelos de regresión lineal pueden acomodar fácilmente variables categóricas, solo necesitamos codificar las categorías como números. Hay algunas opciones para hacerlo. Bambi puede manejar fácilmente los detalles por nosotros. El diablo está en los detalles de como interpretamos los resultados.</p>
<section id="pingüinos-categóricos" class="level3" data-number="5.19.1">
<h3 data-number="5.19.1" class="anchored" data-anchor-id="pingüinos-categóricos"><span class="header-section-number">5.19.1</span> Pingüinos Categóricos</h3>
<p>Para el ejemplo actual, vamos a utilizar el conjunto de datos de <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0090081">Palmer Penguins</a>, que contiene 344 observaciones de 8 variables. Por el momento nos interesa modelar la masa de los pingüinos en función de la longitud de su pico. Se espera que la masa de los pingüinos aumente a medida que aumenta la longitud del pico. La novedad de este ejemplo es que vamos a considerar la variable categórica, <code>species</code>. Esta variable tiene 3 categorías o niveles, a saber, <code>Adelie</code>, <code>Chinstrap</code> y <code>Gentoo</code>. La <a href="#fig-scatter_pen" class="quarto-xref">Figura&nbsp;<span>5.1</span></a> muestra un diagrama de dispersión para las variables que queremos modelar.</p>
<div id="3c51576d" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1"></a>penguins <span class="op">=</span> pd.read_csv(<span class="st">"datos/penguins.csv"</span>).dropna()</span>
<span id="cb101-2"><a href="#cb101-2"></a>penguins.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">species</th>
<th data-quarto-table-cell-role="th">island</th>
<th data-quarto-table-cell-role="th">bill_length</th>
<th data-quarto-table-cell-role="th">bill_depth</th>
<th data-quarto-table-cell-role="th">flipper_length</th>
<th data-quarto-table-cell-role="th">body_mass</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>3.91</td>
<td>1.87</td>
<td>18.1</td>
<td>3.75</td>
<td>male</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>3.95</td>
<td>1.74</td>
<td>18.6</td>
<td>3.80</td>
<td>female</td>
<td>2007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>4.03</td>
<td>1.80</td>
<td>19.5</td>
<td>3.25</td>
<td>female</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>3.67</td>
<td>1.93</td>
<td>19.3</td>
<td>3.45</td>
<td>female</td>
<td>2007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>3.93</td>
<td>2.06</td>
<td>19.0</td>
<td>3.65</td>
<td>male</td>
<td>2007</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-fig-scatter_pen" class="cell" data-execution_count="73">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1"></a><span class="co"># Get unique categories</span></span>
<span id="cb102-2"><a href="#cb102-2"></a>unique_categories <span class="op">=</span> np.unique(penguins.species)</span>
<span id="cb102-3"><a href="#cb102-3"></a></span>
<span id="cb102-4"><a href="#cb102-4"></a><span class="co"># Create color map for categories</span></span>
<span id="cb102-5"><a href="#cb102-5"></a>category_color_map <span class="op">=</span> {cat: <span class="ss">f"C</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i, cat <span class="kw">in</span> <span class="bu">enumerate</span>(unique_categories)}</span>
<span id="cb102-6"><a href="#cb102-6"></a></span>
<span id="cb102-7"><a href="#cb102-7"></a><span class="co"># Generate colors for each category</span></span>
<span id="cb102-8"><a href="#cb102-8"></a>colors <span class="op">=</span> [category_color_map[cat] <span class="cf">for</span> cat <span class="kw">in</span> penguins.species]</span>
<span id="cb102-9"><a href="#cb102-9"></a></span>
<span id="cb102-10"><a href="#cb102-10"></a><span class="co"># Create scatter plot for each category</span></span>
<span id="cb102-11"><a href="#cb102-11"></a><span class="cf">for</span> cat <span class="kw">in</span> unique_categories:</span>
<span id="cb102-12"><a href="#cb102-12"></a>    category_data <span class="op">=</span> penguins[penguins.species <span class="op">==</span> cat]</span>
<span id="cb102-13"><a href="#cb102-13"></a>    plt.scatter(category_data.body_mass, category_data.bill_length, c<span class="op">=</span>category_color_map[cat], label<span class="op">=</span>cat)</span>
<span id="cb102-14"><a href="#cb102-14"></a></span>
<span id="cb102-15"><a href="#cb102-15"></a><span class="co"># Add labels and legend</span></span>
<span id="cb102-16"><a href="#cb102-16"></a>plt.ylabel(<span class="st">"Body mass (g)"</span>)</span>
<span id="cb102-17"><a href="#cb102-17"></a>plt.xlabel(<span class="st">"Bill length (mm)"</span>)</span>
<span id="cb102-18"><a href="#cb102-18"></a>plt.legend(labels<span class="op">=</span>unique_categories, loc<span class="op">=</span><span class="st">"lower right"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-scatter_pen" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter_pen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05_GLMS_files/figure-html/fig-scatter_pen-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter_pen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.1: Largo del pico (bill_length) vs masa (body_mass) para 3 especies de pingüinos.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Para ajustar un modelo con variables categoricas no necesitamos de ninguna sintáxis especial</p>
<div id="a06e7d5a" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1"></a>modelo_p <span class="op">=</span> bmb.Model(<span class="st">"body_mass ~ bill_length + species"</span>, data<span class="op">=</span>penguins)</span>
<span id="cb103-2"><a href="#cb103-2"></a>idata_p <span class="op">=</span> modelo_p.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [body_mass_sigma, Intercept, bill_length, species]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"af3c01afb9a945aaababc9dd2f5fd723","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>La <a href="#fig-penguins_posterior" class="quarto-xref">Figura&nbsp;<span>5.2</span></a> muestra un forest plot para <code>model_p</code>. ¿Notás algo inesperado? No hay valores posteriores para <code>Adelie</code>. Esto no es un error. De forma predeterminada, Bambi codifica variables categóricas con <code>N</code> niveles (3 especies) como <code>N-1</code> variables (2 especies). Así, los coeficientes <code>species-Chinstrap</code> y <code>species-Gentoo</code> representan deflecciones del modelo base:</p>
<p><span class="math display">\[
\text{body\_mass} = \beta_0 + \beta_1 \text{bill\_length}
\]</span></p>
<div id="cell-fig-penguins_posterior" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1"></a>ax <span class="op">=</span> az.plot_forest(idata_p, combined<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">3</span>))</span>
<span id="cb105-2"><a href="#cb105-2"></a>mean_chinstrap <span class="op">=</span> idata_p.posterior[<span class="st">"species"</span>].sel(species_dim<span class="op">=</span><span class="st">"Chinstrap"</span>).mean()</span>
<span id="cb105-3"><a href="#cb105-3"></a>mean_gentoo <span class="op">=</span> idata_p.posterior[<span class="st">"species"</span>].sel(species_dim<span class="op">=</span><span class="st">"Gentoo"</span>).mean()</span>
<span id="cb105-4"><a href="#cb105-4"></a>ax[<span class="dv">0</span>].annotate(<span class="ss">f"</span><span class="sc">{</span>mean_chinstrap<span class="sc">.</span>item()<span class="sc">:.2f}</span><span class="ss">"</span>, (mean_chinstrap , <span class="fl">1.2</span>), weight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb105-5"><a href="#cb105-5"></a>ax[<span class="dv">0</span>].annotate(<span class="ss">f"</span><span class="sc">{</span>mean_gentoo<span class="sc">.</span>item()<span class="sc">:.2f}</span><span class="ss">"</span>, (mean_gentoo , <span class="fl">0.5</span>), weight<span class="op">=</span><span class="st">'bold'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-penguins_posterior" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-penguins_posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05_GLMS_files/figure-html/fig-penguins_posterior-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-penguins_posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.2: Fores plot para la distribución a posteriori de <code>modelo_p</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Para que esto quede más claro, revisemos un par de gráficos. Podemos leer la <a href="#fig-penguins_posterior" class="quarto-xref">Figura&nbsp;<span>5.2</span></a> como que la masa corporal de <code>Chinstrap</code> es en promedio -0.89 respecto de la masa corporal media de <code>Adelie</code>. Lo mismo ocurre con <code>Gentoo</code>, pero esta vez tenemos que agregar 0,66 a la media del modelo base. Podés comprobar que estas dos afirmaciones son verdaderas mirando la <a href="#fig-penguins_predictions" class="quarto-xref">Figura&nbsp;<span>5.3</span></a>. Observá cómo las 3 líneas son esencialmente paralelas entre sí con <code>Adelie</code> en el medio, <code>Chinstrap</code> debajo (-0,89) y <code>Gentoo</code> arriba (0,58).</p>
<div id="cell-fig-penguins_predictions" class="cell" data-execution_count="76">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1"></a>bmb.interpret.plot_predictions(modelo_p, idata_p, [<span class="st">"bill_length"</span>,  <span class="st">"species"</span>])<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-penguins_predictions" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-penguins_predictions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05_GLMS_files/figure-html/fig-penguins_predictions-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-penguins_predictions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.3: Predicciones del ajuste medio para <code>modelo_p</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="relación-con-modelos-jerárquicos" class="level3" data-number="5.19.2">
<h3 data-number="5.19.2" class="anchored" data-anchor-id="relación-con-modelos-jerárquicos"><span class="header-section-number">5.19.2</span> Relación con modelos jerárquicos</h3>
<p>En el <a href="03_Modelos_jerárquicos.html" class="quarto-xref"><span>Capítulo 3</span></a> analizamos y contrastamos los modelos agrupados y jerárquicos (o parcialmente agrupados). Allí mostramos que a menudo podemos aprovechar la estructura o las jerarquías de los datos. Siguiendo la lógica de ese capítulo, se podría argumentar que <code>Adelie</code>, <code>Gentoo</code> y <code>Chinstrap</code>, aunque son especies diferentes, son todos pingüinos. Por lo tanto, modelar jerárquicamente sus masas corporales puede ser una buena idea. Entonces, ¿Cuál es la diferencia entre dicho modelo y el que utilizamos en esta sección?</p>
<p>El factor distintivo reside en las sutilezas de los componentes de pendiente e intersección. En el caso de <code>model_p</code> (variables categóricos), la pendiente sigue siendo la misma en las tres especies de pingüinos, mientras que los interceptos pueden variar. <code>Intercept + 0</code> para <code>Adelie</code>, <code>Intercept + species[Chinstrap]</code> para Chinstrap, y <code>Intercept + species[Gentoo]</code> para <code>Gentoo</code>. Por lo tanto, este modelo resalta los distintos incerceptos manteniendo la pendiente uniforme.</p>
<p>Si, en cambio, hubiéramos construido el modelo jerárquico <code>body_mass ~ bill_length|species)</code>, habríamos estado pidiendo una pendiente y un intercepto parcialmente agrupados. Y si en lugar de eso hubiéramos modelado <code>body_mass ~ (0 + bill_length | specie)</code> habríamos estado pidiendo una pendiente parcialmente agrupada y un intercepto común.</p>
<p>Entonces, ¿Cuál es mejor modelo? Como siempre, depende, incluso en algunos casos podría ser mejor una combinación de ambos enfoques, ya que no son ideas mutuamente excluyentes. Como ya comentamos, el <em>mejor</em> modelo es el que se alinea con los objetivos de tu análisis y proporciona información útil. A menudo es una buena idea explorar múltiples modelos, comparar su desempeño usando criterios apropiados (como los discutidos en el <span class="quarto-unresolved-ref">?sec-model_comparison</span> y considerar las implicaciones prácticas de cada modelo en el contexto de la investigación o proceso de toma de decisiones.</p>
</section>
</section>
<section id="interacciones" class="level2" data-number="5.20">
<h2 data-number="5.20" class="anchored" data-anchor-id="interacciones"><span class="header-section-number">5.20</span> Interacciones</h2>
<p>Un efecto de interacción o interacción estadística, ocurre cuando el efecto de una variable independiente sobre la respuesta cambia dependiendo del valor de otra variable independiente en el mismo modelo. Una interacción puede ocurrir entre dos o más variables. Algunos ejemplos son:</p>
<ul>
<li>Eficacia de los medicamentos y edad: un medicamento que funciona mejor en personas mayores que en personas más jóvenes</li>
<li>Nivel de educación e impacto en los ingresos: Es posible que la educación superior tenga un efecto positivo más fuerte en los ingresos de un género en comparación con el otro, lo que resulta en una interacción entre la educación y el género.</li>
<li>Efectos del ejercicio y la dieta sobre la pérdida de peso: Podría ser que el efecto de la dieta sobre la pérdida de peso sea pequeño para las personas que hacen nada o poco ejercicio y muy importante para las personas que hacen ejercicio moderado.</li>
<li>Temperatura y humedad para el crecimiento de los cultivos: El efecto de la temperatura y la humedad en el crecimiento de los cultivos puede depender del tipo de cultivo que se esté cultivando. Algunos cultivos podrían prosperar en condiciones cálidas y húmedas, mientras que otros podrían funcionar mejor en ambientes más fríos y menos húmedos, creando una interacción entre temperatura, humedad y tipo de cultivo.</li>
</ul>
<p>Tenemos una interacción cuando el efecto combinado de dos o más variables actuando conjuntamente no es igual a la suma de sus efectos individuales. Si tenemos un modelo como</p>
<p><span class="math display">\[
\mu = \alpha + \beta_0 X_0 + \beta_1 X_1
\]</span></p>
<p>no podemos modelar un interacción, ya que los efectos son aditivos. La forma más común de modelar una interacción es multiplicando 2 o más variables. Por ejemplo en un modelo como:</p>
<p><span class="math display">\[
\mu = \alpha + \overbrace{\beta_0 X_0 + \beta_1 X_1 }^{\text{término principal}} \; + \underbrace{\beta_3 X_0X_1}_{\text{término de interacción}}
\]</span></p>
<p>Es común que al modelar una interacción se incluya también el término principal.</p>
<blockquote class="blockquote">
<p>Multiplicar dos variables puede verse como un truco similar al que usamos para la regresión polinómica (o cualquier transformación de una variable determinada). En lugar de multiplicar un predictor consigo mismo, multiplicamos dos predictores diferentes y obtenemos uno nuevo.</p>
</blockquote>
<p>Definir una interacción es fácil; para un modelo PyMC, solo necesitamos multiplicar los dos predictores y agregar un coeficiente más al modelo. Para un modelo de Bambi es aún más fácil, usamos el operador <code>:</code>. Veamos un ejemplo de un modelo con y sin interacciones.</p>
<div id="91c52e86" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a><span class="co"># Sin interacción</span></span>
<span id="cb107-2"><a href="#cb107-2"></a>model_noint <span class="op">=</span> bmb.Model(<span class="st">"body_mass ~ bill_depth + bill_length"</span>, data<span class="op">=</span>penguins)</span>
<span id="cb107-3"><a href="#cb107-3"></a>idata_noint <span class="op">=</span> model_noint.fit()</span>
<span id="cb107-4"><a href="#cb107-4"></a></span>
<span id="cb107-5"><a href="#cb107-5"></a><span class="co"># Con interacción</span></span>
<span id="cb107-6"><a href="#cb107-6"></a>model_int <span class="op">=</span> bmb.Model(<span class="st">"body_mass ~ bill_depth + bill_length + bill_depth:bill_length"</span>, data<span class="op">=</span>penguins)</span>
<span id="cb107-7"><a href="#cb107-7"></a>idata_int <span class="op">=</span> model_int.fit()                </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [body_mass_sigma, Intercept, bill_depth, bill_length]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.
Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [body_mass_sigma, Intercept, bill_depth, bill_length, bill_depth:bill_length]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 14 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"aa627321993640ddbe54adf09d7951e5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"194e66551cb64b6fbc39b97414f0e1f5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>En la <a href="#fig-interaction_vs_noninteraction" class="quarto-xref">Figura&nbsp;<span>5.4</span></a> tenemos el ajuste de regresión media para <code>bill_depth</code> evaluado en 5 valores fijos de <code>bill_length</code>. A la izquierda tenemos el resultado para <code>model_noint</code> (sin interacciones) y a la derecha para <code>model_int</code> (con interacciones). Podemos ver que cuando no tenemos interacciones las rectas ajustadas para <code>bill_ depth</code> son paralelas en diferentes niveles de <code>bill_length</code>. En cambio, cuando tenemos interacciones las rectas ya no son paralelas, precisamente porque el efecto de cambiar <code>bill_depth</code> sobre cuánto cambia <code>body_mass</code> ya no es constante sino que está modulado por los valores de <code>bill_length</code>. Si generás una figura como <a href="#fig-interaction_vs_noninteraction" class="quarto-xref">Figura&nbsp;<span>5.4</span></a>, pero fijando <code>bill_depth</code> en vez de <code>bill_length</code> observarás un fenómeno parecido.</p>
<div id="cell-fig-interaction_vs_noninteraction" class="cell" data-execution_count="78">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="fl">4.5</span>), gridspec_kw<span class="op">=</span>{<span class="st">'hspace'</span>: <span class="fl">0.1</span>})</span>
<span id="cb109-2"><a href="#cb109-2"></a></span>
<span id="cb109-3"><a href="#cb109-3"></a>bmb.interpret.plot_predictions(model_noint, idata_noint,</span>
<span id="cb109-4"><a href="#cb109-4"></a>                                [<span class="st">"bill_depth"</span>,  <span class="st">"bill_length"</span>],</span>
<span id="cb109-5"><a href="#cb109-5"></a>                                ax<span class="op">=</span>axes[<span class="dv">0</span>],</span>
<span id="cb109-6"><a href="#cb109-6"></a>                                legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb109-7"><a href="#cb109-7"></a>                                )</span>
<span id="cb109-8"><a href="#cb109-8"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"Sin interacción"</span>)</span>
<span id="cb109-9"><a href="#cb109-9"></a></span>
<span id="cb109-10"><a href="#cb109-10"></a></span>
<span id="cb109-11"><a href="#cb109-11"></a>bmb.interpret.plot_predictions(model_int, idata_int,</span>
<span id="cb109-12"><a href="#cb109-12"></a>                               [<span class="st">"bill_depth"</span>,  <span class="st">"bill_length"</span>],</span>
<span id="cb109-13"><a href="#cb109-13"></a>                                ax<span class="op">=</span>axes[<span class="dv">1</span>],</span>
<span id="cb109-14"><a href="#cb109-14"></a>                                )</span>
<span id="cb109-15"><a href="#cb109-15"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"Con interacción"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-interaction_vs_noninteraction" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interaction_vs_noninteraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05_GLMS_files/figure-html/fig-interaction_vs_noninteraction-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interaction_vs_noninteraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.4: Comparación de un modelo sin interacción (las lineas se mantienen paralelas) y con interacción (las lineas se cruzan).
</figcaption>
</figure>
</div>
</div>
</div>
<p>Acabamos de ver visualmente que interpretar modelos lineales con interacciones no es tan fácil como interpretar modelos lineales sin ellas. Veamos esto matemáticamente.</p>
<p>Supongamos que tenemos un modelo con 2 variables <span class="math inline">\(X_0\)</span> y <span class="math inline">\(X_1\)</span> y una interacción entre ellas:</p>
<p><span class="math display">\[
     \mu = \alpha + \beta_0 X_0 + \beta_1 X_1 + \beta_3 X_0X_1
\]</span></p>
<p>podemos reescribir este modelo como:</p>
<p><span class="math display">\[
\mu = \alpha + \underbrace{{(\beta_0 + \beta_2} X_1)}_{\text{pendiente de } X_0} X_0 + \beta_1 X_1
\]</span></p>
<p>o así:</p>
<p><span class="math display">\[
\mu = \alpha + \beta_0 X_0 + \underbrace{(\beta_1 + \beta_2 x_0)}_{\text{pendiente de } X_1} X_1
\]</span></p>
<p>A partir de esta expresión podemos ver que:</p>
<ul>
<li>¡El término de interacción puede entenderse como un modelo lineal dentro de un modelo lineal!</li>
<li>La interacción es simétrica; podemos pensar en ello como la pendiente de <span class="math inline">\(x_0\)</span> en función de <span class="math inline">\(x_1\)</span> y al mismo tiempo como la pendiente de <span class="math inline">\(x_1\)</span> en función de <span class="math inline">\(x_0\)</span>. Esto también se puede ver en la figura interactiva.</li>
<li>Sabemos desde antes que el coeficiente <span class="math inline">\(\beta_0\)</span> se puede interpretar como la cantidad de cambio de <span class="math inline">\(\mu\)</span> por unidad de cambio de <span class="math inline">\(x_0\)</span> (por eso lo llamamos pendiente). Si agregamos un término de interacción, entonces esto solo es cierto en <span class="math inline">\(x_1 = 0\)</span>. Intente utilizar la figura interactiva para verlo usted mismo. Matemáticamente, esto es cierto porque cuando <span class="math inline">\(x_1 = 0\)</span> entonces <span class="math inline">\(\beta_2x_1 = 0\)</span>, y por lo tanto la pendiente de <span class="math inline">\(x_0\)</span> se reduce a <span class="math inline">\(\beta_0 x_0\)</span>. Por simetría, el mismo razonamiento se puede aplicar a <span class="math inline">\(\beta_1\)</span>.</li>
</ul>
</section>
<section id="interpretando-modelos-con-bambi" class="level2" data-number="5.21">
<h2 data-number="5.21" class="anchored" data-anchor-id="interpretando-modelos-con-bambi"><span class="header-section-number">5.21</span> Interpretando modelos con Bambi</h2>
<p>Ya hemos usado <code>bmb.interpret_plot_predictions</code> en este capítulo. Pero esa no es la única herramienta que nos ofrece Bambi para ayudarnos a comprender los modelos. Otra opción es <code>bmb.interpret_plot_comparisons</code>. Esta herramienta nos ayuda a responder la pregunta: ¿Cuál es la diferencia predictiva esperada cuando comparamos dos valores de una variable determinada mientras mantenemos el resto en valores constantes?</p>
<p>Como ejemplo usemos <code>model_int</code>, que ya ajustamos en la sección anterior.</p>
<div id="cell-fig-interaction_comparisons" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1"></a>bmb.interpret.plot_comparisons(model_int, idata_int,</span>
<span id="cb110-2"><a href="#cb110-2"></a>                               contrast<span class="op">=</span>{<span class="st">"bill_depth"</span>:[<span class="fl">1.4</span>, <span class="fl">1.8</span>]},</span>
<span id="cb110-3"><a href="#cb110-3"></a>                               conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-interaction_comparisons" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interaction_comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05_GLMS_files/figure-html/fig-interaction_comparisons-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interaction_comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.5: Contraste de para <code>bill_length</code> de 1,8 a 1,4 cm para 3 valores fijos de <code>bill_length</code>, 3.5, 4.5 y 5.5.
</figcaption>
</figure>
</div>
</div>
</div>
<p>La figura anterior muestra que al comparar un pingüino hipotético con profundidad de pico (<code>bill_depth</code>) de 1,8 con uno con profundida de pico de 1,4, la diferencia esperada es:</p>
<ul>
<li>aproximadamente 0,8 kg para un pico de 3,5 de longitud</li>
<li>-0,7 kg para un pico de 4,5 de largo</li>
<li>aproximadamente -2 kg para un pico de 5,5 de largo</li>
</ul>
<p>Para obtener esta misma información, pero en forma de tabla podemos usar la función <code>bmb.interpret.comparisons</code> y obtendremos un DataFrame de Pandas.</p>
<div id="55ffd410" class="cell" data-execution_count="80">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1"></a>bmb.interpret.comparisons(model_int, idata_int,</span>
<span id="cb111-2"><a href="#cb111-2"></a>                          contrast<span class="op">=</span>{<span class="st">"bill_depth"</span>:[<span class="fl">1.4</span>, <span class="fl">1.8</span>]},</span>
<span id="cb111-3"><a href="#cb111-3"></a>                          conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="80">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">term</th>
<th data-quarto-table-cell-role="th">estimate_type</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">bill_length</th>
<th data-quarto-table-cell-role="th">estimate</th>
<th data-quarto-table-cell-role="th">lower_3.0%</th>
<th data-quarto-table-cell-role="th">upper_97.0%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>bill_depth</td>
<td>diff</td>
<td>(1.4, 1.8)</td>
<td>3.5</td>
<td>0.768417</td>
<td>0.498433</td>
<td>1.035196</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>bill_depth</td>
<td>diff</td>
<td>(1.4, 1.8)</td>
<td>4.5</td>
<td>-0.566772</td>
<td>-0.674116</td>
<td>-0.455068</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>bill_depth</td>
<td>diff</td>
<td>(1.4, 1.8)</td>
<td>5.5</td>
<td>-1.901961</td>
<td>-2.178738</td>
<td>-1.664387</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Otra función muy útil es Otra función útil es <code>bmb.interpret_plot_slopes</code>. Esta función es similar a <code>bmb.interpret_plot_comparison</code>, la “tasa de cambio instantánea” o pendiente en un valor dado.</p>
<div id="cell-fig-interaction_slopes" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1"></a>bmb.interpret.plot_slopes(model_int, idata_int,</span>
<span id="cb112-2"><a href="#cb112-2"></a>                          wrt<span class="op">=</span>{<span class="st">"bill_depth"</span>:<span class="fl">1.8</span>},</span>
<span id="cb112-3"><a href="#cb112-3"></a>                          conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-interaction_slopes" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interaction_slopes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05_GLMS_files/figure-html/fig-interaction_slopes-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interaction_slopes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.6: Comparación de las pendientes de bill_depth evaluada en 1.8 para tres valores de <code>bill_length</code>, 3.5, 4.5 y 5.5.
</figcaption>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-interaction_slopes" class="quarto-xref">Figura&nbsp;<span>5.6</span></a> muestra que las pendientes para <code>bill_depth</code> en 1.8 son:</p>
<ul>
<li><span class="math inline">\(\approx\)</span> 2 kg/cm para un largo de pico de 3.5</li>
<li>-1.4 kg/cm para un largo de pico de 4.5</li>
<li><span class="math inline">\(\approx\)</span> -5 kg/cm para un largo de pico de 5.5</li>
</ul>
<p>Si deseas esta información en forma tabular, podés usar: la función <code>bmb.interpret.slopes</code> y obtendrás un DataFrame en lugar de un gráfico.</p>
<div id="825b77b5" class="cell" data-execution_count="82">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1"></a>bmb.interpret.slopes(model_int, idata_int,</span>
<span id="cb113-2"><a href="#cb113-2"></a>                     wrt<span class="op">=</span>{<span class="st">"bill_depth"</span>:<span class="fl">1.8</span>},</span>
<span id="cb113-3"><a href="#cb113-3"></a>                     conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="82">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">term</th>
<th data-quarto-table-cell-role="th">estimate_type</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">bill_length</th>
<th data-quarto-table-cell-role="th">estimate</th>
<th data-quarto-table-cell-role="th">lower_3.0%</th>
<th data-quarto-table-cell-role="th">upper_97.0%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>bill_depth</td>
<td>dydx</td>
<td>(1.8, 1.8001)</td>
<td>3.5</td>
<td>1.921043</td>
<td>1.246082</td>
<td>2.587990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>bill_depth</td>
<td>dydx</td>
<td>(1.8, 1.8001)</td>
<td>4.5</td>
<td>-1.416930</td>
<td>-1.685290</td>
<td>-1.137671</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>bill_depth</td>
<td>dydx</td>
<td>(1.8, 1.8001)</td>
<td>5.5</td>
<td>-4.754903</td>
<td>-5.446846</td>
<td>-4.160967</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>En esta sección, apenas hemos arañado la superficie de lo que podemos hacer con las herramientas del módulo <code>bmb.interpret</code>. Este módulo es una característica muy útil de Bambi, especialmente para modelos con interacciones y/o modelos con funciones de enlace distintas a la función de identidad. Les recomiendo que lea la <a href="https://bambinos.github.io/bambi/notebooks/#tools-to-interpret-model-outputs">documentación</a> de Bambi para obtener más ejemplos y detalles que no se tratan aquí.</p>
</section>
<section id="selección-de-variables" class="level2" data-number="5.22">
<h2 data-number="5.22" class="anchored" data-anchor-id="selección-de-variables"><span class="header-section-number">5.22</span> Selección de Variables</h2>
<p>La selección de variables se refiere al proceso de identificar las variables más relevantes en un modelo a partir de un conjunto más amplio de predictores. Realizamos la selección de variables bajo el supuesto de que sólo un subconjunto de variables tiene un impacto considerable en el resultado de interés, mientras que otras aportan poco o ningún valor adicional.</p>
<p>Podría decirse que “lo más bayesiano que se puede hacer” al construir un modelo es incluir todas las variables que podamos pensar en un solo modelo y luego usar la distribución a posteriori de ese modelo para hacer predicciones o comprender las relaciones de las variables. Este es el enfoque “más bayesiano” porque utilizamos la mayor cantidad de datos posible e incorporamos en la distribución a posteriori la incertidumbre sobre la importancia de las variables. Sin embargo, ser <em>más bayesiano que Bayes</em> no siempre es la mejor idea.</p>
<p>Realizar selección de variables es una buena idea cuando:</p>
<ul>
<li><p>Necesitamos reducir el costo de medición. Por ejemplo, en medicina, es posible que tengamos el dinero y los recursos para realizar un estudio piloto y medir 30 variables para 200 pacientes. Pero no podemos hacer lo mismo con miles de personas. O tal vez podamos colocar muchos sensores en un campo para modelar el rinde de un cultivo, pero no podemos extender eso mismo al tamaño de toda una región productiva. Reducir costos no siempre es cuestión de dinero o tiempo. Cuando se trabaja con humanos u otros animales, también es importante reducir el dolor y la incomodidad.</p></li>
<li><p>Queremos reducir el costo computacional. Esto no es un problema para modelos pequeños y simples, pero cuando tenemos muchas variables, muchos datos o ambos, el costo computacional puede ser prohibitivo.</p></li>
<li><p>Buscamos una mejor comprensión de las estructuras de correlación significativas. Es decir, nos interesa entender qué variables proporcionan mejores predicciones. Es importante aclarar que no estamos hablando de causalidad. Si bien los modelos estadísticos, en particular los GLMS, pueden usarse para inferir causalidad, hacerlo requiere pasos y suposiciones adicionales. En este curso no discutimos cómo realizar inferencia causal. Para obtener una introducción muy sencilla a la inferencia causal, consulte <a href="https://www.youtube.com/watch?v=gV6wzTk3o1U">este vídeo</a>. O si su inteŕes es más serio, puede consultar el libro en <a href="https://mixtape.scunning.com/">Causal Inference</a>: The Mixtape de Scott Cunningham. También el paquete <a href="https://github.com/pymc-labs/CausalPy">CausalPy</a></p></li>
<li><p>Cuando deseamos un modelo que sea más robusto a los cambios en la distribución generadora de datos, podemos ver la selección de variables como un método para hacer que el modelo sea más robusto frente a datos no representativos.</p></li>
</ul>
</section>
<section id="inferencia-predictiva-por-proyección" class="level2" data-number="5.23">
<h2 data-number="5.23" class="anchored" data-anchor-id="inferencia-predictiva-por-proyección"><span class="header-section-number">5.23</span> Inferencia predictiva por proyección</h2>
<p>Existen muchos métodos para realizar selección de variables. En esta sección, nos centraremos en uno de ellos llamado inferencia predictiva por proyección . La razón principal por la que nos centramos en este método es que ha mostrado un rendimiento muy bueno en una amplia gama de problemas.</p>
<p>Los principales pasos de la inferencia predictiva por proyección son:</p>
<ul>
<li>Generar un modelo de referencia, es decir, un modelo con todas las variables que creas que pueden ser relevantes y/o pudiste medir.</li>
<li>Generar un conjunto de submodelos, es decir, modelos que solo incluyen algún subconjunto de las variables presentens en el modelo de referencia.</li>
<li>Eligir el modelo más pequeño que haga predicciones lo suficientemente cercanas al modelo de referencia.</li>
</ul>
<p>Al realizar inferencia predictiva por proyección, solo necesitamos realizar la inferencia Bayesiana “tradicional” una sola vez, solo para el modelo de referencia. Para los submodelos, las distribuciones a psoteriori se obtienen por proyección. Sin entrar en detalles técnicos, la proyección consiste en encontrar los parámetros para los submodelos de tal forma que las predicciones de los submodelos sean lo más cercanas posible a las predicciones del modelo de referencia. La proyección se puede realizar de una manera computacionalmente eficiente, por lo que el costo de estimar un posterior es mucho más económico que con los métodos MCMC. Esto es relevante porque el número total de submodelos posibles explota a medida que aumentamos el número de variables en el modelo de referencia. Considere que necesitamos evaluar todas las combinaciones posibles, sin repetir variables. Por ejemplo, digamos que tenemos cuatro variables (<span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span> y <span class="math inline">\(D\)</span>) y necesitamos evaluar 7 modelos, a saber, <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(AB\)</span>, <span class="math inline">\(BC\)</span>, <span class="math inline">\(AC\)</span> y el modelo de referencia <span class="math inline">\(ABC\)</span>. Siete no parece mucho, pero cuando tengamos 8 variables, necesitaremos evaluar 92 modelos diferentes. Duplicamos la cantidad de variables y la cantidad de modelos aumentó más de 10 veces!</p>
<p>Por supuesto, hay formas de reducir el número total de submodelos a explorar. Por ejemplo, podríamos utilizar algún método económico para filtrar las variables más prometedoras y solo hacer inferencias predictivas de proyección sobre ellas. Otra alternativa se conoce como búsqueda directa; es decir, primero ajustamos tantos modelos como variables tenemos. Luego seleccionamos un modelo/variable, el que genera las predicciones más cercanas al modelo de referencia. Luego generamos todos los submodelos con 2 variables que incluyan la variable seleccionada en el paso anterior y así sucesivamente. Si hacemos este procedimiento directo para un modelo de referencia con 8 variables en lugar de 92 modelos diferentes, necesitaremos evaluar solo 36.</p>
<p>Otro aspecto que es relevante considerar al realizar inferencia predictiva por proyección es que solo proporcionamos a prioris para el modelo de referencia. Los submodelos no tienen priors explícitos; simplemente <em>heredan</em> los priors del modelo de referencia a través del procedimiento de proyección.</p>
<p>Una de las razones por las que la predicción proyectiva funciona en la práctica es gracias al uso de un modelo de referencia. Al ajustar los submodelos a las predicciones dentro de la muestra realizadas por el modelo de referencia, en lugar de los datos observados, estamos filtrando el ruido en los datos. Esto ayuda a separar las variables más relevantes de las menos relevantes.</p>
</section>
<section id="selección-de-variables-con-kulprit" class="level2" data-number="5.24">
<h2 data-number="5.24" class="anchored" data-anchor-id="selección-de-variables-con-kulprit"><span class="header-section-number">5.24</span> Selección de variables con Kulprit</h2>
<p>Kulprit es un paquete de Python para inferencia predictiva por proyecciones. Funciona con Bambi, ya que podemos pasar un modelo de referencia creado con él y Kulprit hará todo el trabajo pesado por nosotros.</p>
<p>Para ilustrar cómo usar Kulprit, usaremos el conjunto de datos de grasa corporal. Este conjunto de datos tiene medidas de 251 individuos, incluida su edad, peso, altura, circunferencia del abdomen, etc. Nuestro propósito es predecir el porcentaje de grasa corporal (según lo estimado por la variable <code>siri</code>). Dado que obtener mediciones precisas de la grasa corporal es costoso y potencialmente molesto para los pacientes, queremos reducir las mediciones manteniendo una buena precisión predictiva para <code>siri</code>. El conjunto de datos original incluye 13 variables. Para que este ejemplo sea realmente simple, he preseleccionado 6.</p>
<p>Lo primero que debemos hacer es definir y ajustar un modelo de Bambi, como es habitual. Tenemos que asegurarnos de incluir el argumento <code>idata_kwargs={'log_likelihood':True}}</code>. Internamente, Kulprit calcula el ELPD, usando LOO.</p>
<div id="4ddf0e13" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a>body <span class="op">=</span> pd.read_csv(<span class="st">"datos/body_fat.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="451472ae" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1"></a>model <span class="op">=</span> bmb.Model(<span class="st">"siri ~ age + weight + height + abdomen + thigh + wrist"</span>,</span>
<span id="cb115-2"><a href="#cb115-2"></a>                  data<span class="op">=</span>body)</span>
<span id="cb115-3"><a href="#cb115-3"></a>idata <span class="op">=</span> model.fit(idata_kwargs<span class="op">=</span>{<span class="st">'log_likelihood'</span>: <span class="va">True</span>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [siri_sigma, Intercept, age, weight, height, abdomen, thigh, wrist]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 10 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7836dd10e7574655a4cf03f2272d81e3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>El principal punto de entrada de Kulprit es mediante la clase <code>ProjectionPredictive</code>. Una vez provista del modelo de Bambi y los datos resultantes del ajuste de ese modelo. Podemos pedirle a Kulprit que realice una búsqueda. Este paso puede demorar un rato, es la parte pesada de todo el proceso.</p>
<div id="0776918c" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1"></a>ppi <span class="op">=</span> kpt.ProjectionPredictive(model, idata)</span>
<span id="cb117-2"><a href="#cb117-2"></a>ppi.search()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una vez finalizada la búsqueda, podemos pedirle a Kulprit que compare los submodelos en términos del ELPD. Los submodelos se mostrarán ordenados desde el ELPD más bajo hasta el más alto, como en la siguiente figura</p>
<div id="0085deec" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1"></a>ppi.plot_compare(plot<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/osvaldo/anaconda3/envs/EI2/lib/python3.11/site-packages/arviz/stats/stats.py:792: UserWarning: Estimated shape parameter of Pareto distribution is greater than 0.62 for one or more samples. You should consider using a more robust model, this is because importance sampling is less likely to work well if the marginal posterior and LOO posterior are very different. This is more likely to happen with a non-robust model and highly influential observations.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-87-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En el eje x, tenemos el tamaño del submodelo, es decir, el número de variables; Comenzamos en cero porque incluimos un modelo con solo un intercepto y sin ninguna covariables. La línea gris discontinua corresponde al ELPD del modelo de referencia.</p>
<p>Podemos ver que un submodelo de tamaño 3 es prácticamente equivalente al modelo de referencia. Pero ¿qué variables se incluyen exactamente en este y otros submodelos? Si imprimimos el objeto <code>ppi</code>, luego de realizar una búsqueda, obtendremos una lista ordenada de las fórmulas de los submodelos que coinciden con el orden en el gráfico obtenido con el comando <code>ppi.plot_compare()</code></p>
<div id="d32c15be" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1"></a>ppi</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>  0 siri ~ 1
  1 siri ~ abdomen
  2 siri ~ abdomen + wrist
  3 siri ~ abdomen + wrist + weight
  4 siri ~ abdomen + wrist + weight + height
  5 siri ~ abdomen + wrist + weight + height + age
  6 siri ~ abdomen + wrist + weight + height + age + thigh</code></pre>
</div>
</div>
<p>El modelo de tamaño 3 es el que incluye las variables <code>abdomen</code>, <code>wrist</code> y <code>weight</code>. Este resultado nos dice que si queremos elegir un modelo con menos variables que el modelo de referencia pero con una precisión predictiva similar, entonces esta es una buena opción. Dependiendo del contexto, otros submodelos también pueden ser una buena idea. Por ejemplo, podemos argumentar que la diferencia entre el submodelo de tamaños 2 y 3 es bastante pequeña. Por lo tanto, es posible que estemos dispuestos a sacrificar algo de precisión en favor de un modelo aún más pequeño. Para este ejemplo, medir la altura de los pacientes puede no ser tan problemático, pero para otros escenarios, agregar una tercera variable podría resultar costoso, molesto, peligroso, etc.</p>
<p>Otra forma de interpretar este resultado es notar qué los ELPD para modelos con tamaño 3 o mayor son esencialmente idénticos. Puede darse el caso de que si repetimos el análisis con un conjunto de datos ligeramente diferente, o incluso el mismo conjunto de datos pero con más muestras a posteriori, podamos obtener un orden ligeramente diferente. Por lo tanto, es posible que tengamos otros modelos de tamaño 3 con potencialmente la misma capacidad predictiva, entonces podríamos justificar la selección de la tercera variable por factores externos como qué tan fácil o barato es medirla, o cuál sería menos dolorosa de medir para los pacientes, etc.</p>
<p>En resumen, como ocurre con otras herramientas estadísticas, los resultados no deben tomarse a ciegas sino en contexto; usted deben tener la última palabra y no sus herramientas. Las herramientas solo deben ayudar a fundamentar sus decisiones.</p>
<p>Bien, digamos que efectivamente estamos interesados en el submodelo de tamaño 3 calculado por Kulprit; podemos conseguirlo con:</p>
<div id="43ef1e11" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1"></a>submodelo <span class="op">=</span> ppi.project(<span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Desde el objeto <code>submodel</code>, podemos recuperar información útil como el modelo de Bambi <code>submodelo.model</code> o el objeto InferenceData <code>submodelo.idata</code>.</p>
<p>Una advertencia al interpretar estos dos objetos: <code>submodelo.model</code> es un modelo de Bambi generado a partir de una fórmula. Así, sus priors serán los computados automáticamente por Bambi. Pero el posterior que calcula Kulprit, que está almacenado en <code>submodelo.idata.posterior</code>, no proviene directamente de este modelo. Ya que los priors son “heredados” implícitamente durante el paso de proyección.</p>
<div id="10209ea2" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1"></a>az.plot_posterior(submodelo.idata, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-90-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>¿Podemos confiar en las distribuciones a posteriori proyectados?</p>
<p>En condiciones muy generales, deberían ser distribuciones válidas, lo son al menos para obtener una idea aproximada de los valores de los parámetros y, por supuesto, es suficiente para la selección de variables. La falta de priors explícitos podría dificultar la interpretación del modelo, pero si solo nos importan las predicciones, eso no debería ser un problema. Por supuesto, siempre es posible usar Kulprit para determianr el submodelo y luego Bambi (o PyMC) para calcular explícitamente el posterior de ese modelo adaptado los priors de ser necesario.</p>
<p>La siguiente figura muestra un forestplot para el posteriors del submodelo 3 y para el modelo de referencia. Observe que aquí hay dos posibles fuentes de diferencias: las diferencias entre MCMC y los métodos predictivos por proyección y las diferencias intrínsecas entre los posteriors para ambos modelos.</p>
<div id="f4bb47f1" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1"></a>ppi.plot_densities(var_names<span class="op">=</span>[<span class="st">"~Intercept"</span>, <span class="st">"~age"</span>, <span class="st">"~height"</span>, <span class="st">"~thigh"</span>],</span>
<span id="cb124-2"><a href="#cb124-2"></a>                   submodels<span class="op">=</span>[<span class="dv">3</span>],</span>
<span id="cb124-3"><a href="#cb124-3"></a>                   kind<span class="op">=</span><span class="st">"forest"</span>,</span>
<span id="cb124-4"><a href="#cb124-4"></a>                   figsize<span class="op">=</span>(<span class="dv">11</span>, <span class="dv">4</span>),</span>
<span id="cb124-5"><a href="#cb124-5"></a>                   plot_kwargs<span class="op">=</span>{<span class="st">"colors"</span>:[<span class="st">"C0"</span>, <span class="st">"C2"</span>]})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05_GLMS_files/figure-html/cell-91-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ejercicios" class="level2" data-number="5.25">
<h2 data-number="5.25" class="anchored" data-anchor-id="ejercicios"><span class="header-section-number">5.25</span> Ejercicios</h2>
<ol type="1">
<li>En la siguiente definición de modelo probabilístico cual es el <em>likelihood</em>, cual es el <em>a priori</em> y cual el <em>a posteriori</em>.</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim Normal(\mu, \sigma) \\
\mu &amp;\sim Normal(0, 10) \\
\sigma &amp;\sim HalfNormal(25)
\end{aligned}
\]</span></p>
<ol start="2" type="1">
<li><p>En el modelo del punto 1 ¿cuántos parámetros hay en el posterior? o expresado de otra forma ¿cuántas dimensiones tiene el <em>a posteriori</em>?</p></li>
<li><p>En el siguiente modelo ¿cuál es el modelo lineal? ¿cuál el likelihood y cuantos parámetros hay en la distribución a posteriori?</p></li>
</ol>
<p><span class="math display">\[
\begin{aligned}
y &amp;\sim Normal(\mu, \epsilon) \\
\mu &amp;= \alpha + \beta x \\
\alpha &amp;\sim Normal(0, 10) \\
\beta &amp;\sim Normal(0, 1) \\
\epsilon &amp;\sim HalfNormal(25) \\
\end{aligned}
\]</span></p>
<ol start="4" type="1">
<li><p>Usando el conjunto de datos <code>howell</code> (disponible junto con esta notebook) realice un modelo lineal del peso (<span class="math inline">\(x\)</span>) versus la altura (<span class="math inline">\(y\)</span>). Excluya a los menores de 18 años. Exponga los resultados.</p></li>
<li><p>Para 4 individuos se registraron los pesos (45.73, 65.8, 54.2, 32.59), pero no las alturas. Usando el modelo del punto anterior prediga la altura esperada para cada individuo junto con un intervalo de credibilidad del 50% y del 89%.</p></li>
<li><p>Repita el punto 4 pero para los menores de 18 años. Exponga los resultados.</p></li>
<li><p>Use el modelo <code>modelo_bl</code> pero aplicada al conjunto de datos iris. Intente clasificar setosa o versicolor en función de <code>sepal_length</code>. ¿Cuán útil es este modelo comparado con una regresión logística?</p></li>
<li><p>Vuelva a correr el <code>modelo_rl</code> pero esta vez usando la variable <code>petal_width</code> ¿En que difieren los resultados? ¿Cuán ancho o angosto es el intervalo HDI 94%?</p></li>
<li><p>Lea este <a href="https://twiecki.github.io/blog/2017/02/08/bayesian-hierchical-non-centered/">post</a> y replique los resultados usted mismo.</p></li>
</ol>


</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{"00abb1f6b2ce42a3bd8bf7cf41a05104":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"0ef3d7a80c9d41f2a15cbda270ef59ef":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"0ffcec02579f44cba84d1401093c1919":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"1101861460b544cea6c97d499a9e2af9":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_2dbb2bc2252140649c059b2f464e47cf","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:02</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:02\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"1432de14402a4b86bc1d5cb06cf7c330":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"157403ba883f45638e4a2c4f56de689a":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_f96b2dc100674283b4794197cee079f1","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling ... <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:00</span>\n</pre>\n","text/plain":"Sampling ... \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:00\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"15a1a8d96a5747b3951d7abcb74480f6":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_80af9f304f7d41caabdcf6fca26eb0c3","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:02</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:02\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"194e66551cb64b6fbc39b97414f0e1f5":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_399731492f174548965a51ec14c5d80d","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:13</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:13\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"1e46f363641946e28ed0efff504e8020":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_b21a2a86b4a34c8cba46a11fdd3a96f6","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:04</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:04\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"23886ddd5e90456e8af607284f04c662":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"2dbb2bc2252140649c059b2f464e47cf":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"373c967bd639498faf21295260fac2f0":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_86f4c7ab9a694a9383affb2b529ad616","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:03</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:03\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"399731492f174548965a51ec14c5d80d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"3e40b26d6932411d807d80744e195feb":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_aaea9244552a401ea414470fdc34f9c8","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:01</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:01\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"4368f722ebbd4d34af2b9a194179029a":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_bbf447c1b41548aba16831918c6d40d0","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:03</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:03\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"47e3d5d0cd494a1b8cdfda3e69f2d8bb":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_609c071a46c84f82bb94a50eaad4b0d8","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:10</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:10\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"4968fee6eefd448ba0bf401e3ae17b05":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"4f7357bcf4ce41fbae9d2ad7b05f58ad":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"5e4ed438e53744e2bca14b69a30cfc62":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_0ef3d7a80c9d41f2a15cbda270ef59ef","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:03</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:03\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"5f247bb73c8f4c6c9c0a520bd2bedff8":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_23886ddd5e90456e8af607284f04c662","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling ... <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:00</span>\n</pre>\n","text/plain":"Sampling ... \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:00\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"609c071a46c84f82bb94a50eaad4b0d8":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"637f4c978ea94764b5ee2c6d4d47f112":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_00abb1f6b2ce42a3bd8bf7cf41a05104","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:03</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:03\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"7836dd10e7574655a4cf03f2272d81e3":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_aa3daf607b9a49a2aaf92d58d527825b","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:09</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:09\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"80af9f304f7d41caabdcf6fca26eb0c3":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"8330ef72a44d45edbac33228d359b535":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_1432de14402a4b86bc1d5cb06cf7c330","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 1 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:03</span>\n</pre>\n","text/plain":"Sampling 4 chains, 1 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:03\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"86f4c7ab9a694a9383affb2b529ad616":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"8bfb3c699a27462db9f49eed86e4d56d":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_4968fee6eefd448ba0bf401e3ae17b05","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:03</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:03\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"8ce4fcb7531d44dfbcb7d6a1742cc178":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_e7335243893c4f958a72173178548791","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:09</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:09\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"8f3e9a52249143d699c2f4a91883802e":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_4f7357bcf4ce41fbae9d2ad7b05f58ad","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:02</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:02\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"9b8710214b3c485d904e6c3a211a237e":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_f5b55af9e89b4cdc9641f420a324f396","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling ... <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:00</span>\n</pre>\n","text/plain":"Sampling ... \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:00\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"aa3daf607b9a49a2aaf92d58d527825b":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"aa627321993640ddbe54adf09d7951e5":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_ae02d5bc9fd54988b4a3e7baa1a04189","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:02</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:02\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"aaea9244552a401ea414470fdc34f9c8":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"ae02d5bc9fd54988b4a3e7baa1a04189":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"b0ce5d61275d4c8ab15e2d0ecede27de":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_c7a3900da5f34ba5a582a1eec1ff4cb9","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:06</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:06\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"b21a2a86b4a34c8cba46a11fdd3a96f6":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"b46f0dc6f06542bcb98e215e04f7834e":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"b5587b0c35334e08a434a90f44fcf9be":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_b46f0dc6f06542bcb98e215e04f7834e","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 172 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:07</span>\n</pre>\n","text/plain":"Sampling 4 chains, 172 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:07\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"b7ac8bac430b48fbbf961a345d633776":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_d68d7727e7d24506bb06b75ad9dc4513","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling ... <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:00</span>\n</pre>\n","text/plain":"Sampling ... \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:00\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"bbf447c1b41548aba16831918c6d40d0":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"c7a3900da5f34ba5a582a1eec1ff4cb9":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"d609b9ee430c40708e64e7cd6aafa806":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_fcf6fe096c314721a4a28ef8838983d3","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:03</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:03\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"d68d7727e7d24506bb06b75ad9dc4513":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"df9c82ec2681419aa836d8fe6085aee8":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"layout":"IPY_MODEL_0ffcec02579f44cba84d1401093c1919","outputs":[{"data":{"text/html":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Sampling 4 chains, 0 divergences <span style=\"color: #008000; text-decoration-color: #008000\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span style=\"color: #800080; text-decoration-color: #800080\">100%</span> <span style=\"color: #008080; text-decoration-color: #008080\">0:00:00</span> / <span style=\"color: #808000; text-decoration-color: #808000\">0:00:05</span>\n</pre>\n","text/plain":"Sampling 4 chains, 0 divergences \u001b[32m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m / \u001b[33m0:00:05\u001b[0m\n"},"metadata":{},"output_type":"display_data"}]}},"e7335243893c4f958a72173178548791":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"f5b55af9e89b4cdc9641f420a324f396":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"f96b2dc100674283b4794197cee079f1":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}},"fcf6fe096c314721a4a28ef8838983d3":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}}},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04_Flujo_de_trabajo_bayesiano.html" class="pagination-link" aria-label="Flujo de trabajo Bayesiano">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Flujo de trabajo Bayesiano</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06_modelos_de_mezcla.html" class="pagination-link" aria-label="Modelos de mezcla">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos de mezcla</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Licencia Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a><br>Este obra está bajo <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">licencia Creative Commons Reconocimiento 4.0 Internacional</a>.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Estadística e Inferencia II - 2&nbsp; Programación probabilista</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_Modelos_jerárquicos.html" rel="next">
<link href="./01_Inferencia_Bayesiana.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02_Programación_probabilística.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Programación probabilista</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Estadística e Inferencia II</a> 
        <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="github" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="github"><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/LCD-UNSAM/estadistica_e_inferencia_II">
            Fuente
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/LCD-UNSAM/estadistica_e_inferencia_II/issues/new">
            Reportar errores
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Modo claro/oscuro"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Modo sin distracciones">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">‎</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Inferencia_Bayesiana.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Inferencia Bayesiana</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Programación_probabilística.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Programación probabilista</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Modelos_jerárquicos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelado Jerárquico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Flujo_de_trabajo_bayesiano.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Flujo de trabajo Bayesiano</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_GLMS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelos lineales y generalizaciones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_modelos_de_mezcla.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos de mezcla</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_GPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Procesos Gaussianos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_BART.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Árboles de regresión aditivos Bayesianos</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#introducción-a-pymc" id="toc-introducción-a-pymc" class="nav-link active" data-scroll-target="#introducción-a-pymc"><span class="header-section-number">2.1</span> Introducción a PyMC</a>
  <ul class="collapse">
  <li><a href="#el-problema-de-la-moneda-ahora-usando-pymc-y-arviz" id="toc-el-problema-de-la-moneda-ahora-usando-pymc-y-arviz" class="nav-link" data-scroll-target="#el-problema-de-la-moneda-ahora-usando-pymc-y-arviz"><span class="header-section-number">2.1.1</span> El problema de la moneda, ahora usando PyMC y ArviZ</a></li>
  <li><a href="#creación-del-modelo" id="toc-creación-del-modelo" class="nav-link" data-scroll-target="#creación-del-modelo"><span class="header-section-number">2.1.2</span> Creación del modelo</a></li>
  <li><a href="#inferencia" id="toc-inferencia" class="nav-link" data-scroll-target="#inferencia"><span class="header-section-number">2.1.3</span> Inferencia</a></li>
  <li><a href="#resumiendo-el-a-posteriori" id="toc-resumiendo-el-a-posteriori" class="nav-link" data-scroll-target="#resumiendo-el-a-posteriori"><span class="header-section-number">2.1.4</span> Resumiendo el <em>a posteriori</em></a></li>
  <li><a href="#accidentes-mineros" id="toc-accidentes-mineros" class="nav-link" data-scroll-target="#accidentes-mineros"><span class="header-section-number">2.1.5</span> Accidentes mineros</a></li>
  </ul></li>
  <li><a href="#comparando-grupos" id="toc-comparando-grupos" class="nav-link" data-scroll-target="#comparando-grupos"><span class="header-section-number">2.2</span> Comparando grupos</a>
  <ul class="collapse">
  <li><a href="#d-de-cohen" id="toc-d-de-cohen" class="nav-link" data-scroll-target="#d-de-cohen"><span class="header-section-number">2.2.1</span> d de Cohen</a></li>
  <li><a href="#probabilidad-de-superioridad" id="toc-probabilidad-de-superioridad" class="nav-link" data-scroll-target="#probabilidad-de-superioridad"><span class="header-section-number">2.2.2</span> Probabilidad de superioridad</a></li>
  <li><a href="#el-conjunto-de-datos-propinas" id="toc-el-conjunto-de-datos-propinas" class="nav-link" data-scroll-target="#el-conjunto-de-datos-propinas"><span class="header-section-number">2.2.3</span> El conjunto de datos <em>propinas</em></a></li>
  </ul></li>
  <li><a href="#resumen" id="toc-resumen" class="nav-link" data-scroll-target="#resumen"><span class="header-section-number">2.3</span> Resumen</a></li>
  <li><a href="#ejercicios" id="toc-ejercicios" class="nav-link" data-scroll-target="#ejercicios"><span class="header-section-number">2.4</span> Ejercicios</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Programación probabilista</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> preliz <span class="im">as</span> pz</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>az.style.use(<span class="st">"arviz-doc"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Los objetivos de este capítulo son:</p>
<ul>
<li>Construir modelos con PyMC</li>
<li>Analizar modelos con PyMC y ArviZ</li>
<li>Explorar formas alternativas de interpretar la distribución <em>a posteriori</em></li>
<li>Discutir el tamaño del efecto sobre la significancia estadística</li>
</ul>
<p>La estadística Bayesiana es conceptualmente muy simple, tenemos lo <em>conocido</em> y lo <em>desconocido</em>. El teorema de Bayes se utiliza para condicionar lo desconocido usando lo conocido, si tenemos suerte este proceso conducirá a una reducción de la incertidumbre sobre lo desconocido. Por lo general nos referimos a lo conocido como datos y los consideramos fijo mientras que lo desconocido toma la forma de parámetros de distribuciones de probabilidad.</p>
<p>La simpleza conceptual para formular modelos Bayesianos contrasta con la dificultad matemático/computacional para resolverlos. Por muchos años esto fue un verdadero problema y retrasó la adopción de métodos Bayesianos.</p>
<p>A fin de poder resolver los modelos Bayesianos se recurre a métodos numéricos que pueden ser considerados como <em>motores universales de inferencia</em>. El hecho que tales motores sean posibles ha motivado el surgimiento de la programación probabilística, este tipo de lenguajes permiten una separación clara entre la creación de los modelos y el proceso de inferencia.</p>
<p>Un lenguaje de programación probabilístico es, en lineas generales, un lenguaje que le permite al usuario describir, en una pocas lineas de código (las necesarias para describir el modelo), un modelo probabilístico completo. Luego se procede a utilizar este modelo para realizar la inferencia de forma automática. Se espera que la programación probabilística tenga un gran impacto en estadística, <em>machine learning</em> y otras disciplinas al permitir que científicos construyan modelos complejos en menor tiempo y de forma menos propensa a errores.</p>
<p>Una buena analogía sobre el impacto que un lenguaje de programación puede tener en la ciencia es la introducción del lenguaje de programación Fortran hace más de 6 décadas. Fortran permitió a los científicos, por primera vez, abstraerse de muchos de los detalles computacionales y centrarse en la construcción de métodos numéricos, modelos y simulaciones de una manera más natural. De manera similar, se espera que los lenguajes de programación probabilísticos escondan del usuario detalles sobre cómo las probabilidades son manipuladas y cómo se lleva a cabo la inferencia, dejando que los usuarios se centren en la especificación del modelo y en el análisis e interpretación de los resultados.</p>
<section id="introducción-a-pymc" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="introducción-a-pymc"><span class="header-section-number">2.1</span> Introducción a PyMC</h2>
<p>PyMC es un paquete para programación probabilística bajo Python. PyMC es lo suficientemente madura para resolver muchos problemas estadísticos. PyMC permite crear modelos probabilísticos usando una sintaxis intuitiva y fácil de leer que es muy similar a la sintaxis usada para describir modelos probabilísticos.</p>
<p>La mayoría de las funciones de PyMC están escritas en Python. Mientras que las partes computacionalmente demandantes están escritas en NumPy y <a href="https://pytensor.readthedocs.io/en/latest/">PyTensor</a>. Pytensor es una biblioteca de Python que permite definir, optimizar y evaluar expresiones matemáticas que involucran matrices multidimensionales de manera eficiente. PyTensor es hija de Theano una librería de Python originalmente desarrollada para <em>deep learning</em> (que es a su vez la antecesora de TensorFlow, PyTorch, etc).</p>
<section id="el-problema-de-la-moneda-ahora-usando-pymc-y-arviz" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="el-problema-de-la-moneda-ahora-usando-pymc-y-arviz"><span class="header-section-number">2.1.1</span> El problema de la moneda, ahora usando PyMC y ArviZ</h3>
<p>A continuación revistaremos el problema de la moneda visto en el capítulo anterior, usando esta vez PyMC para definir nuestro modelo y hacer inferencia. Luego usaremos ArviZ para analizar el <em>a posterori</em>.</p>
<p>A continuación generaremos datos sintéticos, en este caso asumiremos que conocemos el valor the <span class="math inline">\(\theta\)</span> y lo llamaremos <code>theta_real</code>, y luego intentaremos <em>averiguar</em> este valor <em>como si no</em> lo conociéramos. En un problema <em>real</em> <code>theta_real</code> sería desconocido y realizaríamos un proceso de inferencia precisamente para averiguar su valor.</p>
<div id="cell-8" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>n_experimentos <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>theta_real <span class="op">=</span> <span class="fl">0.35</span>  <span class="co"># en una situación real este valor es desconocido</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>datos <span class="op">=</span> pz.Binomial(n<span class="op">=</span><span class="dv">1</span>, p<span class="op">=</span>theta_real).rvs(size<span class="op">=</span>n_experimentos, random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>datos</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>array([1, 0, 0, 0])</code></pre>
</div>
</div>
</section>
<section id="creación-del-modelo" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="creación-del-modelo"><span class="header-section-number">2.1.2</span> Creación del modelo</h3>
<p>Ahora que tenemos nuestros datos es necesario especificar el modelo. Para ello usaremos una distribución beta (con parámetros <span class="math inline">\(\alpha=\beta=1\)</span>) como <em>a priori</em> y la distribución de Bernoulli como likelihood. Usando la notación usual en estadística tenemos:</p>
<p><span class="math display">\[\begin{align}
\theta &amp;\sim \operatorname{Beta}(\alpha=1, \beta=1)\\
Y &amp;\sim \operatorname{Bin}(n=1, p=\theta)
\end{align}\]</span></p>
<blockquote class="blockquote">
<p>Cada uno de los elementos del <em>array</em> <code>datos</code> es un experimento de Bernoulli, es decir un experimento donde solo es posible obtener dos valores (0 o 1) si en cambio tuviera el número total de “caras” obtenidas en varios experimentos de Bernoulli podríamos modelar el likelihood como una distribución Binomial.</p>
</blockquote>
<p>Esto modelo se traduce casi literalmente a PyMC, veamos:</p>
<div id="cell-10" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> nuestro_primer_modelo:</span>
<span id="cb5-2"><a href="#cb5-2"></a>    θ <span class="op">=</span> pm.Beta(<span class="st">"θ"</span>, alpha<span class="op">=</span><span class="dv">1</span>, beta<span class="op">=</span><span class="dv">1</span>)  <span class="co"># a priori</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>    y <span class="op">=</span> pm.Bernoulli(<span class="st">"y"</span>, p<span class="op">=</span>θ, observed<span class="op">=</span>datos)  <span class="co"># likelihood</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="co"># y = pm.Binomial('y',n=n_experimentos, p=θ, observed=sum(datos))</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En la primer linea hemos creado un nuevo objeto llamado <em>nuestro_primer_modelo</em>. Este objeto contiene información sobre el modelo y las variables que lo conforman. PyMC usa el bloque <em>with</em> para indicar que todas las lineas que están dentro de él hacen referencia al mismo modelo (que en este caso se llama <em>nuestro_primer_modelo</em>).</p>
<p>La segunda linea de código, especifica el <em>a priori</em>, como pueden ver la sintaxis sigue de cerca a la notación matemática, la única diferencia es que el primer argumento es siempre una <em>cadena</em> que especifica el nombre de la variable aleatoria (el nombre es usado internamente por PyMC), este nombre siempre deberá coincidir con el nombre de la variable de Python a la que se le asigna. De no ser así el código correrá igual, pero puede conducir a errores y confusiones al analizar el modelo.</p>
<blockquote class="blockquote">
<p>Es importante recalcar que las variables de PyMC, como <span class="math inline">\(\theta\)</span>, no son números sino objetos que representan distribuciones. Es decir objetos a partir de los cuales es posible calcular probabilidades y generar números aleatorios.</p>
</blockquote>
<p>En la tercer linea de código se especifica el <em>likelihood</em>, que como verán es similar a la linea anterior con la diferencia que hemos agregado un argumento llamado <code>observed</code> al cual le asignamos nuestros datos. Esta es la forma de indicarle a PyMC cuales son los datos. Los datos pueden ser números, listas de Python, <em>arrays</em> de NumPy o <em>data_frames</em> de Pandas.</p>
</section>
<section id="inferencia" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="inferencia"><span class="header-section-number">2.1.3</span> Inferencia</h3>
<p>Nuestro modelo ya está completamente especificado, lo único que nos resta hacer es obtener el <em>a posteriori</em>. En el capítulo anterior vimos como hacerlo de forma analítica, ahora lo haremos con métodos numéricos.</p>
<p>En PyMC la inferencia se realiza escribiendo las siguientes lineas:</p>
<div id="cell-13" class="cell" data-scrolled="true" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="cf">with</span> nuestro_primer_modelo:</span>
<span id="cb6-2"><a href="#cb6-2"></a>    idata <span class="op">=</span> pm.sample(<span class="dv">1000</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [θ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 1 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6da54920c20c4a96bd09f7d378e506bc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>Primero llamamos al objeto que definimos como nuestro modelo (<em>nuestro_primer_modelo</em>), indicando de esta forma que es sobre ese objeto que queremos realizar la inferencia. En la segunda linea le indicamos a PyMC que deseamos 1000 muestras. Esta linea luce inocente, pero internamente PyMC está haciendo muchas cosas por nosotros. Algunas de las cuales son detalladas en el mensaje que se imprime en pantalla.</p>
<p>Veamos este mensaje:</p>
<ul>
<li>La primer linea indica que PyMC ha asignado el método de muestreo NUTS, el cual es un muy buen método para variables continuas.</li>
<li>La segunda linea nos da información sobre cómo se inicializaron los valores de NUTS. Un detalle que por ahora no nos preocupa.</li>
<li>La tercer linea indica que PyMC correrá cuatro cadenas en paralelo, es decir generará cuatro muestras independientes del <em>a posteriori</em>. Esta cantidad puede ser diferente en sus computadoras ya que es determinada automáticamente en función de los procesadores disponibles (que en mi caso, 4). <code>sample</code> tiene un argumento <code>chains</code> que permite modificar este comportamiento.</li>
<li>La cuarta linea indica qué variable ha sido asignada a cual método de muestreo. En este caso la información es redundante, ya que tenemos una sola variable, pero esto no siempre es así. PyMC permite combinar métodos de muestreo, ya sea de forma automática basado en propiedades de las variables a muestrear o especificado por el usuario usando el argumento <code>step</code>.</li>
<li>La quinta linea es una barra de progreso con varias métricas sobre la velocidad del muestreo, que en este caso (y para referencia futura) es muy alta. También indica la cantidad de cadenas usadas y la cantidad de divergencias. Tener 0 divergencias es ideal, más adelante discutiremos la razón.</li>
<li>Por último tenemos un detalle de la cantidad de muestras generadas, aunque pedimos 1000 obtuvimos 8000, la razón es que es son 1000 por cadena (4 cadenas en mi caso), es decir 4000. Todavía nos queda explicar 4000 muestras <em>extras</em>, estas se corresponden a 1000 por cadena y son muestras que PyMC utiliza para <em>auto-tunear</em> el método de muestreo. Estás muestras son luego descartadas automáticamente ya que no son muestras representativas del posterior. La cantidad de pasos que se usan para <em>tunear</em> el algoritmo de muestreo se puede cambiar con el argumento <code>tune</code> de la función <code>pm.sample(.)</code>.</li>
</ul>
</section>
<section id="resumiendo-el-a-posteriori" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="resumiendo-el-a-posteriori"><span class="header-section-number">2.1.4</span> Resumiendo el <em>a posteriori</em></h3>
<p>Por lo general, la primer tarea a realizar luego de haber realizado un muestreo es evaluar como lucen los resultados. La función <code>plot_forestplot</code> de ArviZ es muy útil para esta tarea.</p>
<div id="cell-16" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>az.plot_forest(idata, combined<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">2</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Programación_probabilística_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>El punto indica la media, la linea gruesa el rango intercuartil y las lineas finas el HDI 94%</p>
<blockquote class="blockquote">
<p>Es importante notar que la variable <code>y</code> es una variable observada, es decir conocida. Mientras que en el gráfico anterior estamos dibujando solo <span class="math inline">\(\theta\)</span> que es la única variables desconocida, y por lo tanto muestreada.</p>
</blockquote>
<p>Si quisiéramos un resumen numérico de los resultados podemos usar:</p>
<div id="cell-18" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>az.summary(idata, kind<span class="op">=</span><span class="st">"stats"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sd</th>
<th data-quarto-table-cell-role="th">hdi_3%</th>
<th data-quarto-table-cell-role="th">hdi_97%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">θ</td>
<td>0.337</td>
<td>0.176</td>
<td>0.044</td>
<td>0.651</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Como resultado obtenemos un DataFrame con los valores de la media, la desviación estándar y el intervalo HDI 94% (hdi_3 hdi_97).</p>
<p>Otra forma de resumir visualmente el a posteriori es usar la función <code>plot_posterior</code> que viene con ArviZ, ya hemos utilizado esta distribución en el capítulo anterior para un falso a posteriori. Vamos a usarlo ahora con un posterior real. Por defecto, esta función muestra un histograma para variables discretas y KDEs para variables continuas. También obtenemos la media de la distribución (podemos preguntar por la mediana o moda usando el argumento <code>point_estimate</code>) y el 94% HDI como una línea negra en la parte inferior de la gráfica. Se pueden establecer diferentes valores de intervalo para el HDI con el argumento <code>hdi_prob</code>. Este tipo de gráfica fue presentado por John K. Kruschke en su gran libro “Doing Bayesian Data Analysis”.</p>
<div id="cell-20" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>az.plot_posterior(idata)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Programación_probabilística_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="accidentes-mineros" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="accidentes-mineros"><span class="header-section-number">2.1.5</span> Accidentes mineros</h3>
<p>Este ejemplo está tomado del <a href="https://www.pymc.io/projects/docs/en/latest/learn/core_notebooks/pymc_overview.html#case-study-2-coal-mining-disasters">tutorial</a> de PyMC.</p>
<p>El problema es el siguiente, tenemos un registro del número de accidentes en minas de carbón, ubicadas en el Reino Unido, que ocurrieron entre 1851 y 1962 (<a href="http://biomet.oxfordjournals.org/content/66/1/191.abstract">Jarrett, 1979</a>). Se sospecha que la aplicación de ciertas regulaciones de seguridad tuvo como efecto una disminución en la cantidad de catástrofes. Por lo tanto nos interesa averiguar el año en que la tasa cambió y nos interesa estimar ambas tasas.</p>
<p>Los datos son los siguientes, por un lado tenemos la variable <em>accidentes</em> que contiene la cantidad de accidentes por año y por el otro la variable <em>años</em> conteniendo el rango de años para los cuales tenemos datos. <code>accidentes</code> es una serie de Pandas que contiene el valor especial <code>NAN</code>, este es el valor por defecto en Pandas para lidiar con datos faltantes.</p>
<p>Bien, pero para que molestarse con datos faltantes si en general es más fácil eliminarlos. una de las razones es que esto puede conducir a pérdida de información cuando por cada observación tenemos más de una variable o cantidad de interés. Por ejemplo si tenemos 50 sujetos a los que les hemos medido la presión, la temperatura y el ritmo cardíaco, pero sucede que para 4 de ellos no contamos con el datos de la presión (porque alguien se olvidó de medirlo o registrarlo, o porque el tensiómetro se rompió, o por lo que sea). Podemos eliminar esos cuatro sujetos del análisis y perder por lo tanto información sobre la presión y ritmo cardíaco, o podemos usar todos los datos disponibles y además estimar los valores de temperatura faltantes. En el contexto de la estadística Bayesiana los datos faltantes se tratan como un parámetro desconocido del modelo que puede ser estimado.</p>
<div id="cell-22" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>accidentes <span class="op">=</span> pd.Series([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">6</span>,</span>
<span id="cb11-2"><a href="#cb11-2"></a>                       <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">5</span>,</span>
<span id="cb11-3"><a href="#cb11-3"></a>                       <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, np.nan, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb11-4"><a href="#cb11-4"></a>                       <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>                       <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>,</span>
<span id="cb11-6"><a href="#cb11-6"></a>                       <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, np.nan, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>,</span>
<span id="cb11-7"><a href="#cb11-7"></a>                       <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb11-8"><a href="#cb11-8"></a>años <span class="op">=</span> np.arange(<span class="dv">1851</span>, <span class="dv">1962</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-23" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>plt.plot(años, accidentes, <span class="st">"."</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>plt.ylabel(<span class="st">"Número de accidentes"</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>plt.xlabel(<span class="st">"Año"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Programación_probabilística_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Para modelar los accidentes usaremos una distribución de Poisson. Como creemos que la cantidad media de accidentes es distinta antes y después de la introducción de regulaciones de seguridad usaremos dos valores de tasas medias de accidentes (<span class="math inline">\(t_0\)</span> y <span class="math inline">\(t_1\)</span>). Además deberemos estimar un punto de corte (<span class="math inline">\(pc\)</span>) que dividirá los años para los cuales se aplica la tasa de accidentes <span class="math inline">\(t_0\)</span> de los cuales se aplica la tasa <span class="math inline">\(t_1\)</span>:</p>
<p><span class="math display">\[\begin{equation}
A_t \sim Poisson(tasa)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
tasa = \begin{cases}
t_0, \text{si } t \ge pc,\\
t_1, \text{si } t \lt pc
\end{cases}
\end{equation}\]</span></p>
<p>Los <em>a prioris</em> que usaremos serán:</p>
<p><span class="math display">\[\begin{align}
t_0 \sim Expon(1) \\
t_1 \sim Expon(1) \\
pc \sim U(A_0, A_1)
\end{align}\]</span></p>
<p>Donde la distribución uniforme es discreta y <span class="math inline">\(A_0\)</span> y <span class="math inline">\(A_1\)</span> corresponden al primer y último año considerado en el análisis respectivamente.</p>
<p>Gráficamente el modelo es:</p>
<center>
<img src="img/modelo_mineros.png" width="350">
</center>
<p>Una peculiaridad de la implementación de este modelo en PyMC es el uso de la función <code>pm.switch</code> (linea 10). Esta es en realidad una función de PyMC y equivale a un <em>if else</em> de Python. Si el primer argumento es <em>True</em> entonces devuelve el segundo argumento caso contrario el tercer argumento. Como resultado tenemos que <em>tasa</em> es un vector de longitud igual a la de <em>años</em> y cuyos elementos corresponden a una repetición <span class="math inline">\(t_0\)</span> seguida de una repetición <span class="math inline">\(t_1\)</span>, la cantidad exacta de repeticiones de <span class="math inline">\(t_0\)</span> y <span class="math inline">\(t_1\)</span> está controlada por la condición <span class="math inline">\(pc \ge\)</span> <em>años</em>. De esta forma, podemos al muestrear <span class="math inline">\(pc\)</span>, modificar que años reciben cual tasa para el cálculo del <em>likelihood</em>.</p>
<div id="cell-25" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> modelo_cat:</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>    pc <span class="op">=</span> pm.DiscreteUniform(<span class="st">"pc"</span>, lower<span class="op">=</span>años.<span class="bu">min</span>(), upper<span class="op">=</span>años.<span class="bu">max</span>())</span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="co"># Priors para las tasas antes y después del cambio.</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>    t_0 <span class="op">=</span> pm.Exponential(<span class="st">"t_0"</span>, <span class="dv">1</span>)</span>
<span id="cb13-7"><a href="#cb13-7"></a>    t_1 <span class="op">=</span> pm.Exponential(<span class="st">"t_1"</span>, <span class="dv">1</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="co"># Asignamos las tasas a los años de acuerdo a pc</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>    tasa <span class="op">=</span> pm.Deterministic(<span class="st">"tasa"</span>, pm.math.switch(pc <span class="op">&gt;=</span> años, t_0, t_1))</span>
<span id="cb13-11"><a href="#cb13-11"></a></span>
<span id="cb13-12"><a href="#cb13-12"></a>    acc <span class="op">=</span> pm.Poisson(<span class="st">"acc"</span>, tasa, observed<span class="op">=</span>accidentes)</span>
<span id="cb13-13"><a href="#cb13-13"></a>    idata_cat <span class="op">=</span> pm.sample(<span class="dv">1000</span>, random_seed<span class="op">=</span><span class="dv">1791</span>, idata_kwargs<span class="op">=</span>{<span class="st">"log_likelihood"</span>: <span class="va">True</span>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/osvaldo/anaconda3/envs/EI2/lib/python3.11/site-packages/pymc/model/core.py:1342: RuntimeWarning: invalid value encountered in cast
  data = convert_observed_data(data).astype(rv_var.dtype)
/home/osvaldo/anaconda3/envs/EI2/lib/python3.11/site-packages/pymc/model/core.py:1356: ImputationWarning: Data in acc contains missing values and will be automatically imputed from the sampling distribution.
  warnings.warn(impute_message, ImputationWarning)
Multiprocess sampling (4 chains in 4 jobs)
CompoundStep
&gt;CompoundStep
&gt;&gt;Metropolis: [pc]
&gt;&gt;Metropolis: [acc_unobserved]
&gt;NUTS: [t_0, t_1]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.
The rhat statistic is larger than 1.01 for some parameters. This indicates problems during sampling. See https://arxiv.org/abs/1903.08008 for details
The effective sample size per chain is smaller than 100 for some parameters.  A higher number is needed for reliable rhat and ess computation. See https://arxiv.org/abs/1903.08008 for details</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"81e48c653ffa407b9a9de4e0e99985b7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>idata_cat</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

            <div>
              <div class="xr-header">
                <div class="xr-obj-type">arviz.InferenceData</div>
              </div>
              <ul class="xr-sections group-sections">
              
            <li class="xr-section-item">
                  <input id="idata_posterior696c6c1f-7567-4847-95a0-f5fe29c7eb8b" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior696c6c1f-7567-4847-95a0-f5fe29c7eb8b" class="xr-section-summary">posterior</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 7MB
Dimensions:               (chain: 4, draw: 1000, acc_dim_0: 111,
                           acc_unobserved_dim_0: 2, tasa_dim_0: 111)
Coordinates:
  * chain                 (chain) int64 32B 0 1 2 3
  * draw                  (draw) int64 8kB 0 1 2 3 4 5 ... 995 996 997 998 999
  * acc_dim_0             (acc_dim_0) int64 888B 0 1 2 3 4 ... 107 108 109 110
  * acc_unobserved_dim_0  (acc_unobserved_dim_0) int64 16B 0 1
  * tasa_dim_0            (tasa_dim_0) int64 888B 0 1 2 3 4 ... 107 108 109 110
Data variables:
    acc                   (chain, draw, acc_dim_0) int64 4MB 4 5 4 0 ... 0 1 0 1
    acc_unobserved        (chain, draw, acc_unobserved_dim_0) int64 64kB 0 ... 2
    pc                    (chain, draw) int64 32kB 1887 1887 1889 ... 1891 1891
    t_0                   (chain, draw) float64 32kB 3.626 3.154 ... 2.858 3.064
    t_1                   (chain, draw) float64 32kB 0.863 1.119 ... 1.074
    tasa                  (chain, draw, tasa_dim_0) float64 4MB 3.626 ... 1.074
Attributes:
    created_at:                 2024-08-02T16:19:11.627219+00:00
    arviz_version:              0.19.0
    inference_library:          pymc
    inference_library_version:  5.15.1
    sampling_time:              2.3183655738830566
    tuning_steps:               1000</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-605e9f0f-ee52-44ea-8161-b7b346642cdd" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-605e9f0f-ee52-44ea-8161-b7b346642cdd" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">acc_dim_0</span>: 111</li><li><span class="xr-has-index">acc_unobserved_dim_0</span>: 2</li><li><span class="xr-has-index">tasa_dim_0</span>: 111</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-5a893e2d-2f8d-4db6-9c36-5766877eee28" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-5a893e2d-2f8d-4db6-9c36-5766877eee28" class="xr-section-summary">Coordinates: <span>(5)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-5b7f7f77-1c10-443e-92c0-21ad874e3a09" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5b7f7f77-1c10-443e-92c0-21ad874e3a09" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b1cbb6be-15f0-44f2-b6ab-e6efdbdfc4ae" class="xr-var-data-in" type="checkbox"><label for="data-b1cbb6be-15f0-44f2-b6ab-e6efdbdfc4ae" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-16e566ce-5d09-4500-9346-cb7dce6850a2" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-16e566ce-5d09-4500-9346-cb7dce6850a2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ac79cefd-1b02-4c6c-8347-f5d6792aaf44" class="xr-var-data-in" type="checkbox"><label for="data-ac79cefd-1b02-4c6c-8347-f5d6792aaf44" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">acc_dim_0</span></div><div class="xr-var-dims">(acc_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 106 107 108 109 110</div><input id="attrs-3caf8922-be4d-4098-8405-e2543b36f842" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-3caf8922-be4d-4098-8405-e2543b36f842" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-332be26d-df08-4de3-b0c7-ffb874230b16" class="xr-var-data-in" type="checkbox"><label for="data-332be26d-df08-4de3-b0c7-ffb874230b16" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">acc_unobserved_dim_0</span></div><div class="xr-var-dims">(acc_unobserved_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1</div><input id="attrs-169998af-791e-47f5-b966-0e2eeceec73c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-169998af-791e-47f5-b966-0e2eeceec73c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-83d564ed-317a-4b18-9729-89b26dfd651a" class="xr-var-data-in" type="checkbox"><label for="data-83d564ed-317a-4b18-9729-89b26dfd651a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">tasa_dim_0</span></div><div class="xr-var-dims">(tasa_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 106 107 108 109 110</div><input id="attrs-7bfa04dc-f7d2-4677-859d-2d59c2fc75f3" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-7bfa04dc-f7d2-4677-859d-2d59c2fc75f3" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-7177e159-7480-4814-9dc1-dd22677b4cb0" class="xr-var-data-in" type="checkbox"><label for="data-7177e159-7480-4814-9dc1-dd22677b4cb0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-2c108446-e45d-4f19-a137-3ff97ff430e2" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-2c108446-e45d-4f19-a137-3ff97ff430e2" class="xr-section-summary">Data variables: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>acc</span></div><div class="xr-var-dims">(chain, draw, acc_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">4 5 4 0 1 4 3 4 ... 0 0 1 0 0 1 0 1</div><input id="attrs-eb6878f2-c4e8-491c-b736-0001e1db1c8d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-eb6878f2-c4e8-491c-b736-0001e1db1c8d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-25fa9185-12e5-443a-92a4-f0fd8a3753d8" class="xr-var-data-in" type="checkbox"><label for="data-25fa9185-12e5-443a-92a4-f0fd8a3753d8" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        ...,
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1]],

       [[4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        ...,
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1]],

       [[4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        ...,
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1]],

       [[4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        ...,
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1],
        [4, 5, 4, ..., 1, 0, 1]]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>acc_unobserved</span></div><div class="xr-var-dims">(chain, draw, acc_unobserved_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 2 0 2 0 2 0 2 ... 6 2 5 2 5 2 6 2</div><input id="attrs-a6db7c34-eb63-4119-9512-bc8f6c6d0673" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a6db7c34-eb63-4119-9512-bc8f6c6d0673" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2370f6f9-8c76-4558-992c-17ed50c42a9b" class="xr-var-data-in" type="checkbox"><label for="data-2370f6f9-8c76-4558-992c-17ed50c42a9b" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[0, 2],
        [0, 2],
        [0, 2],
        ...,
        [1, 1],
        [1, 1],
        [1, 1]],

       [[0, 0],
        [0, 0],
        [0, 0],
        ...,
        [2, 0],
        [2, 0],
        [2, 0]],

       [[1, 1],
        [1, 1],
        [1, 1],
        ...,
        [4, 3],
        [4, 4],
        [2, 4]],

       [[0, 3],
        [0, 3],
        [1, 3],
        ...,
        [5, 2],
        [5, 2],
        [6, 2]]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>pc</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">1887 1887 1889 ... 1892 1891 1891</div><input id="attrs-b157dda5-b071-4082-a402-0a6adca5be3b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b157dda5-b071-4082-a402-0a6adca5be3b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9fda355a-5768-4a6a-8fdf-cb25adc8a32d" class="xr-var-data-in" type="checkbox"><label for="data-9fda355a-5768-4a6a-8fdf-cb25adc8a32d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[1887, 1887, 1889, ..., 1889, 1889, 1889],
       [1887, 1887, 1886, ..., 1893, 1893, 1890],
       [1889, 1890, 1890, ..., 1890, 1892, 1894],
       [1889, 1889, 1889, ..., 1892, 1891, 1891]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>t_0</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">3.626 3.154 3.215 ... 2.858 3.064</div><input id="attrs-c6ccad8c-c51e-4e66-b37e-e7e53fe050e8" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c6ccad8c-c51e-4e66-b37e-e7e53fe050e8" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-fcf9c122-645a-462f-b48c-9c43055ee73c" class="xr-var-data-in" type="checkbox"><label for="data-fcf9c122-645a-462f-b48c-9c43055ee73c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[3.62609622, 3.15358938, 3.21504831, ..., 3.24213146, 3.24458059,
        3.32619297],
       [3.41140371, 2.96600758, 2.93413869, ..., 3.40462424, 2.40233718,
        3.25590635],
       [2.92708336, 2.75116042, 3.6619095 , ..., 3.15104363, 2.85371574,
        2.82202577],
       [3.04951578, 3.00911206, 3.27150806, ..., 2.85126572, 2.85814187,
        3.06443812]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>t_1</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.863 1.119 1.038 ... 0.8535 1.074</div><input id="attrs-31cbf1d8-3f1d-44f2-8d83-1e9b586f6292" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-31cbf1d8-3f1d-44f2-8d83-1e9b586f6292" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-7464137f-13ed-42ab-9a86-667609738966" class="xr-var-data-in" type="checkbox"><label for="data-7464137f-13ed-42ab-9a86-667609738966" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.86299821, 1.11937507, 1.03820933, ..., 1.08729406, 0.73449746,
        0.81363484],
       [0.94353549, 1.10934818, 1.00952674, ..., 0.83546158, 0.91014974,
        0.94228058],
       [0.88137241, 0.83087074, 1.05354979, ..., 1.1700208 , 0.74372701,
        1.0046596 ],
       [0.99897101, 1.00757965, 0.93265556, ..., 1.02012749, 0.85350861,
        1.07387497]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>tasa</span></div><div class="xr-var-dims">(chain, draw, tasa_dim_0)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">3.626 3.626 3.626 ... 1.074 1.074</div><input id="attrs-5b5476a0-5329-4809-b12f-10b2d9ac009f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5b5476a0-5329-4809-b12f-10b2d9ac009f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6ee582d5-be26-4713-af69-b8d0cb41c3b0" class="xr-var-data-in" type="checkbox"><label for="data-6ee582d5-be26-4713-af69-b8d0cb41c3b0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[3.62609622, 3.62609622, 3.62609622, ..., 0.86299821,
         0.86299821, 0.86299821],
        [3.15358938, 3.15358938, 3.15358938, ..., 1.11937507,
         1.11937507, 1.11937507],
        [3.21504831, 3.21504831, 3.21504831, ..., 1.03820933,
         1.03820933, 1.03820933],
        ...,
        [3.24213146, 3.24213146, 3.24213146, ..., 1.08729406,
         1.08729406, 1.08729406],
        [3.24458059, 3.24458059, 3.24458059, ..., 0.73449746,
         0.73449746, 0.73449746],
        [3.32619297, 3.32619297, 3.32619297, ..., 0.81363484,
         0.81363484, 0.81363484]],

       [[3.41140371, 3.41140371, 3.41140371, ..., 0.94353549,
         0.94353549, 0.94353549],
        [2.96600758, 2.96600758, 2.96600758, ..., 1.10934818,
         1.10934818, 1.10934818],
        [2.93413869, 2.93413869, 2.93413869, ..., 1.00952674,
         1.00952674, 1.00952674],
...
        [3.15104363, 3.15104363, 3.15104363, ..., 1.1700208 ,
         1.1700208 , 1.1700208 ],
        [2.85371574, 2.85371574, 2.85371574, ..., 0.74372701,
         0.74372701, 0.74372701],
        [2.82202577, 2.82202577, 2.82202577, ..., 1.0046596 ,
         1.0046596 , 1.0046596 ]],

       [[3.04951578, 3.04951578, 3.04951578, ..., 0.99897101,
         0.99897101, 0.99897101],
        [3.00911206, 3.00911206, 3.00911206, ..., 1.00757965,
         1.00757965, 1.00757965],
        [3.27150806, 3.27150806, 3.27150806, ..., 0.93265556,
         0.93265556, 0.93265556],
        ...,
        [2.85126572, 2.85126572, 2.85126572, ..., 1.02012749,
         1.02012749, 1.02012749],
        [2.85814187, 2.85814187, 2.85814187, ..., 0.85350861,
         0.85350861, 0.85350861],
        [3.06443812, 3.06443812, 3.06443812, ..., 1.07387497,
         1.07387497, 1.07387497]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-08c52eef-007e-4802-b93e-7319d43d8b7a" class="xr-section-summary-in" type="checkbox"><label for="section-08c52eef-007e-4802-b93e-7319d43d8b7a" class="xr-section-summary">Indexes: <span>(5)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-799c33a1-4327-4d22-bd5e-209bf768d36a" class="xr-index-data-in" type="checkbox"><label for="index-799c33a1-4327-4d22-bd5e-209bf768d36a" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-0e18c116-d41b-4780-abd5-c0c6be9c415e" class="xr-index-data-in" type="checkbox"><label for="index-0e18c116-d41b-4780-abd5-c0c6be9c415e" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>acc_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-4d44a729-f178-4ec8-adfb-141ccadbbaf7" class="xr-index-data-in" type="checkbox"><label for="index-4d44a729-f178-4ec8-adfb-141ccadbbaf7" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       101, 102, 103, 104, 105, 106, 107, 108, 109, 110],
      dtype='int64', name='acc_dim_0', length=111))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>acc_unobserved_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-992a3977-7708-41cc-8562-5dc4195ae462" class="xr-index-data-in" type="checkbox"><label for="index-992a3977-7708-41cc-8562-5dc4195ae462" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1], dtype='int64', name='acc_unobserved_dim_0'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>tasa_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-e3f673fa-f872-4e1e-a4e6-3ea35335580a" class="xr-index-data-in" type="checkbox"><label for="index-e3f673fa-f872-4e1e-a4e6-3ea35335580a" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       101, 102, 103, 104, 105, 106, 107, 108, 109, 110],
      dtype='int64', name='tasa_dim_0', length=111))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-4f0fef2a-2078-4960-9ac0-482d8678f28a" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-4f0fef2a-2078-4960-9ac0-482d8678f28a" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-08-02T16:19:11.627219+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>sampling_time :</span></dt><dd>2.3183655738830566</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_log_likelihooda0081940-75a6-4db6-b79b-9a476007e087" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_log_likelihooda0081940-75a6-4db6-b79b-9a476007e087" class="xr-section-summary">log_likelihood</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 3MB
Dimensions:             (chain: 4, draw: 1000, acc_observed_dim_0: 109)
Coordinates:
  * chain               (chain) int64 32B 0 1 2 3
  * draw                (draw) int64 8kB 0 1 2 3 4 5 ... 994 995 996 997 998 999
  * acc_observed_dim_0  (acc_observed_dim_0) int64 872B 0 1 2 3 ... 106 107 108
Data variables:
    acc_observed        (chain, draw, acc_observed_dim_0) float64 3MB -1.652 ...
Attributes:
    created_at:                 2024-08-02T16:19:11.808173+00:00
    arviz_version:              0.19.0
    inference_library:          pymc
    inference_library_version:  5.15.1</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-99124424-74b0-4883-9dba-08a837416350" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-99124424-74b0-4883-9dba-08a837416350" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">acc_observed_dim_0</span>: 109</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-1f8c3f49-2c8b-44d5-84d7-4d65fad90db5" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-1f8c3f49-2c8b-44d5-84d7-4d65fad90db5" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-4d9a2026-a32f-46d0-b375-61a41cad0f7a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-4d9a2026-a32f-46d0-b375-61a41cad0f7a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-7c0af889-d39e-4952-b164-ee0f0b161f51" class="xr-var-data-in" type="checkbox"><label for="data-7c0af889-d39e-4952-b164-ee0f0b161f51" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-5aa03c48-005d-4237-92c8-e3f99b3c14b7" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5aa03c48-005d-4237-92c8-e3f99b3c14b7" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2d0f79a2-2f97-49f7-b87b-83112a01499d" class="xr-var-data-in" type="checkbox"><label for="data-2d0f79a2-2f97-49f7-b87b-83112a01499d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">acc_observed_dim_0</span></div><div class="xr-var-dims">(acc_observed_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 104 105 106 107 108</div><input id="attrs-6ce4f365-e755-4f08-927c-40c8771f246b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-6ce4f365-e755-4f08-927c-40c8771f246b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3fa29b94-ae07-4947-9826-f8b20157b5cc" class="xr-var-data-in" type="checkbox"><label for="data-3fa29b94-ae07-4947-9826-f8b20157b5cc" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-036213ba-3d13-402f-ba67-b22d2b8cd8a7" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-036213ba-3d13-402f-ba67-b22d2b8cd8a7" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>acc_observed</span></div><div class="xr-var-dims">(chain, draw, acc_observed_dim_0)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-1.652 -1.973 ... -1.074 -1.003</div><input id="attrs-ebd8aaca-31eb-416c-bfcc-a0ec366b43e4" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ebd8aaca-31eb-416c-bfcc-a0ec366b43e4" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ca871baf-67db-487d-bd0f-99d8b3e10b83" class="xr-var-data-in" type="checkbox"><label for="data-ca871baf-67db-487d-bd0f-99d8b3e10b83" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[-1.65152346, -1.97280472, -1.65152346, ..., -1.01034087,
         -0.86299821, -1.01034087],
        [-1.73747805, -2.19837467, -1.73747805, ..., -1.00660451,
         -1.11937507, -1.00660451],
        [-1.7217326 , -2.16332813, -1.7217326 , ..., -1.0007119 ,
         -1.03820933, -1.0007119 ],
        ...,
        [-1.7152614 , -2.14846834, -1.7152614 , ..., -1.00360196,
         -1.08729406, -1.00360196],
        [-1.71469005, -2.14714186, -1.71469005, ..., -1.0430662 ,
         -0.73449746, -1.0430662 ],
        [-1.69693321, -2.10454272, -1.69693321, ..., -1.01987845,
         -0.81363484, -1.01987845]],

       [[-1.68096213, -2.0632762 , -1.68096213, ..., -1.00165679,
         -0.94353549, -1.00165679],
        [-1.79519421, -2.31741533, -1.79519421, ..., -1.00557556,
         -1.10934818, -1.00557556],
        [-1.80653673, -2.33956069, -1.80653673, ..., -1.00004509,
         -1.00952674, -1.00004509],
...
        [-1.73816262, -2.19986683, -1.73816262, ..., -1.01299927,
         -1.1700208 , -1.01299927],
        [-1.83728192, -2.39809791, -1.83728192, ..., -1.03980824,
         -0.74372701, -1.03980824],
        [-1.85025966, -2.42224259, -1.85025966, ..., -1.00001082,
         -1.0046596 , -1.00001082]],

       [[-1.76763834, -2.26209344, -1.76763834, ..., -1.00000053,
         -0.99897101, -1.00000053],
        [-1.78058574, -2.28837861, -1.78058574, ..., -1.00002858,
         -1.00757965, -1.00002858],
        [-1.70855765, -2.13274451, -1.70855765, ..., -1.00237488,
         -0.93265556, -1.00237488],
        ...,
        [-1.83826752, -2.39994242, -1.83826752, ..., -1.00019988,
         -1.02012749, -1.00019988],
        [-1.83550883, -2.39477502, -1.83550883, ..., -1.01190826,
         -0.85350861, -1.01190826],
        [-1.76303503, -2.25260871, -1.76303503, ..., -1.0026014 ,
         -1.07387497, -1.0026014 ]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-acccd20e-a4fb-46ab-bf2d-250c724f617a" class="xr-section-summary-in" type="checkbox"><label for="section-acccd20e-a4fb-46ab-bf2d-250c724f617a" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-d9981054-4d28-48bd-8c93-dcb7c7bbff24" class="xr-index-data-in" type="checkbox"><label for="index-d9981054-4d28-48bd-8c93-dcb7c7bbff24" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-53aed145-6269-4b72-a0d7-a68a08ec1cf2" class="xr-index-data-in" type="checkbox"><label for="index-53aed145-6269-4b72-a0d7-a68a08ec1cf2" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>acc_observed_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-58294aaa-af9d-4991-8e35-a6cff317ffcd" class="xr-index-data-in" type="checkbox"><label for="index-58294aaa-af9d-4991-8e35-a6cff317ffcd" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
        99, 100, 101, 102, 103, 104, 105, 106, 107, 108],
      dtype='int64', name='acc_observed_dim_0', length=109))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-cfafafce-3610-434a-a55d-ea885a5578da" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-cfafafce-3610-434a-a55d-ea885a5578da" class="xr-section-summary">Attributes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-08-02T16:19:11.808173+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_sample_statsaf31b287-ed18-4b1b-87a5-bd4c3173dbb5" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_sample_statsaf31b287-ed18-4b1b-87a5-bd4c3173dbb5" class="xr-section-summary">sample_stats</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 688kB
Dimensions:                (chain: 4, draw: 1000, accept_dim_0: 2,
                            accepted_dim_0: 2, scaling_dim_0: 2)
Coordinates:
  * chain                  (chain) int64 32B 0 1 2 3
  * draw                   (draw) int64 8kB 0 1 2 3 4 5 ... 995 996 997 998 999
  * accept_dim_0           (accept_dim_0) int64 16B 0 1
  * accepted_dim_0         (accepted_dim_0) int64 16B 0 1
  * scaling_dim_0          (scaling_dim_0) int64 16B 0 1
Data variables: (12/20)
    accept                 (chain, draw, accept_dim_0) float64 64kB 1.0 ... 0...
    acceptance_rate        (chain, draw) float64 32kB 0.9228 0.7767 ... 0.7077
    accepted               (chain, draw, accepted_dim_0) float64 64kB 1.0 ......
    diverging              (chain, draw) bool 4kB False False ... False False
    energy                 (chain, draw) float64 32kB 178.4 179.6 ... 180.3
    energy_error           (chain, draw) float64 32kB 0.2636 ... -0.09946
    ...                     ...
    reached_max_treedepth  (chain, draw) bool 4kB False False ... False False
    scaling                (chain, draw, scaling_dim_0) float64 64kB 3.221 .....
    smallest_eigval        (chain, draw) float64 32kB nan nan nan ... nan nan
    step_size              (chain, draw) float64 32kB 1.724 1.724 ... 0.9887
    step_size_bar          (chain, draw) float64 32kB 1.139 1.139 ... 1.071
    tree_depth             (chain, draw) int64 32kB 2 2 2 2 2 2 ... 2 2 2 1 2 2
Attributes:
    created_at:                 2024-08-02T16:19:11.639680+00:00
    arviz_version:              0.19.0
    inference_library:          pymc
    inference_library_version:  5.15.1
    sampling_time:              2.3183655738830566
    tuning_steps:               1000</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-0bf176e9-4489-487c-9a37-8f455c9b2a69" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-0bf176e9-4489-487c-9a37-8f455c9b2a69" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">accept_dim_0</span>: 2</li><li><span class="xr-has-index">accepted_dim_0</span>: 2</li><li><span class="xr-has-index">scaling_dim_0</span>: 2</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-c5fa7de3-156c-4e89-9616-03a0c3c2cdaf" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-c5fa7de3-156c-4e89-9616-03a0c3c2cdaf" class="xr-section-summary">Coordinates: <span>(5)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-0b57899f-3f60-4b54-9760-4f7a7a2be2dc" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0b57899f-3f60-4b54-9760-4f7a7a2be2dc" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-0e93205e-cb9f-4645-91dc-c096cadc5559" class="xr-var-data-in" type="checkbox"><label for="data-0e93205e-cb9f-4645-91dc-c096cadc5559" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-0c307698-f7a2-468d-9f58-00be8ac1dd1e" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0c307698-f7a2-468d-9f58-00be8ac1dd1e" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d0adcf78-fa10-48e5-b93c-999b0252ae17" class="xr-var-data-in" type="checkbox"><label for="data-d0adcf78-fa10-48e5-b93c-999b0252ae17" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">accept_dim_0</span></div><div class="xr-var-dims">(accept_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1</div><input id="attrs-08f78a90-55b3-4c51-9d2b-bb5c91d8c3a8" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-08f78a90-55b3-4c51-9d2b-bb5c91d8c3a8" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-36f3c422-7cfd-49cb-9f31-63ee3b0573b1" class="xr-var-data-in" type="checkbox"><label for="data-36f3c422-7cfd-49cb-9f31-63ee3b0573b1" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">accepted_dim_0</span></div><div class="xr-var-dims">(accepted_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1</div><input id="attrs-56d892ae-ee9f-4560-8ef7-639afeebfb37" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-56d892ae-ee9f-4560-8ef7-639afeebfb37" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-aecb6bb3-00fc-4ec5-8b0e-e4a2c14563af" class="xr-var-data-in" type="checkbox"><label for="data-aecb6bb3-00fc-4ec5-8b0e-e4a2c14563af" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">scaling_dim_0</span></div><div class="xr-var-dims">(scaling_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1</div><input id="attrs-eba0896b-57bc-4b36-9c97-8bf472fe5bc3" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-eba0896b-57bc-4b36-9c97-8bf472fe5bc3" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d944d165-7b5a-4a12-b5d8-6ee92b092929" class="xr-var-data-in" type="checkbox"><label for="data-d944d165-7b5a-4a12-b5d8-6ee92b092929" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-87d0d883-af27-45a5-830e-2b75bf2f638e" class="xr-section-summary-in" type="checkbox"><label for="section-87d0d883-af27-45a5-830e-2b75bf2f638e" class="xr-section-summary">Data variables: <span>(20)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>accept</span></div><div class="xr-var-dims">(chain, draw, accept_dim_0)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.0 1.0 1.0 ... 0.002307 0.2685</div><input id="attrs-d75782a6-1ba5-4626-ab3a-ef7f285b2a73" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d75782a6-1ba5-4626-ab3a-ef7f285b2a73" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2f3f1cb4-ffdf-4431-aa64-84cc058ec140" class="xr-var-data-in" type="checkbox"><label for="data-2f3f1cb4-ffdf-4431-aa64-84cc058ec140" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[1.00000000e+00, 1.00000000e+00],
        [1.00000000e+00, 5.00000000e-01],
        [1.07751160e+00, 5.00000000e-01],
        ...,
        [4.31940201e+00, 1.57423770e+00],
        [3.05222576e-02, 5.00000000e-01],
        [6.62027311e-02, 8.25523913e-03]],

       [[9.59371929e-01, 0.00000000e+00],
        [2.18259579e-04, 5.00000000e-01],
        [8.95629042e-01, 6.13768590e-01],
        ...,
        [3.73227808e-01, 5.87822822e-01],
        [7.08670033e-05, 5.00000000e-01],
        [1.81159812e+00, 1.58759339e-02]],

       [[2.30664222e+00, 4.06596957e-01],
        [4.29372932e-01, 5.00000000e-01],
        [1.83665422e-01, 5.57528849e-01],
        ...,
        [8.69336169e-02, 6.31549643e-01],
        [3.71610466e-01, 6.46252600e-01],
        [2.16412024e-01, 1.23676643e+00]],

       [[9.18342500e-02, 3.33979313e-02],
        [9.86860930e-03, 1.24871376e-01],
        [5.31408122e-02, 1.00378983e+00],
        ...,
        [1.00000000e+00, 1.19264887e+00],
        [2.23290367e+00, 1.70828896e-01],
        [2.30698471e-03, 2.68531695e-01]]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>acceptance_rate</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.9228 0.7767 1.0 ... 1.0 0.7077</div><input id="attrs-207aadca-b1b3-4b4e-926e-3d3ff9b91962" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-207aadca-b1b3-4b4e-926e-3d3ff9b91962" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d4b73514-663d-435d-a686-e496ae9498b7" class="xr-var-data-in" type="checkbox"><label for="data-d4b73514-663d-435d-a686-e496ae9498b7" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.92277106, 0.7767203 , 1.        , ..., 0.8067856 , 0.72162054,
        1.        ],
       [1.        , 0.63276109, 1.        , ..., 0.81565131, 0.89756198,
        0.7975073 ],
       [1.        , 0.75852799, 0.85536921, ..., 0.85247546, 0.90929773,
        0.91014643],
       [1.        , 0.99101851, 0.41467517, ..., 0.86763111, 1.        ,
        0.70774038]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>accepted</span></div><div class="xr-var-dims">(chain, draw, accepted_dim_0)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.0 1.0 1.0 0.5 ... 1.0 0.0 0.0 0.5</div><input id="attrs-d4380fdb-76d8-4059-8172-2b7e17bfc57c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d4380fdb-76d8-4059-8172-2b7e17bfc57c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-0099cc19-4c92-458e-be0a-ced9cdb351e3" class="xr-var-data-in" type="checkbox"><label for="data-0099cc19-4c92-458e-be0a-ced9cdb351e3" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[1. , 1. ],
        [1. , 0.5],
        [1. , 0.5],
        ...,
        [1. , 1. ],
        [0. , 0.5],
        [0. , 0. ]],

       [[1. , 0. ],
        [0. , 0.5],
        [1. , 0.5],
        ...,
        [1. , 0.5],
        [0. , 0.5],
        [1. , 0. ]],

       [[1. , 0.5],
        [1. , 0.5],
        [0. , 0.5],
        ...,
        [0. , 1. ],
        [1. , 1. ],
        [1. , 1. ]],

       [[0. , 0. ],
        [0. , 0. ],
        [0. , 1. ],
        ...,
        [1. , 0.5],
        [1. , 0. ],
        [0. , 0.5]]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>diverging</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-c203bf43-3ed7-4b98-a4f1-b2c1a5540567" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c203bf43-3ed7-4b98-a4f1-b2c1a5540567" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-04ecfa88-aff1-4498-b26e-e8390d22c739" class="xr-var-data-in" type="checkbox"><label for="data-04ecfa88-aff1-4498-b26e-e8390d22c739" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">178.4 179.6 177.1 ... 178.3 180.3</div><input id="attrs-f7a4d95d-9f7d-47a1-865c-38d7dd85b0ea" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-f7a4d95d-9f7d-47a1-865c-38d7dd85b0ea" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d24b1a0c-0caa-45f1-80b7-2efbc3a0b746" class="xr-var-data-in" type="checkbox"><label for="data-d24b1a0c-0caa-45f1-80b7-2efbc3a0b746" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[178.41143846, 179.59173694, 177.1351425 , ..., 176.89630037,
        177.99667758, 177.18561892],
       [176.84600092, 177.85074117, 176.9666878 , ..., 179.68836893,
        180.14059585, 179.50668463],
       [176.02268341, 177.38329427, 179.55032141, ..., 183.02157913,
        182.60418822, 183.40238698],
       [177.54752547, 177.45355953, 179.93278057, ..., 178.77479853,
        178.2828962 , 180.28435945]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.2636 -0.1333 ... -0.09946</div><input id="attrs-eaf960f5-cb7e-4dc1-9def-42d19964b69a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-eaf960f5-cb7e-4dc1-9def-42d19964b69a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-40ccf122-83f4-4f30-a3e6-7f2f58f97196" class="xr-var-data-in" type="checkbox"><label for="data-40ccf122-83f4-4f30-a3e6-7f2f58f97196" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 0.26355783, -0.13330973, -0.26240448, ...,  0.24313167,
         0.28330909, -0.24217744],
       [-0.4273274 ,  0.32701495, -0.33620175, ...,  0.19996137,
         0.36717857, -1.20664615],
       [-0.20394846,  0.27637557,  0.44286054, ..., -0.26506457,
         0.31760094, -0.77510954],
       [-0.05506083,  0.02731414,  0.17298595, ...,  0.14198864,
        -0.01235158, -0.09945761]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>index_in_trajectory</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">1 2 1 -1 2 1 -3 ... -3 2 0 -1 -1 2</div><input id="attrs-f68fc3a7-61e6-4939-907a-7421d3cec4f9" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-f68fc3a7-61e6-4939-907a-7421d3cec4f9" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-94b65716-3495-412f-9264-f128315a2027" class="xr-var-data-in" type="checkbox"><label for="data-94b65716-3495-412f-9264-f128315a2027" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 1,  2,  1, ...,  2, -2, -1],
       [-1, -3, -1, ...,  3,  2,  3],
       [-1, -1, -2, ..., -2,  2,  3],
       [-2,  1, -2, ..., -1, -1,  2]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>largest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-0ee79458-1d30-4090-a627-d29d78dc5d18" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0ee79458-1d30-4090-a627-d29d78dc5d18" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3f52db0e-3fa0-4d03-8be9-eadb63556c12" class="xr-var-data-in" type="checkbox"><label for="data-3f52db0e-3fa0-4d03-8be9-eadb63556c12" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>lp</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-178.1 -177.4 ... -177.8 -178.5</div><input id="attrs-f6c15b92-1f38-49a7-8609-6b8ca35a7ab7" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-f6c15b92-1f38-49a7-8609-6b8ca35a7ab7" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9fbb57a5-ea5a-45a3-a059-2141b5a7e963" class="xr-var-data-in" type="checkbox"><label for="data-9fbb57a5-ea5a-45a3-a059-2141b5a7e963" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-178.06471821, -177.36341404, -176.54725471, ..., -176.33919673,
        -177.26311194, -176.26608141],
       [-176.03730645, -177.00447731, -176.41281426, ..., -178.84693934,
        -179.92107947, -176.03922263],
       [-175.65859291, -177.35642617, -179.07588836, ..., -179.48487457,
        -182.41992202, -181.79561482],
       [-177.33561688, -177.40972276, -177.47033385, ..., -178.71915246,
        -177.82876556, -178.52296286]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>max_energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.2636 0.5106 ... -0.07446 0.6935</div><input id="attrs-85f342c4-88be-4cfd-a79d-a57d901a1534" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-85f342c4-88be-4cfd-a79d-a57d901a1534" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a64479e7-0ad0-40bf-b095-247316ecea19" class="xr-var-data-in" type="checkbox"><label for="data-a64479e7-0ad0-40bf-b095-247316ecea19" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 0.26355783,  0.51057924, -0.38363035, ...,  0.36462813,
         0.43043964, -0.24217744],
       [-0.4273274 ,  0.70045505, -0.33620175, ...,  0.42551817,
         0.36717857, -1.20664615],
       [-0.20394846,  0.27637557,  0.44286054, ...,  0.56588886,
        -0.60278095, -0.77510954],
       [-0.08579607, -0.02907607,  2.02675312, ...,  0.14198864,
        -0.07445566,  0.69349068]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>n_steps</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">3.0 3.0 3.0 3.0 ... 3.0 1.0 3.0 3.0</div><input id="attrs-6bd7824f-6d3c-49e8-acb8-fb0f742ee0b1" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-6bd7824f-6d3c-49e8-acb8-fb0f742ee0b1" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ef7ecb1b-5688-4d59-bc88-5a2492fc3897" class="xr-var-data-in" type="checkbox"><label for="data-ef7ecb1b-5688-4d59-bc88-5a2492fc3897" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[3., 3., 3., ..., 3., 3., 1.],
       [1., 3., 1., ..., 3., 3., 3.],
       [1., 1., 3., ..., 3., 3., 3.],
       [3., 3., 3., ..., 1., 3., 3.]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0006013 0.0005818 ... 0.0003287</div><input id="attrs-5c579e21-522d-49b3-af13-8ad7423b7a8b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5c579e21-522d-49b3-af13-8ad7423b7a8b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ad7239e5-bb78-4c2a-b71f-5bae790462c3" class="xr-var-data-in" type="checkbox"><label for="data-ad7239e5-bb78-4c2a-b71f-5bae790462c3" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00060134, 0.00058182, 0.00058483, ..., 0.00053529, 0.00049434,
        0.00019156],
       [0.00020779, 0.00040314, 0.00020041, ..., 0.00040133, 0.00040979,
        0.00041668],
       [0.00030751, 0.00029233, 0.00061115, ..., 0.00036823, 0.00061275,
        0.00038783],
       [0.00051759, 0.00046367, 0.00056353, ..., 0.00017546, 0.00033376,
        0.00032866]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_start</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.692e+04 1.692e+04 ... 1.692e+04</div><input id="attrs-dfb1b6e4-6a24-422f-ba12-f86c0946b17a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-dfb1b6e4-6a24-422f-ba12-f86c0946b17a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b6123800-83b6-4e91-aec1-a7980cb91b5a" class="xr-var-data-in" type="checkbox"><label for="data-b6123800-83b6-4e91-aec1-a7980cb91b5a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[16921.19914671, 16921.20026762, 16921.20133902, ...,
        16922.0759968 , 16922.07697024, 16922.0779023 ],
       [16921.06635821, 16921.06692785, 16921.06769374, ...,
        16921.91833208, 16921.91910158, 16921.91989096],
       [16921.15628195, 16921.1571134 , 16921.15792593, ...,
        16922.13891592, 16922.13974411, 16922.14079791],
       [16921.22213789, 16921.2232456 , 16921.22431001, ...,
        16922.19715298, 16922.19763771, 16922.19827244]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>process_time_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0006013 0.0005818 ... 0.0003286</div><input id="attrs-780550ad-8a48-4740-8d3f-5e1cdfbc1a6e" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-780550ad-8a48-4740-8d3f-5e1cdfbc1a6e" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-7818c35e-881e-4996-abe4-09b5fa0f7910" class="xr-var-data-in" type="checkbox"><label for="data-7818c35e-881e-4996-abe4-09b5fa0f7910" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00060134, 0.00058181, 0.00058481, ..., 0.0005352 , 0.00049442,
        0.00019134],
       [0.00020763, 0.00040309, 0.00020028, ..., 0.00040129, 0.00040975,
        0.00041666],
       [0.0003074 , 0.00029235, 0.00061113, ..., 0.00036814, 0.00061275,
        0.00038765],
       [0.00051763, 0.00046352, 0.00056355, ..., 0.00017539, 0.00033371,
        0.00032856]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>reached_max_treedepth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-4af93394-b5ff-41dc-903d-6f670194a829" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-4af93394-b5ff-41dc-903d-6f670194a829" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2d8a2020-04e2-48cb-b764-6c1a2b7c3d8d" class="xr-var-data-in" type="checkbox"><label for="data-2d8a2020-04e2-48cb-b764-6c1a2b7c3d8d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>scaling</span></div><div class="xr-var-dims">(chain, draw, scaling_dim_0)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">3.221 2.35 3.221 ... 3.221 2.536</div><input id="attrs-3b549885-883e-4bd4-8385-a09411b22959" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-3b549885-883e-4bd4-8385-a09411b22959" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-22558d1a-58fe-4120-8e3c-07764a937918" class="xr-var-data-in" type="checkbox"><label for="data-22558d1a-58fe-4120-8e3c-07764a937918" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[3.22102   , 2.3498805 ],
        [3.22102   , 2.3498805 ],
        [3.22102   , 2.3498805 ],
        ...,
        [3.22102   , 2.3498805 ],
        [3.22102   , 2.3498805 ],
        [3.22102   , 2.3498805 ]],

       [[3.22102   , 2.6573415 ],
        [3.22102   , 2.6573415 ],
        [3.22102   , 2.6573415 ],
        ...,
        [3.22102   , 2.6573415 ],
        [3.22102   , 2.6573415 ],
        [3.22102   , 2.6573415 ]],

       [[2.9282    , 2.53589441],
        [2.9282    , 2.53589441],
        [2.9282    , 2.53589441],
        ...,
        [2.9282    , 2.53589441],
        [2.9282    , 2.53589441],
        [2.9282    , 2.53589441]],

       [[3.22102   , 2.53589441],
        [3.22102   , 2.53589441],
        [3.22102   , 2.53589441],
        ...,
        [3.22102   , 2.53589441],
        [3.22102   , 2.53589441],
        [3.22102   , 2.53589441]]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>smallest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-3e0ace28-74f3-4b6c-950c-e5fa4bd4af0b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-3e0ace28-74f3-4b6c-950c-e5fa4bd4af0b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-1ba75943-dd7a-4e28-b32d-434e6233f00f" class="xr-var-data-in" type="checkbox"><label for="data-1ba75943-dd7a-4e28-b32d-434e6233f00f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.724 1.724 1.724 ... 0.9887 0.9887</div><input id="attrs-aba1fdb2-f305-443a-84d5-619977e3bb42" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-aba1fdb2-f305-443a-84d5-619977e3bb42" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f029f664-20e8-4398-aae7-8977f4780905" class="xr-var-data-in" type="checkbox"><label for="data-f029f664-20e8-4398-aae7-8977f4780905" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[1.72357069, 1.72357069, 1.72357069, ..., 1.72357069, 1.72357069,
        1.72357069],
       [1.2359314 , 1.2359314 , 1.2359314 , ..., 1.2359314 , 1.2359314 ,
        1.2359314 ],
       [1.3423228 , 1.3423228 , 1.3423228 , ..., 1.3423228 , 1.3423228 ,
        1.3423228 ],
       [0.98866571, 0.98866571, 0.98866571, ..., 0.98866571, 0.98866571,
        0.98866571]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size_bar</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.139 1.139 1.139 ... 1.071 1.071</div><input id="attrs-e393f2ea-36e8-4b6d-869d-9407038cd922" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e393f2ea-36e8-4b6d-869d-9407038cd922" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-fa86fca4-0f63-44d6-910a-287d24d9363f" class="xr-var-data-in" type="checkbox"><label for="data-fa86fca4-0f63-44d6-910a-287d24d9363f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[1.13858127, 1.13858127, 1.13858127, ..., 1.13858127, 1.13858127,
        1.13858127],
       [1.15412385, 1.15412385, 1.15412385, ..., 1.15412385, 1.15412385,
        1.15412385],
       [1.13254671, 1.13254671, 1.13254671, ..., 1.13254671, 1.13254671,
        1.13254671],
       [1.07082605, 1.07082605, 1.07082605, ..., 1.07082605, 1.07082605,
        1.07082605]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>tree_depth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">2 2 2 2 2 2 2 2 ... 2 2 2 2 2 1 2 2</div><input id="attrs-bc9fbc73-9fcf-446e-a602-7cbf2fd116ac" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-bc9fbc73-9fcf-446e-a602-7cbf2fd116ac" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-979fc72f-c520-4e2d-b6e8-39d830765b4c" class="xr-var-data-in" type="checkbox"><label for="data-979fc72f-c520-4e2d-b6e8-39d830765b4c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2, 2, 2, ..., 2, 2, 1],
       [1, 2, 1, ..., 2, 2, 2],
       [1, 1, 2, ..., 2, 2, 2],
       [2, 2, 2, ..., 1, 2, 2]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-924d5e06-c0c7-4064-819c-a93690d4c3f7" class="xr-section-summary-in" type="checkbox"><label for="section-924d5e06-c0c7-4064-819c-a93690d4c3f7" class="xr-section-summary">Indexes: <span>(5)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-e243a9cd-515a-496d-9c34-6c2a60a5576d" class="xr-index-data-in" type="checkbox"><label for="index-e243a9cd-515a-496d-9c34-6c2a60a5576d" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-bfbd1b57-563a-48f0-8bc3-a479e17df315" class="xr-index-data-in" type="checkbox"><label for="index-bfbd1b57-563a-48f0-8bc3-a479e17df315" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>accept_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-baef5c68-adb0-4b1a-bae1-8ff2cababab7" class="xr-index-data-in" type="checkbox"><label for="index-baef5c68-adb0-4b1a-bae1-8ff2cababab7" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1], dtype='int64', name='accept_dim_0'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>accepted_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-7ce09d10-1b5c-4586-93b9-c79c0c105502" class="xr-index-data-in" type="checkbox"><label for="index-7ce09d10-1b5c-4586-93b9-c79c0c105502" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1], dtype='int64', name='accepted_dim_0'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>scaling_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-c2ac0513-221e-4b2e-98c3-944d0557d17a" class="xr-index-data-in" type="checkbox"><label for="index-c2ac0513-221e-4b2e-98c3-944d0557d17a" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1], dtype='int64', name='scaling_dim_0'))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-24d82f0e-045f-4d4c-b109-1992e7016e06" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-24d82f0e-045f-4d4c-b109-1992e7016e06" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-08-02T16:19:11.639680+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>sampling_time :</span></dt><dd>2.3183655738830566</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_observed_data4b4178eb-ab4b-42aa-9ecf-ad643f632408" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_observed_data4b4178eb-ab4b-42aa-9ecf-ad643f632408" class="xr-section-summary">observed_data</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 2kB
Dimensions:             (acc_observed_dim_0: 109)
Coordinates:
  * acc_observed_dim_0  (acc_observed_dim_0) int64 872B 0 1 2 3 ... 106 107 108
Data variables:
    acc_observed        (acc_observed_dim_0) int64 872B 4 5 4 0 1 ... 0 0 1 0 1
Attributes:
    created_at:                 2024-08-02T16:19:11.643621+00:00
    arviz_version:              0.19.0
    inference_library:          pymc
    inference_library_version:  5.15.1</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-2e7b2f36-79a8-49e4-8d7f-71143354316b" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-2e7b2f36-79a8-49e4-8d7f-71143354316b" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">acc_observed_dim_0</span>: 109</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-9242c478-6330-48e9-895e-67c991617a8b" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-9242c478-6330-48e9-895e-67c991617a8b" class="xr-section-summary">Coordinates: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">acc_observed_dim_0</span></div><div class="xr-var-dims">(acc_observed_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 104 105 106 107 108</div><input id="attrs-a63a50d8-501f-4016-84f6-872fab553563" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a63a50d8-501f-4016-84f6-872fab553563" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6fd1b68f-2f1b-444d-bb2d-9f238ccc97bb" class="xr-var-data-in" type="checkbox"><label for="data-6fd1b68f-2f1b-444d-bb2d-9f238ccc97bb" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-eb7da98e-96dd-4c16-b52b-429ce208fb25" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-eb7da98e-96dd-4c16-b52b-429ce208fb25" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>acc_observed</span></div><div class="xr-var-dims">(acc_observed_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">4 5 4 0 1 4 3 4 ... 0 0 1 0 0 1 0 1</div><input id="attrs-72d021ed-a9a9-4d45-975b-a0ce5739b56e" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-72d021ed-a9a9-4d45-975b-a0ce5739b56e" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-4fc96d56-f004-44e8-8a5b-0d200edfa00e" class="xr-var-data-in" type="checkbox"><label for="data-4fc96d56-f004-44e8-8a5b-0d200edfa00e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([4, 5, 4, 0, 1, 4, 3, 4, 0, 6, 3, 3, 4, 0, 2, 6, 3, 3, 5, 4, 5, 3,
       1, 4, 4, 1, 5, 5, 3, 4, 2, 5, 2, 2, 3, 4, 2, 1, 3, 2, 1, 1, 1, 1,
       3, 0, 0, 1, 0, 1, 1, 0, 0, 3, 1, 0, 3, 2, 2, 0, 1, 1, 1, 0, 1, 0,
       1, 0, 0, 0, 2, 1, 0, 0, 0, 1, 1, 0, 2, 3, 3, 1, 2, 1, 1, 1, 1, 2,
       4, 2, 0, 0, 1, 4, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-192c95bb-192e-47b6-8201-ba206d981d73" class="xr-section-summary-in" type="checkbox"><label for="section-192c95bb-192e-47b6-8201-ba206d981d73" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>acc_observed_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-6702a0d2-355f-43ec-9911-ebe3f435a7ba" class="xr-index-data-in" type="checkbox"><label for="index-6702a0d2-355f-43ec-9911-ebe3f435a7ba" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
        99, 100, 101, 102, 103, 104, 105, 106, 107, 108],
      dtype='int64', name='acc_observed_dim_0', length=109))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-04433493-0fbf-48a9-9c27-8a516b5e0322" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-04433493-0fbf-48a9-9c27-8a516b5e0322" class="xr-section-summary">Attributes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-08-02T16:19:11.643621+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
              </ul>
            </div>
            <style> /* CSS stylesheet for displaying InferenceData objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-sections.group-sections {
  grid-template-columns: auto;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
.xr-wrap{width:700px!important;} </style>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>ax <span class="op">=</span> az.plot_posterior(idata_cat, var_names<span class="op">=</span>[<span class="st">"~tasa"</span>, <span class="st">"~acc"</span>], figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Programación_probabilística_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-28" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>az.summary(idata_cat, kind<span class="op">=</span><span class="st">"stats"</span>, var_names<span class="op">=</span>[<span class="st">"~tasa"</span>, <span class="st">"~acc"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sd</th>
<th data-quarto-table-cell-role="th">hdi_3%</th>
<th data-quarto-table-cell-role="th">hdi_97%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">acc_unobserved[0]</td>
<td>2.074</td>
<td>1.799</td>
<td>0.000</td>
<td>5.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">acc_unobserved[1]</td>
<td>0.986</td>
<td>1.028</td>
<td>0.000</td>
<td>3.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">pc</td>
<td>1889.783</td>
<td>2.406</td>
<td>1886.000</td>
<td>1894.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">t_0</td>
<td>3.088</td>
<td>0.283</td>
<td>2.552</td>
<td>3.606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">t_1</td>
<td>0.929</td>
<td>0.116</td>
<td>0.712</td>
<td>1.149</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>tasa_mean <span class="op">=</span> idata_cat.posterior[<span class="st">"tasa"</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a>tasa_hdi <span class="op">=</span> az.hdi(idata_cat.posterior[<span class="st">"tasa"</span>].values)</span>
<span id="cb18-3"><a href="#cb18-3"></a>pc_hdi <span class="op">=</span> az.hdi(idata_cat.posterior[<span class="st">"pc"</span>])[<span class="st">"pc"</span>]</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a>ax.plot(años, accidentes, <span class="st">"."</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a>ax.set_ylabel(<span class="st">"Número de accidentes"</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a>ax.set_xlabel(<span class="st">"Año"</span>)</span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a>ax.vlines(</span>
<span id="cb18-12"><a href="#cb18-12"></a>    idata_cat.posterior[<span class="st">"pc"</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>)),</span>
<span id="cb18-13"><a href="#cb18-13"></a>    accidentes.<span class="bu">min</span>(),</span>
<span id="cb18-14"><a href="#cb18-14"></a>    accidentes.<span class="bu">max</span>(),</span>
<span id="cb18-15"><a href="#cb18-15"></a>    color<span class="op">=</span><span class="st">"C1"</span>,</span>
<span id="cb18-16"><a href="#cb18-16"></a>    lw<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb18-17"><a href="#cb18-17"></a>)</span>
<span id="cb18-18"><a href="#cb18-18"></a></span>
<span id="cb18-19"><a href="#cb18-19"></a></span>
<span id="cb18-20"><a href="#cb18-20"></a>ax.fill_betweenx(</span>
<span id="cb18-21"><a href="#cb18-21"></a>    [accidentes.<span class="bu">min</span>(), accidentes.<span class="bu">max</span>()], pc_hdi[<span class="dv">0</span>], pc_hdi[<span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">"C1"</span></span>
<span id="cb18-22"><a href="#cb18-22"></a>)</span>
<span id="cb18-23"><a href="#cb18-23"></a>ax.plot(años, tasa_mean, <span class="st">"k"</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb18-24"><a href="#cb18-24"></a>ax.fill_between(años, tasa_hdi[:, <span class="dv">0</span>], tasa_hdi[:, <span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">"k"</span>)</span>
<span id="cb18-25"><a href="#cb18-25"></a></span>
<span id="cb18-26"><a href="#cb18-26"></a></span>
<span id="cb18-27"><a href="#cb18-27"></a>faltante0 <span class="op">=</span> (</span>
<span id="cb18-28"><a href="#cb18-28"></a>    idata_cat.posterior[<span class="st">"acc_unobserved"</span>].sel(acc_unobserved_dim_0<span class="op">=</span><span class="dv">0</span>).mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb18-29"><a href="#cb18-29"></a>)</span>
<span id="cb18-30"><a href="#cb18-30"></a>faltante1 <span class="op">=</span> (</span>
<span id="cb18-31"><a href="#cb18-31"></a>    idata_cat.posterior[<span class="st">"acc_unobserved"</span>].sel(acc_unobserved_dim_0<span class="op">=</span><span class="dv">1</span>).mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb18-32"><a href="#cb18-32"></a>)</span>
<span id="cb18-33"><a href="#cb18-33"></a></span>
<span id="cb18-34"><a href="#cb18-34"></a>ax.plot(años[np.isnan(accidentes)], [faltante0, faltante1], <span class="st">"C2s"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Programación_probabilística_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="comparando-grupos" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="comparando-grupos"><span class="header-section-number">2.2</span> Comparando grupos</h2>
<p>Una tarea común al analizar datos es comparar grupos. Podríamos estar interesados en analizar los resultados de un ensayo clínico donde se busca medir la efectividad de una droga, o la reducción de la cantidad de accidentes de tránsito al introducir un cambio en las regulaciones de tránsito, o el desempeño de estudiantes bajo diferentes aproximaciones pedagógicas, etc. Este tipo de preguntas se suele resolver en el marco de lo que se conoce como pruebas de hipótesis que busca declarar si una observación es estadísticamente significativa o no. Nosotros tomaremos una ruta alternativa.</p>
<p>Al comparar grupos debemos decidir que característica(s) vamos a usar. Una característica común es la media de cada grupo. En ese caso podemos calcular la distribución <em>a posteriori</em> de la diferencia entre medias. Para ayudarnos a entender este posterior usaremos 3 herramientas:</p>
<ul>
<li>Un <em>posteriorplot</em> con un valor de referencia</li>
<li>Una medida llamada <em>d de Cohen</em></li>
<li>La probabilidad de superioridad</li>
</ul>
<p>En el capítulo anterior ya vimos un ejemplo de cómo usar <em>posteriorplot</em> con un valor de referencia, pronto veremos otro ejemplo. Las novedades aquí son el d de Cohen y la probabilidad de superioridad, dos maneras populares de expresar el tamaño del efecto.</p>
<section id="d-de-cohen" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="d-de-cohen"><span class="header-section-number">2.2.1</span> d de Cohen</h3>
<p>Una medida muy común, al menos en ciertas disciplinas, para cuantificar el tamaño del efecto es el d de Cohen</p>
<p><span class="math display">\[
\frac{\mu_2 - \mu_1}{\sqrt{\frac{\sigma_2^2 + \sigma_1^2}{2}}}
\]</span></p>
<p>De acuerdo con esta expresión, el tamaño del efecto es la diferencia de las medias con respecto a la desviación estándar combinada de ambos grupos. Ya que es posible obtener una distribución <em>a posteriori</em> de medias y de desviaciones estándar, también es posible calcular una distribución <em>a posteriori</em> de los valores d de Cohen. Por supuesto, si sólo necesitamos o queremos una estimación puntual, podríamos calcular la media de esa distribución <em>a posteriori</em>. En general, al calcular una desviación estándar combinada, se toma en cuenta el tamaño de la muestra de cada grupo explícitamente, pero la ecuación de <em>d de Cohen</em> omite el tamaño de la muestra, la razón es que tomamos estos valores del <em>posterior</em> (por lo que ya estamos considerando la incertidumbre de las desviaciones estándar).</p>
<blockquote class="blockquote">
<p>Un d de Cohen es una forma de medir el tamaño del efecto donde la diferencia de las medias se estandariza al considerar las desviaciones estándar de ambos grupos.</p>
</blockquote>
<p>Cohen introduce la variabilidad de cada grupo al usar sus desviaciones estándar. Esto es realmente importante, una diferencia de 1 cuando la desviación estándar es de 0.1 es muy grande en comparación con la misma diferencia cuando la desviación estándar es 10. Además, un cambio de x unidades de un grupo respecto del otro podría explicarse por cada punto <em>desplazándose</em> exactamente x unidades o la mitad de los puntos sin cambiar mientras la otra mitad cambia 2x unidades, y así con otras combinaciones. Por lo tanto, incluir las variaciones intrínsecas de los grupos es una forma de poner las diferencias en contexto. Re-escalar (estandarizar) las diferencias nos ayuda a dar sentido a la diferencia entre grupos y facilita evaluar si el cambio es importante, incluso cuando no estamos muy familiarizados con la escala utilizada para las mediciones.</p>
<p>Un d de Cohen se puede interpretar como un Z-score. Un Z-score es la cantidad de desviaciones estándar que un valor difiere del valor medio de lo que se está observando o midiendo, puede ser positivo o negativo dependiendo de si la diferencia es por exceso o por defecto. Por lo tanto, un d de Cohen de -1.2, indica que la media de un grupo está 1.2 desviación estándar por debajo de la media del otro grupo.</p>
<p>Incluso con las diferencias de medias estandarizadas, puede ser necesario tener que <em>calibrarnos</em> en función del contexto de un problema determinado para poder decir si un valor de d de Cohen es <em>grande</em>, <em>pequeño</em>, <em>mediano</em>, <em>importante</em>, <em>despreciable</em>, etc. Afortunadamente, esta calibración se puede adquirir con la práctica, a modo de ejemplo si estamos acostumbrados a realizar varios análisis para más o menos el mismo tipo de problemas, podemos acostumbrarnos a un d de Cohen de entre 0.8 y 1.2, de modo que si obtenemos un valor de 2 podría ser que estamos frente a algo importante, inusual (¡o un error!). Una alternativa es consultar con expertos en el tema.</p>
<p>Una muy buena página web para explorar cómo se ven los diferentes valores de Cohen’s es http://rpsychologist.com/d3/cohend. En esa página, también encontrarán otras formas de expresar el tamaño del efecto; algunas de ellos podrían ser más intuitivas, como la probabilidad de superioridad que analizaremos a continuación.</p>
</section>
<section id="probabilidad-de-superioridad" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="probabilidad-de-superioridad"><span class="header-section-number">2.2.2</span> Probabilidad de superioridad</h3>
<p>Esta es otra forma de informar el tamaño del efecto y se define como la probabilidad que un dato tomado al azar de un grupo tenga un valor mayor que un punto tomado al azar del otro grupo. Si suponemos que los datos que estamos utilizando se distribuyen de forma Gaussiana, podemos calcular la probabilidad de superioridad a partir de la d de Cohen usando la expresión:</p>
<p><span class="math display">\[\begin{equation} \label{eq_ps}
ps = \Phi \left ( \frac{\delta}{\sqrt{2}} \right)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\Phi\)</span> es la distribución normal acumulada y <span class="math inline">\(\delta\)</span> es el d de Cohen. Podemos calcular una estimación puntual de la probabilidad de superioridad (lo que generalmente se informa) o podemos calcular la distribución <em>a posteriori</em>. Si no estamos de acuerdo con la suposición de normalidad, podemos descartar esta fórmula y calcularla directamente a partir del <em>posterior</em> sin necesidad de asumir ninguna distribución. Esta es una de las ventajas de usar métodos de muestreo para estimar el <em>a posteriori</em>, una vez obtenidas las muestras lo que podemos hacer con ellas es muy flexible.</p>
</section>
<section id="el-conjunto-de-datos-propinas" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="el-conjunto-de-datos-propinas"><span class="header-section-number">2.2.3</span> El conjunto de datos <em>propinas</em></h3>
<p>Para explorar el tema de esta sección, vamos a usar el conjunto de datos tips (propinas). Estos datos fueron informados por primera vez por Bryant, P. G. and Smith, M (1995) <em>Practical Data Analysis: Case Studies in Business Statistics</em>.</p>
<p>Queremos estudiar el efecto del día de la semana sobre la cantidad de propinas en un restaurante. Para este ejemplo, los diferentes grupos son los días. Comencemos el análisis cargando el conjunto de datos como un DataFrame de Pandas usando solo una línea de código. Si no está familiarizado con Pandas, el comando <em>tail</em> se usa para mostrar las últimas filas de un DataFrame:</p>
<div id="cell-33" class="cell" data-scrolled="true" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>tips <span class="op">=</span> pd.read_csv(<span class="st">"datos/propinas.csv"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>tips.tail()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">total_cuenta</th>
<th data-quarto-table-cell-role="th">propina</th>
<th data-quarto-table-cell-role="th">genero</th>
<th data-quarto-table-cell-role="th">fumador</th>
<th data-quarto-table-cell-role="th">dia</th>
<th data-quarto-table-cell-role="th">tiempo</th>
<th data-quarto-table-cell-role="th">cantidad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">239</td>
<td>29.03</td>
<td>5.92</td>
<td>Hombre</td>
<td>No</td>
<td>Sab</td>
<td>Cena</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">240</td>
<td>27.18</td>
<td>2.00</td>
<td>Mujer</td>
<td>Si</td>
<td>Sab</td>
<td>Cena</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">241</td>
<td>22.67</td>
<td>2.00</td>
<td>Hombre</td>
<td>Si</td>
<td>Sab</td>
<td>Cena</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">242</td>
<td>17.82</td>
<td>1.75</td>
<td>Hombre</td>
<td>No</td>
<td>Sab</td>
<td>Cena</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">243</td>
<td>18.78</td>
<td>3.00</td>
<td>Mujer</td>
<td>No</td>
<td>Jue</td>
<td>Cena</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Para este ejemplo solo vamos a usar las columnas <code>dia</code> y <code>propina</code> y vamos a usar la función <code>plot_forest</code> de ArviZ. Aún cuando ArviZ está pensado para análisis de modelos Bayesianos algunos de sus funciones pueden ser útiles para analizar datos.</p>
<div id="cell-35" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>az.plot_forest(</span>
<span id="cb20-2"><a href="#cb20-2"></a>    tips.pivot(columns<span class="op">=</span><span class="st">"dia"</span>, values<span class="op">=</span><span class="st">"propina"</span>).to_dict(<span class="st">"list"</span>),</span>
<span id="cb20-3"><a href="#cb20-3"></a>    kind<span class="op">=</span><span class="st">"ridgeplot"</span>,</span>
<span id="cb20-4"><a href="#cb20-4"></a>    hdi_prob<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb20-5"><a href="#cb20-5"></a>    figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>),</span>
<span id="cb20-6"><a href="#cb20-6"></a>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Programación_probabilística_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A fin de simplificar el análisis vamos a crear 2 variables: * La variable <code>categories</code> contiene los nombres de los días (abreviados) * La variable <code>idx</code> codifica los días de la semana como enteros entre 0 y 3.</p>
<div id="cell-37" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>categories <span class="op">=</span> np.array([<span class="st">"Jue"</span>, <span class="st">"Vie"</span>, <span class="st">"Sab"</span>, <span class="st">"Dom"</span>])</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a>tip <span class="op">=</span> tips[<span class="st">"propina"</span>].values</span>
<span id="cb21-4"><a href="#cb21-4"></a>idx <span class="op">=</span> pd.Categorical(tips[<span class="st">"dia"</span>], categories<span class="op">=</span>categories).codes</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para este modelo necesitamos definir 4 grupos, uno por cada dia. Supongamos que cada grupo lo queremos representar como una distribución Gamma con media <span class="math inline">\(\mu\)</span> y desviación estándar <span class="math inline">\(\sigma\)</span>. En ese caso vamos a necesitar definir 4 medias y 4 desviaciones estándar. Una versión <code>naive</code> sería escribir 8 distribuciones a priori. Algo como esto:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> comparación_grupos:</span>
<span id="cb22-2"><a href="#cb22-2"></a>    μ<span class="dv">0</span> <span class="op">=</span> pm.Normal(<span class="st">'μ0'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a>    μ<span class="dv">1</span> <span class="op">=</span> pm.Normal(<span class="st">'μ1'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a>    μ<span class="dv">2</span> <span class="op">=</span> pm.Normal(<span class="st">'μ2'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb22-5"><a href="#cb22-5"></a>    μ<span class="dv">3</span> <span class="op">=</span> pm.Normal(<span class="st">'μ3'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb22-6"><a href="#cb22-6"></a>    σ<span class="dv">0</span> <span class="op">=</span> pm.HalfNormal(<span class="st">'σ0'</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7"></a>    σ<span class="dv">1</span> <span class="op">=</span> pm.HalfNormal(<span class="st">'σ1'</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-8"><a href="#cb22-8"></a>    σ<span class="dv">2</span> <span class="op">=</span> pm.HalfNormal(<span class="st">'σ2'</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-9"><a href="#cb22-9"></a>    σ<span class="dv">3</span> <span class="op">=</span> pm.HalfNormal(<span class="st">'σ3'</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a>    </span>
<span id="cb22-11"><a href="#cb22-11"></a>    ....</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Esto es sintáticamennte posible y semánticamente correcto (es lo que hicimos en el modelo de los accidentes mineros). Pero repetir código es en generl una muy mala práctica que dificulta la lectura del código/modelo y dificulta hacer cambios a futuro. Una forma de no repetir código es escribir <code>for loops</code>. Pero en PyMC (como en NumPy y otras librerías de Python) lo que conviene es vectorizar el código. Para ello podemos especificar el argumento <code>shape</code> para los priors <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span>. El modelo completo nos quedaría de la siguiente manera:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> comparing_groups:</span>
<span id="cb23-2"><a href="#cb23-2"></a>    μ <span class="op">=</span> pm.Normal(<span class="st">'μ'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">5</span>, shape<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">'σ'</span>, sigma<span class="op">=</span><span class="dv">1</span>, shape<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a>    </span>
<span id="cb23-5"><a href="#cb23-5"></a>    y <span class="op">=</span> pm.Gamma(<span class="st">"y"</span>, mu<span class="op">=</span>μ[idx], sigma<span class="op">=</span>σ[idx], observed<span class="op">=</span>tip)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Es importante notar que estamos especificando 4 valores independiente de <span class="math inline">\(\mu\)</span> y cuatro valores independientes de <span class="math inline">\(\sigma\)</span> y que <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> son vectores de dimensión 4.Fijensé que para el likelihood usamos la variable <code>idx</code> para indexar de forma adecuada <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> para asegurar que usamos los parámetros correctos para cada grupo.</p>
<p>Usar shapes es correcto, pero PyMC provee una sintaxis alternativa que a veces es más conveniente. Esta sintaxis consiste en especificar coordenadas y dimensiones. La ventaja de esto es que permite una mejor integración con ArviZ. Veamos, en este ejemplo tenemos 4 valores para las medias y 4 para las desviaciones estándar, y por eso usamos <code>shape=4</code>. El InferenceData tendrá 4 indices <code>0, 1, 2, 3</code> correspondientes a cada uno de los 4 días. Pero es trabajo del usuario asociar esos indices numéricos con los días. En cambio al usar coordenadas y dimensiones nosotros podremos usar los rótulos <code>'Jue', 'Vie', 'Sab', 'Dom'</code> para referirnos a los parámetros relacionados con cada uno de estos días. ArviZ también podrá hacer uso de estos rótulos. Referirse a “rotulos” y no a indices, suele ser más simple y contribuye a evitar errores.</p>
<p>Vamos a especificar dos coordenadas <code>dias</code> con las dimensiones <code>'Jue', 'Vie', 'Sab', 'Dom'</code> y <code>dias_flat</code> que contendrá los mismo rótulos pero repetidos según el orden y longitud que corresponda con cada observación. Esto último será útil para poder obtener pruebas predictivas a posteriori para cada día.</p>
<div id="cell-39" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>coords <span class="op">=</span> {<span class="st">"dias"</span>: categories, <span class="st">"dias_flat"</span>: categories[idx]}</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="cf">with</span> pm.Model(coords<span class="op">=</span>coords) <span class="im">as</span> comparing_groups:</span>
<span id="cb24-4"><a href="#cb24-4"></a>    μ <span class="op">=</span> pm.HalfNormal(<span class="st">"μ"</span>, sigma<span class="op">=</span><span class="dv">5</span>, dims<span class="op">=</span><span class="st">"dias"</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">"σ"</span>, sigma<span class="op">=</span><span class="dv">1</span>, dims<span class="op">=</span><span class="st">"dias"</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a></span>
<span id="cb24-7"><a href="#cb24-7"></a>    y <span class="op">=</span> pm.Gamma(<span class="st">"y"</span>, mu<span class="op">=</span>μ[idx], sigma<span class="op">=</span>σ[idx], observed<span class="op">=</span>tip, dims<span class="op">=</span><span class="st">"dias_flat"</span>)</span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a>    idata_cg <span class="op">=</span> pm.sample()</span>
<span id="cb24-10"><a href="#cb24-10"></a>    idata_cg.extend(pm.sample_posterior_predictive(idata_cg))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [μ, σ]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.
Sampling: [y]</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"21e274dbe24f4df5bec82d6bf37c1bf8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"025bf951cd76496092772b7babd70a4d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>Una vez obtenido un <em>a posteriori</em> podemos hacer todos los análisis que creamos pertinentes con el. Primero hagamos una prueba predictiva a posteriori. Vemos que en general somos capaces de capturar la forma general de las distribuciones, pero hay detalles que se nos escapan. Esto puede deberse al tamaño relativamente pequeño de la muestra, a que hay otros factores además del día que tienen influencia en las propinas o una combinación de ambas. Por ahora seguiremos con el análisis considerando que el modelo es lo suficientemente bueno</p>
<div id="cell-41" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>az.plot_ppc(</span>
<span id="cb26-3"><a href="#cb26-3"></a>    idata_cg,</span>
<span id="cb26-4"><a href="#cb26-4"></a>    num_pp_samples<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb26-5"><a href="#cb26-5"></a>    coords<span class="op">=</span>{<span class="st">"dias_flat"</span>: [categories]},</span>
<span id="cb26-6"><a href="#cb26-6"></a>    flatten<span class="op">=</span>[],</span>
<span id="cb26-7"><a href="#cb26-7"></a>    ax<span class="op">=</span>axes,</span>
<span id="cb26-8"><a href="#cb26-8"></a>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Programación_probabilística_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Podemos ver la distribución de cada uno de los parámetros haciendo</p>
<div id="cell-43" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>az.plot_posterior(idata_cg, var_names<span class="op">=</span><span class="st">"μ"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">3</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Programación_probabilística_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>La figura anterior es bastante informativa, por ejemplo vemos que los valores medios de las propinas difieren en solo unos pocos centavos y que para los domingos el valor es ligeramente más alto que para el resto de los días analizados.</p>
<p>Pero quizá consideramos que puede ser mejor mostrar los datos de otra forma. Por ejemplo podemos calcular todas las diferencias de medias <em>a posteriori</em> entre si. Además podríamos querer usar alguna medida del tamaño del efecto que sea popular entre nuestra audiencia, como podrían ser la <em>probabilidad de superioridad</em> o <em>d de Cohen</em>.</p>
<p><strong>Cohen’s d</strong></p>
<p><span class="math display">\[
\frac{\mu_2 - \mu_1}{\sqrt{\frac{\sigma_1^2 + \sigma_2^2}{2}}}
\]</span></p>
<ul>
<li>Se puede interpretar como un <em>z-score</em>. Cuántas desviaciones estándar una media de un grupo está por encima (o por debajo) de la media del otro grupo</li>
<li><a href="http://rpsychologist.com/d3/cohend">Ejemplo interactivo</a></li>
</ul>
<p><strong>Probabilidad de superioridad</strong></p>
<ul>
<li>La probabilidad que un dato tomado de un grupo sea mayor que la de un dato tomado del otro grupo.</li>
<li>Si suponemos que los datos se distribuyen normalmente, entonces:</li>
</ul>
<p><span class="math display">\[
\text{ps} = \Phi \left ( \frac{\delta}{\sqrt{2}} \right)
\]</span></p>
<p><span class="math inline">\(\Phi\)</span> es la <code>cdf</code> de una distribución normal <span class="math inline">\(\delta\)</span> es el valor del d de Cohen.</p>
<p>Con el siguiente código usamos <code>plot_posterior</code> para graficar todas las diferencias no triviales o redundantes. Es decir evitamos las diferencias de un día con sigo mismo y evitamos calcular ‘Vie - Jue’ si ya hemos calculado ‘Jue - Vie’. Si lo viéramos como una matriz de diferencias solo estaríamos calculando la porción triangular superior.</p>
<div id="cell-45" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>cg_posterior <span class="op">=</span> az.extract(idata_cg)</span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a>dist <span class="op">=</span> pz.Normal(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a>comparisons <span class="op">=</span> [(categories[i], categories[j]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb28-6"><a href="#cb28-6"></a></span>
<span id="cb28-7"><a href="#cb28-7"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">9</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="cf">for</span> (i, j), ax <span class="kw">in</span> <span class="bu">zip</span>(comparisons, axes.ravel()):</span>
<span id="cb28-10"><a href="#cb28-10"></a>    means_diff <span class="op">=</span> cg_posterior[<span class="st">"μ"</span>].sel(dias<span class="op">=</span>i) <span class="op">-</span> cg_posterior[<span class="st">'μ'</span>].sel(dias<span class="op">=</span>j)</span>
<span id="cb28-11"><a href="#cb28-11"></a>    </span>
<span id="cb28-12"><a href="#cb28-12"></a>    d_cohen <span class="op">=</span> (means_diff <span class="op">/</span></span>
<span id="cb28-13"><a href="#cb28-13"></a>               np.sqrt((cg_posterior[<span class="st">"σ"</span>].sel(dias<span class="op">=</span>i)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> </span>
<span id="cb28-14"><a href="#cb28-14"></a>                        cg_posterior[<span class="st">"σ"</span>].sel(dias<span class="op">=</span>j)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb28-15"><a href="#cb28-15"></a>              ).mean().item()</span>
<span id="cb28-16"><a href="#cb28-16"></a>    </span>
<span id="cb28-17"><a href="#cb28-17"></a>    ps <span class="op">=</span> dist.cdf(d_cohen<span class="op">/</span>(<span class="dv">2</span><span class="op">**</span><span class="fl">0.5</span>))</span>
<span id="cb28-18"><a href="#cb28-18"></a>    az.plot_posterior(means_diff.values, ref_val<span class="op">=</span><span class="dv">0</span>, ax<span class="op">=</span>ax)</span>
<span id="cb28-19"><a href="#cb28-19"></a>    ax.set_title(<span class="ss">f"</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-20"><a href="#cb28-20"></a>    ax.plot(<span class="dv">0</span>, label<span class="op">=</span><span class="ss">f"Cohen's d = </span><span class="sc">{</span>d_cohen<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">Prob sup = </span><span class="sc">{</span>ps<span class="sc">:.2f}</span><span class="ss">"</span>, alpha<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb28-21"><a href="#cb28-21"></a>    ax.legend(loc<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Programación_probabilística_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Una forma de interpretar estos resultados es comparando el valor de referencia con el intervalo HDI. De acuerdo con la figura anterior, tenemos solo un caso cuando el 94% HDI excluye el valor de referencia de cero, la diferencia en las propinas entre el jueves y el domingo. Para todos los demás ejemplos, no podemos descartar una diferencia de cero (de acuerdo con los criterios de superposición de valores de referencia de HDI). Pero incluso para ese caso, ¿es una diferencia promedio de ≈0.5 dólares lo suficientemente grande? ¿Es suficiente esa diferencia para aceptar trabajar el domingo y perder la oportunidad de pasar tiempo con familiares o amigos? ¿Es suficiente esa diferencia para justificar promediar las propinas durante los cuatro días y dar a cada mozo/a la misma cantidad de dinero de propina? Este tipo de preguntas es crucial para interpretar los datos y/o tomar decisiones, pero las respuestas no las puede ofrecer la estadística de forma automática (ni ningún otro procedimiento). La estadística solo pueden ayudar en la interpretación y/o toma de decisiones.</p>
<p>Nota: Dependiendo del público el gráfico anterior puede que esté demasiado “cargado”, quizá es útil para una discusión dentro del equipo de trabajo, pero para un público en general quizá convenga sacar elementos o repartir la información entre una figura y una tabla o dos figuras.</p>
</section>
</section>
<section id="resumen" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="resumen"><span class="header-section-number">2.3</span> Resumen</h2>
<p>Aunque la estadística Bayesiana es conceptualmente simple, los modelos probabilísticos a menudo conducen a expresiones analíticamente intratables. Durante muchos años, esta fue una gran barrera que obstaculizó la adopción amplia de métodos Bayesianos. Afortunadamente, la matemática, la física y la informática vinieron al rescate en forma de métodos numéricos capaces, al menos en principio, de resolver cualquier inferencia. La posibilidad de automatizar el proceso de inferencia ha llevado al desarrollo de los lenguajes de programación probabilista que permiten una clara separación entre la definición del modelo y la inferencia.</p>
<p>PyMC es una librería de Python para programación probabilística con una sintaxis simple, intuitiva y fácil de leer que también está muy cerca de la sintaxis estadística utilizada para describir modelos probabilísticos. En este capítulo introducimos PyMC revisando el problema de la moneda que vimos en el capítulo anterior. La diferencia es que no tuvimos que derivar analíticamente la distribución <em>a posteriori</em>. Los modelos en PyMC se definen dentro de un bloque <code>with</code>; para agregar una distribución de probabilidad a un modelo, solo necesitamos escribir una línea de código. Las distribuciones se pueden combinar y se pueden usar como priors (variables no observadas) o likelihoods (variables observadas). En la sintaxis de PyMC la única diferencia entre ambas es que para esta última debemos pasar los datos usando el argumento <code>observed</code>. Si todo va bien las muestras generadas por PyMC serán representativas de la distribución <em>a posteriori</em> y por lo tanto serán una representación de las consecuencias lógicas del modelo y los datos.</p>
<p>ArviZ es una librería que nos ayuda a explorar los modelos definidos por PyMC (u otras librerías como PyStan, TFP, BeanMachine, etc). Una forma de usar el posterior para ayudarnos a tomar decisiones es comparando la ROPE con el intervalo HDI.</p>
<p>Finalizamos comparando medias entre grupos, una tarea común en análisis de datos. Si bien esto a veces se enmarca en el contexto de las pruebas de hipótesis, tomamos otra ruta y trabajamos este problema como una inferencia del tamaño del efecto.</p>
</section>
<section id="ejercicios" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="ejercicios"><span class="header-section-number">2.4</span> Ejercicios</h2>
<ol type="1">
<li><p>Usando PyMC reproducí los resultados del primer capítulo para el problema de la moneda. Usá los 3 priors usados en ese capítulo Beta(1, 1), Beta(0.5, 0.5), Beta(20, 20). Probá con 4 experimentos y con 150. Presenta los resultados usando 2 visualizaciones.</p></li>
<li><p>En <code>nuestro_primer_modelo</code> reemplazá la distribución <span class="math inline">\(\theta \sim \text{Beta}(1, 1)\)</span> por una uniforme en el intervalo [0, 1] Cual es el efecto en el muestreo y en la distribución <em>a posteriori</em>? ¿Y si usas un intervalo más ámplio, como [-2, 1]?</p></li>
<li><p>Los modelos de PyMC tienen un método <code>.to_graphviz()</code> que se puede utilizar para visualizar el modelo (también existe la función <code>pm.model_to_graphviz()</code>. Use este método para visualizar <code>nuestro_primer_modelo</code>. Compare el resultado con el diagrama de Kruschke.</p></li>
<li><p>En el modelo <code>comparación_grupos</code> que dimensión y tamaño tiene <code>μ[idx]</code> y <code>σ[idx]</code>? Justifique</p></li>
<li><p>La Gaussiana es una distribución <em>sin límites</em> es decir es válida en el intervalo <span class="math inline">\((-\infty, \infty)\)</span>, en el modelo <code>comparación_grupos</code> usamos una Gama como likelihood, pero podríamos haber usado una Gaussiana? Cambiarías tu respuesta si las propinas tomaran valores alrededor de 100 dolares?</p></li>
<li><p>Calculá la probabilidad de superioridad directamente a partir de las muestras de la distribución <em>a posteriori</em>, es decir sin la expresión analítica. Cómo se comparan los resultados con los valores obtenidos analíticamente.</p></li>
<li><p>Aplicá al menos uno de los modelos vistos en este capítulo a datos propios o de tu interés.</p></li>
</ol>


</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01_Inferencia_Bayesiana.html" class="pagination-link" aria-label="Inferencia Bayesiana">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Inferencia Bayesiana</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_Modelos_jerárquicos.html" class="pagination-link" aria-label="Modelado Jerárquico">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelado Jerárquico</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Licencia Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a><br>Este obra está bajo <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">licencia Creative Commons Reconocimiento 4.0 Internacional</a>.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>